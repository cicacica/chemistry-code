(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    443634,       8106]
NotebookOptionsPosition[    438051,       8009]
NotebookOutlinePosition[    438643,       8029]
CellTagsIndexPosition[    438600,       8026]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["VQE to find ground state energy", "Title",
 CellChangeTimes->{{3.821094716186808*^9, 3.821094739198925*^9}, {
   3.822585196052581*^9, 3.8225851963612623`*^9}, {3.8225921906481543`*^9, 
   3.822592207731287*^9}, {3.823531937595224*^9, 3.823531937808639*^9}, {
   3.824849367362124*^9, 3.824849379611183*^9}, {3.82551898340462*^9, 
   3.8255189887818127`*^9}, {3.825660401373665*^9, 3.8256604036755867`*^9}, {
   3.8256750983955097`*^9, 3.8256751046898527`*^9}, 3.825675428202442*^9, {
   3.826739479680627*^9, 3.826739483632959*^9}, {3.826787008599586*^9, 
   3.8267870257849894`*^9}, {3.831927160718581*^9, 
   3.8319271701312037`*^9}},ExpressionUUID->"7532a72a-505f-400b-ac05-\
031ad951830d"],

Cell["by Cica Gustiani ", "Subtitle",
 CellChangeTimes->{{3.827475361758977*^9, 3.8274753888886433`*^9}, {
  3.8319271719276743`*^9, 3.8319271848985167`*^9}, {3.8319273674173813`*^9, 
  3.8319273676768303`*^9}},ExpressionUUID->"e7aee06d-2e4f-4999-8854-\
70c54571f52a"],

Cell["\<\
Main features: 
1) Random ansatz, start from empty ansatz or swap substrate
2) Fixed ansatz
3) Natural gradient analytic \
\[OpenCurlyDoubleQuote]NG\[CloseCurlyDoubleQuote], natural gradient numerics \
\[OpenCurlyDoubleQuote]NGFD\[CloseCurlyDoubleQuote], and steepest-gradient \
descent \[OpenCurlyDoubleQuote]SGD\[CloseCurlyDoubleQuote] \
\>", "Subsubtitle",
 CellChangeTimes->{{3.831927199778859*^9, 
  3.8319273370205183`*^9}},ExpressionUUID->"da5a076a-9717-4ab1-bde7-\
180ea14db740"],

Cell[CellGroupData[{

Cell["Initialization related", "Subsection",
 CellChangeTimes->{{3.823532646857679*^9, 
  3.823532659295793*^9}},ExpressionUUID->"f8927233-1ac2-41e3-b00e-\
d144b3c5eba1"],

Cell[CellGroupData[{

Cell["Questlink", "Subsubsection",
 CellChangeTimes->{{3.821094785133238*^9, 3.821094786333415*^9}, {
   3.821097799546958*^9, 3.821097808285853*^9}, {3.821098831266062*^9, 
   3.821098831744811*^9}, {3.821195625500657*^9, 3.8211956303394823`*^9}, 
   3.83336286955512*^9},ExpressionUUID->"1e964a40-6779-4f5b-96fe-\
d4a1b68f5e00"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Import", "[", "\"\<https://qtechtheory.org/questlink.m\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateLocalQuESTEnv", "[", "\"\<quest_link\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.819803125076724*^9, 3.8198031261607533`*^9}, {
   3.819803176415811*^9, 3.8198031766531963`*^9}, {3.819894353876569*^9, 
   3.819894356732341*^9}, {3.8198943886489763`*^9, 3.819894431785378*^9}, {
   3.8198945146801443`*^9, 3.819894518596518*^9}, {3.820527172879855*^9, 
   3.8205272473315496`*^9}, 3.820655339193205*^9, {3.820655433359385*^9, 
   3.82065549058811*^9}, {3.820661747013823*^9, 3.820661748015472*^9}, {
   3.820663378793988*^9, 3.8206634767830477`*^9}, {3.821097203028792*^9, 
   3.8210972042257833`*^9}, {3.821444898465564*^9, 3.821444899367831*^9}, {
   3.821821390840189*^9, 3.821821391053975*^9}, {3.8235205222382593`*^9, 
   3.823520526123763*^9}, 3.8237856350757713`*^9, {3.823785798865507*^9, 
   3.823785848093607*^9}, {3.823785921345996*^9, 3.8237859913036327`*^9}, {
   3.8238122338980618`*^9, 3.8238122361989*^9}, {3.831717959092986*^9, 
   3.831717985534309*^9}, {3.832061949444603*^9, 3.832061954939382*^9}, {
   3.832062048603444*^9, 3.832062048821398*^9}, {3.850484430173867*^9, 
   3.850484430932419*^9}, 3.852618721320994*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"84668fc4-2893-4c14-8e4b-bddb5cda67f9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Some collections of ansatze", "Subsubsection",
 CellChangeTimes->{{3.816003357134898*^9, 3.816003370439657*^9}, 
   3.821195857222999*^9, {3.833362890497081*^9, 
   3.833362891751762*^9}},ExpressionUUID->"38e68ade-8501-4fe8-8d2b-\
cd049d6e6ef8"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "GateSetRotations", ",", "GateSetRandom", ",", "GateSetNN", ",", 
   "GateSetCCeven", ",", "GateSetCCodd", ",", "GateSetPaulis", ",", 
   "SwapFabric", ",", "CustomGatesDefinitions", ",", "CustomGatesDraw"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.823594299828105*^9, 3.823594315551271*^9}, {
  3.823594365326688*^9, 3.823594416991969*^9}, {3.823594518426515*^9, 
  3.8235945220552683`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"fa431975-73c1-499d-a5c9-d213cffd9877"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GateSetRotations", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["Rx", "#"], "[", "\[Theta]", "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["Ry", "#"], "[", "\[Theta]", "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["Rz", "#"], "[", "\[Theta]", "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["C", "#1"], "[", 
       RowBox[{
        SubscriptBox["Rx", "#2"], "[", "\[Theta]", "]"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["C", "#1"], "[", 
       RowBox[{
        SubscriptBox["Ry", "#2"], "[", "\[Theta]", "]"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["C", "#1"], "[", 
       RowBox[{
        SubscriptBox["Rz", "#2"], "[", "\[Theta]", "]"}], "]"}], "&"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GateSetRandom", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{
        SubscriptBox["C", "i"], "[", 
        RowBox[{
         SubscriptBox["Rx", "j"], "[", "\[Theta]", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{
        SubscriptBox["C", "i"], "[", 
        RowBox[{
         SubscriptBox["Ry", "j"], "[", "\[Theta]", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{
        SubscriptBox["Rx", "i"], "[", "\[Theta]", "]"}]}], "]"}], ",", 
     RowBox[{
      SubscriptBox["Ry", "3"], "[", "\[Theta]", "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{
        SubscriptBox["Ry", "i"], "[", "\[Theta]", "]"}]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{
        SubscriptBox["Rz", "i"], "[", "\[Theta]", "]"}]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       RowBox[{"R", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{
          SubscriptBox["X", "i"], 
          SubscriptBox["X", "j"]}]}], "]"}]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], ",", 
       SubscriptBox["SWAP", 
        RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       SubscriptBox["H", "i"]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GateSetNN", "[", "nqubit_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["Rx", "i"], "[", "\[Theta]", "]"}], ",", 
         RowBox[{
          SubscriptBox["Ry", "i"], "[", "\[Theta]", "]"}], ",", 
         RowBox[{
          SubscriptBox["Rz", "i"], "[", "\[Theta]", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nqubit", "-", "1"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["C", "i"], "[", 
          RowBox[{
           SubscriptBox["Rx", 
            RowBox[{"i", "+", "1"}]], "[", "\[Theta]", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["C", "i"], "[", 
          RowBox[{
           SubscriptBox["Ry", 
            RowBox[{"i", "+", "1"}]], "[", "\[Theta]", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["C", "i"], "[", 
          RowBox[{
           SubscriptBox["Rz", 
            RowBox[{"i", "+", "1"}]], "[", "\[Theta]", "]"}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nqubit", "-", "2"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["C", "i"], "[", 
          RowBox[{
           SubscriptBox["Rx", 
            RowBox[{"i", "-", "1"}]], "[", "\[Theta]", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["C", "i"], "[", 
          RowBox[{
           SubscriptBox["Ry", 
            RowBox[{"i", "-", "1"}]], "[", "\[Theta]", "]"}], "]"}], ",", 
         RowBox[{
          SubscriptBox["C", "i"], "[", 
          RowBox[{
           SubscriptBox["Rz", 
            RowBox[{"i", "-", "1"}]], "[", "\[Theta]", "]"}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"nqubit", "-", "1"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "//", 
   "Flatten"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GateSetCCeven", "[", "nqubit_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{"R", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{
          SubscriptBox["X", "i"], 
          SubscriptBox["X", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "nqubit"}], "]"}]]}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{"R", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{
          SubscriptBox["Y", "i"], 
          SubscriptBox["Y", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "nqubit"}], "]"}]]}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{"R", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{
          SubscriptBox["Z", "i"], 
          SubscriptBox["Z", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "nqubit"}], "]"}]]}]}], "]"}]}], 
      "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GateSetCCodd", "[", "nqubit_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{"R", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{
          SubscriptBox["X", "i"], 
          SubscriptBox["X", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "nqubit"}], "]"}]]}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{"R", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{
          SubscriptBox["Y", "i"], 
          SubscriptBox["Y", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "nqubit"}], "]"}]]}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{"R", "[", 
        RowBox[{"\[Theta]", ",", 
         RowBox[{
          SubscriptBox["Z", "i"], 
          SubscriptBox["Z", 
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", "nqubit"}], "]"}]]}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{
        SubscriptBox["Rz", "i"], "[", "\[Theta]", "]"}]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{
        SubscriptBox["Ry", "i"], "[", "\[Theta]", "]"}]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{
        SubscriptBox["Rx", "i"], "[", "\[Theta]", "]"}]}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GateSetPaulis", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{
        SubscriptBox["Rz", "i"], "[", "\[Theta]", "]"}]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{
        SubscriptBox["Ry", "i"], "[", "\[Theta]", "]"}]}], "]"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{
        SubscriptBox["Rx", "i"], "[", "\[Theta]", "]"}]}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.81462829670296*^9, 3.8146283394048443`*^9}, {
   3.815837119688015*^9, 3.815837217586707*^9}, {3.815837974705233*^9, 
   3.8158380129708357`*^9}, {3.815839227477313*^9, 3.8158392296534767`*^9}, 
   3.815839713684578*^9, {3.815903854157424*^9, 3.815903891971287*^9}, {
   3.815908023476219*^9, 3.8159080432408953`*^9}, {3.815908596245618*^9, 
   3.815908596965498*^9}, 3.815999206650765*^9, {3.816008590911392*^9, 
   3.816008632554302*^9}, 3.816008725427703*^9, {3.816026927117044*^9, 
   3.816026990473495*^9}, {3.8164203608481607`*^9, 3.8164203752353153`*^9}, {
   3.821203443296267*^9, 3.821203443938632*^9}, {3.821876320451577*^9, 
   3.821876473756432*^9}, {3.823594291751346*^9, 3.8235943579846888`*^9}, {
   3.835473688358267*^9, 3.8354736936994047`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"79778ee5-5a6d-45cb-8e90-61bcedfa7f7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SwapFabric", "::", "usage"}], "=", 
   "\"\<SwapFabric[nqubit, depth, initrange]. Create a fabric of \
parameterized swaps.\nWorks only for serial case.\nReturn \
{ansatz,\[Theta]vars,index}\n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SwapFabric", "[", 
   RowBox[{"nqubit_", ",", "depth_", ",", 
    RowBox[{"initrange_", ":", "\[Pi]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ansatz", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"idx", "=", "1"}], ",", 
      RowBox[{"\[Theta]vars", "=", 
       RowBox[{"<|", "|>"}]}], ",", "loop", ",", "loop2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"loop", "=", "1"}], ",", 
       RowBox[{"loop", "\[LessEqual]", 
        RowBox[{"2", "*", "depth"}]}], ",", 
       RowBox[{"loop", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"loop2", "=", 
          RowBox[{"Mod", "[", 
           RowBox[{"loop", ",", "2"}], "]"}]}], ",", 
         RowBox[{"loop2", "<", 
          RowBox[{"nqubit", "-", "1"}]}], ",", 
         RowBox[{"loop2", "+=", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"ansatz", ",", 
           RowBox[{
            SubscriptBox["SW", 
             RowBox[{"loop2", ",", 
              RowBox[{"loop2", "+", "1"}]}]], "[", 
            SubscriptBox["\[Theta]", 
             RowBox[{"idx", "++"}]], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]vars", "[", 
         SubscriptBox["\[Theta]", "i"], "]"}], "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "initrange"}], ",", "initrange"}], "}"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"idx", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ansatz", ",", "\[Theta]vars", ",", "idx"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CustomGatesDefinitions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["SW", 
        RowBox[{"idx1_", ",", "idx2_"}]], "[", "\[Theta]_", "]"}], "\[Rule]", 
      
      RowBox[{
       SubscriptBox["U", 
        RowBox[{"idx1", ",", "idx2"}]], "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "2"]], 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "2"]], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", "0"}], " ", "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], " ", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "2"]], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", " ", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}], "2"]], 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", "0"}], " ", "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["U3", "idx1_"], "[", 
       RowBox[{"\[Theta]_", ",", "\[Phi]_", ",", "\[Lambda]_"}], "]"}], 
      "\[RuleDelayed]", " ", 
      RowBox[{
       SubscriptBox["U", "idx1"], "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Theta]", "/", "2"}], "]"}], ",", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"\[ImaginaryI]", 
               RowBox[{"(", " ", "\[Lambda]", ")"}]}]]}], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", 
              RowBox[{"(", " ", "\[Phi]", ")"}]}]], 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}], ",", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"\[ImaginaryI]", 
              RowBox[{"(", 
               RowBox[{"\[Phi]", "+", "\[Lambda]"}], ")"}]}]], 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Theta]", "/", "2"}], "]"}]}]}], "}"}]}], "}"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["U1", "idx1_"], "[", "\[Lambda]_", "]"}], 
      "\[RuleDelayed]", " ", 
      RowBox[{
       SubscriptBox["U", "idx1"], "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", 
             RowBox[{"(", "\[Lambda]", ")"}]}]]}], "}"}]}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CustomGatesDraw", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["SW", 
       RowBox[{"i_", ",", "j_"}]], "[", "_", "]"}], "\[Rule]", 
     SubscriptBox["SWAP", 
      RowBox[{"i", ",", "j"}]]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyj9IAnEAxfFDGyJEosi6arGlElI8jGYJggqDJCxcMg/p6EohiETLP0Nl
YouWLkISpVOOuYUOlm1JkWI1KeZwQRGJRVS/5/D48OArN9v0FhFFUTQZTPbV
2B2noH1RROzQyZm34UQ56YXCZGUf5oPWCHwyTn/D8CLzB9sf1aVrovXZ17RY
z9I5dImsAh5o7lRQVsox8EJ+a2l+k4iHX6FPyQ3xV7wqhTnbyTAsp+ojsPox
oIF6z+4oFMfHpuDDODcLB7nWeShyr/Dw/OhqA7YVTu3QIfG7oW+p6IGCTncG
Q+89cRiQRevKLUHL5v0N6LyUtKiIhlhUCn94eRdMDTFNuXR685VoXTt2QFm3
ywXpasYLXSw/RwUEbeUwsQxj6kLHOnFm774ThoNGGtYWMr2wYeCUAvHN1M/A
fzwy1oI=
  "],
 CellLabel->"In[11]:=",ExpressionUUID->"4d36f5e6-093c-4760-9b73-060190e2601c"]
}, Closed]],

Cell[CellGroupData[{

Cell["default hyperparameters", "Subsubsection",
 CellChangeTimes->{{3.816003357134898*^9, 3.816003370439657*^9}, 
   3.821195857222999*^9, {3.82120474535821*^9, 3.821204758312608*^9}, {
   3.8340021945603323`*^9, 
   3.834002199306402*^9}},ExpressionUUID->"364966f0-0fa9-4d5d-b8b6-\
b701b1d3988c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DefaultConfig", "::", "usage"}], "=", 
   "\"\<DefaultConfig[nqubit_,gatepool_] return default configutation of \
hyper parameters.\ngatepool may contain explicit gates or pure functions.\n\>\
\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefaultConfig", "[", 
   RowBox[{"nqubit_Integer", ",", 
    RowBox[{"gatepool_List", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gateset", ",", "lidxs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"gateset", " ", "rotations", " ", "as", " ", "default"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gateset", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "gatepool"}], ">", "0"}], ",", "gatepool", 
        ",", "GateSetRotations"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lidxs", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"gateIdxLen", "[", "#", "]"}], "&"}], "/@", "gateset"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Number", " ", "of", " ", "physical", " ", "qubit"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<nqubit\>\"", "\[Rule]", " ", "nqubit"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Methods", " ", "to", " ", "calcualte", " ", 
         RowBox[{"gradient", ":", " ", 
          RowBox[{"NG", " ", "||", " ", "NGFD", " ", "||", " ", "SGD"}]}]}], 
        "  ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<methode\>\"", "\[Rule]", "\"\<NG\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Number", " ", "of", " ", "random", " ", "gates", " ", "added", " ", 
         "per", " ", "cycle"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<gatespercycle\>\"", " ", "\[Rule]", "  ", "20"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Number", " ", "of", " ", "gates", " ", "at", " ", "the", " ", 
         "first", " ", "cycle"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<ngatesinit\>\"", "\[Rule]", "10"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Set", " ", "if", " ", "you", " ", "fix", " ", "the", " ", "ansatz"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<fixansatz\>\"", "\[Rule]", " ", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Set", " ", "if", " ", "you", " ", "want", " ", "to", " ", "specify", 
         " ", "initial", " ", 
         RowBox[{"parameters", ".", " ", "This"}], " ", "is", " ", "set", " ",
          "only", " ", "if", " ", "fixansatz", " ", "is", " ", "specified"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<fixansatzparams\>\"", "\[Rule]", 
        RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "The", " ", "qubits", " ", "allowed", " ", "to", " ", "search", " ", 
         "for", " ", "ansatz"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<ansatzspace\>\"", "\[Rule]", "  ", 
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"nqubit", "-", "1"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"The", " ", "weight", " ", "of", " ", "1"}], "-"}], ",", 
         RowBox[{"2", "-"}], ",", 
         RowBox[{"3", "-"}], ",", " ", 
         RowBox[{
         "etc", " ", "qubit", " ", "gates", " ", "to", " ", "maintain", " ", 
          "uniform", " ", 
          RowBox[{"randomness", ".", " ", "Must"}], " ", "have", " ", "rule", 
          " ", 
          RowBox[{"form", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<weightgate\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "->", "0.2"}], ",", 
          RowBox[{"2", "->", "0.8"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"start", " ", "with", " ", "a", " ", "prepared", " ", 
         RowBox[{"state", ".", " ", "Should"}], " ", "not", " ", "contain", 
         " ", "any", " ", "free", " ", "parameters"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<ansatzinit\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", "0"], ",", 
          SubscriptBox["X", "1"]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"depth", " ", "of", " ", "parameterized", " ", "swap"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<swapfabricdepth\>\"", "\[Rule]", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Maximum", " ", "iteration", " ", "for", " ", "bruteforce"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<maxfevbf\>\"", "\[Rule]", "100"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "The", " ", "choice", " ", "of", " ", "ansazte", " ", "provided", " ",
          "on", " ", "each", " ", "cycle"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<greediness\>\"", "\[Rule]", "10"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Greediness", " ", "in", " ", "the", " ", "first", " ", "cycle"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<greedinessinit\>\"", "\[Rule]", "10"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Plateau", " ", "in", " ", "the", " ", "greedy", " ", "by", " ", 
          "fraction", " ", "energy", " ", "improvement"}], ",", " ", 
         RowBox[{"not", " ", "perfection"}]}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<greedflat\>\"", "\[Rule]", "0.01"}], ",", "     ", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "maximum", " ", "iteration", " ", "in", " ", "greed", " ", "search"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<maxgreediter\>\"", "\[Rule]", "100"}], ",", " ", 
       "\[IndentingNewLine]", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Fixed", " ", "step", " ", "in", " ", "the", " ", "gradient", " ", 
         "direction"}], " ", "*)"}], "   ", "\[IndentingNewLine]", 
       RowBox[{"\"\<gradstep\>\"", "\[Rule]", "0.01"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Step", " ", "in", " ", "the", " ", "angles", " ", "for", " ", "the", 
         " ", "steepest", " ", "gradient", " ", "descent"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<d\[Theta]\>\"", "\[Rule]", "0.01"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "Multiplications", " ", "of", " ", "gradient", " ", "step", " ", 
          "that", " ", "is", " ", "tried", " ", "out"}], ",", " ", 
         RowBox[{"natural", " ", "gradient"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<gradstepmultiply\>\"", "\[Rule]", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Tikhonov", " ", "regularization", " ", "constant"}], ",", 
         " ", 
         RowBox[{"natural", " ", "gradient"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Alpha]tikhonov\>\"", "\[Rule]", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Gates", " ", "with", " ", "such", " ", "an", " ", "angle", " ", 
         "will", " ", "be", " ", "deleted"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Theta]ignore\>\"", "\[Rule]", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], " ", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Norm", " ", "of", " ", "between", " ", "two", " ", "rows", " ", "of",
          " ", "the", " ", "metric", " ", "A", " ", "that", " ", "leads", " ",
          "to", " ", "deletion"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<metignore\>\"", "\[Rule]", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], ",", "   ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Detect", " ", "flatness", " ", "as", " ", 
         RowBox[{"convergence", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<perfectingflat\>\"", "\[Rule]", 
        RowBox[{"1.5", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "4"}]]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Error", " ", "allowed", " ", "to", " ", "increase", " ", "energy", 
         " ", "in", " ", "the", " ", "pruning"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<pruningerror\>\"", "\[Rule]", "0.1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "The", " ", "number", " ", "of", " ", "convergence", " ", "to", " ", 
         "stop", " ", "variational", " ", "iteration"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<iterconverge\>\"", "\[Rule]", "20"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "the", " ", "number", " ", "of", " ", "cycles", " ", "that", " ", 
         RowBox[{"isn", "'"}], "t", " ", "improving", " ", "to", " ", 
         "declare", " ", "convergence", " ", "and", " ", "termiante", " ", 
         "all", " ", "calculations"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<globalconverge\>\"", "\[Rule]", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "new", " ", "gates", " ", "with", " ", "param", " ", "\[Theta]", " ",
           "are", " ", "initialized", " ", 
          RowBox[{"with", " ", "[", 
           RowBox[{
            RowBox[{"-", "\[Theta]initrange"}], ",", "\[Theta]initrange"}], 
           "]"}]}], "\[ReverseElement]", "\[Theta]"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Theta]initrange\>\"", "\[Rule]", 
        RowBox[{"\[Pi]", "/", "4"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"final", " ", "energy", " ", "target"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<\[Epsilon]fin\>\"", "\[Rule]", 
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "increase", " ", "number", " ", "of", " ", "gates", " ", "when", " ", 
         "adjusting", " ", "hyperparams"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<slowfirst\>\"", "\[Rule]", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "try", " ", "to", " ", "refine", " ", "the", " ", "final", " ", 
         "result"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\"\<refine\>\"", "\[Rule]", "2"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"One", "-", 
          RowBox[{"qubit", " ", "rotations", " ", "and", " ", "controlled"}], 
          "-", "rotations"}], ",", " ", 
         RowBox[{"nearest", "-", 
          RowBox[{"neighbour", " ", "constrained"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<gateset\>\"", "\[Rule]", " ", "gateset"}]}], 
      "\[IndentingNewLine]", "|>"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8211950103840218`*^9, 3.821195350350937*^9}, {
   3.821195430941946*^9, 3.821195495254801*^9}, {3.821195665964295*^9, 
   3.821195688484304*^9}, 3.8211957302533693`*^9, {3.821195762459177*^9, 
   3.821195787705577*^9}, {3.821202920447802*^9, 3.821202964026198*^9}, {
   3.821203389221884*^9, 3.821203393215633*^9}, {3.821203505170722*^9, 
   3.8212037209583*^9}, {3.821203798285783*^9, 3.821203807606135*^9}, {
   3.821204171022504*^9, 3.821204183866083*^9}, {3.8212043132865257`*^9, 
   3.821204433127038*^9}, {3.821204464758615*^9, 3.82120450567583*^9}, {
   3.821204594572885*^9, 3.821204652277779*^9}, {3.821205201384981*^9, 
   3.821205202483624*^9}, {3.8212060814669323`*^9, 3.821206085530775*^9}, {
   3.821206305956153*^9, 3.82120634399857*^9}, {3.821209160748008*^9, 
   3.821209177257207*^9}, {3.8212093294995537`*^9, 3.821209357197115*^9}, {
   3.821212571009089*^9, 3.821212571842798*^9}, {3.821296111502529*^9, 
   3.821296232103085*^9}, {3.821296262191575*^9, 3.821296363573*^9}, {
   3.8213056800713997`*^9, 3.821305709940364*^9}, {3.8213057565895987`*^9, 
   3.821305782717598*^9}, {3.8213078290370207`*^9, 3.821307852211885*^9}, 
   3.8213573009752827`*^9, {3.821358043311694*^9, 3.821358044432482*^9}, {
   3.821393957289283*^9, 3.821394020413261*^9}, {3.821469421976788*^9, 
   3.8214694285385303`*^9}, {3.821469493194034*^9, 3.821469493909937*^9}, {
   3.821469631954115*^9, 3.821469632132214*^9}, {3.8214698081949463`*^9, 
   3.821469812394582*^9}, {3.821470026453525*^9, 3.8214700291473417`*^9}, 
   3.821543271113763*^9, {3.821543513999837*^9, 3.821543523171294*^9}, 
   3.8215439715159473`*^9, {3.821547208312127*^9, 3.821547228955799*^9}, {
   3.8218064967651176`*^9, 3.8218065506714077`*^9}, {3.821806604225258*^9, 
   3.821806669611372*^9}, {3.8218068934689007`*^9, 3.821806898831091*^9}, {
   3.821806947709703*^9, 3.8218069503013077`*^9}, {3.8218070250573072`*^9, 
   3.821807025350362*^9}, {3.82180895345061*^9, 3.821808953628635*^9}, {
   3.8218111749493856`*^9, 3.821811175731185*^9}, {3.821821422103013*^9, 
   3.821821452746963*^9}, {3.821822645798974*^9, 3.821822646125822*^9}, {
   3.821881790165495*^9, 3.821881791968143*^9}, {3.8218892245592527`*^9, 
   3.821889225281686*^9}, {3.822494884352345*^9, 3.822494884642071*^9}, 
   3.8226359129318*^9, {3.82263595707406*^9, 3.82263595830827*^9}, {
   3.8226427277294617`*^9, 3.8226427289688263`*^9}, {3.8227663001557627`*^9, 
   3.822766301177499*^9}, {3.8227718829515753`*^9, 3.822771886305024*^9}, {
   3.822771945153927*^9, 3.822771946839167*^9}, {3.8227720230074463`*^9, 
   3.8227720249504557`*^9}, 3.822831196901888*^9, {3.822831400009795*^9, 
   3.8228314023304253`*^9}, {3.822831678966896*^9, 3.822831679905594*^9}, {
   3.82283545223487*^9, 3.822835452862301*^9}, {3.822859656000103*^9, 
   3.822859707861187*^9}, {3.823439793005876*^9, 3.823439843135689*^9}, {
   3.8234401681214933`*^9, 3.823440228351264*^9}, {3.8234407710364637`*^9, 
   3.823440774494822*^9}, {3.823445688419261*^9, 3.8234456957738047`*^9}, {
   3.8234457423075237`*^9, 3.823445777954265*^9}, 3.823532289612056*^9, {
   3.823534750138419*^9, 3.823534750869836*^9}, {3.823534889182385*^9, 
   3.8235349438048553`*^9}, {3.823550672304833*^9, 3.82355092213767*^9}, {
   3.82355096999323*^9, 3.823551025791922*^9}, {3.823584809531508*^9, 
   3.823584810500189*^9}, {3.82359409625776*^9, 3.823594096899312*^9}, {
   3.823594180547901*^9, 3.8235941901306868`*^9}, {3.823601292514433*^9, 
   3.823601325145418*^9}, {3.823603038558852*^9, 3.82360306575111*^9}, {
   3.823603175606625*^9, 3.823603223993061*^9}, {3.823703350677743*^9, 
   3.823703364007555*^9}, {3.823703417262339*^9, 3.8237034430459538`*^9}, {
   3.8237051365916233`*^9, 3.8237051368087273`*^9}, {3.823705254685503*^9, 
   3.823705273226276*^9}, 3.8237053670096903`*^9, {3.8237136156389837`*^9, 
   3.8237136165906057`*^9}, {3.823716929740355*^9, 3.823716930474128*^9}, {
   3.8237169703680477`*^9, 3.823716971193219*^9}, {3.823756052450431*^9, 
   3.8237560552772923`*^9}, {3.823768533254016*^9, 3.823768598511153*^9}, {
   3.823769139991981*^9, 3.8237692576020947`*^9}, {3.823769703279076*^9, 
   3.823769703573986*^9}, {3.823770762666016*^9, 3.82377076410723*^9}, {
   3.823779887792262*^9, 3.823779888307118*^9}, {3.823780138887672*^9, 
   3.823780158861257*^9}, {3.823780206740699*^9, 3.823780208048255*^9}, 
   3.823782111991652*^9, 3.82395429049247*^9, {3.8239723911972322`*^9, 
   3.8239723913941708`*^9}, {3.8239733723228607`*^9, 3.823973372605651*^9}, {
   3.823973834546101*^9, 3.823973846353868*^9}, {3.823974045614814*^9, 
   3.823974055189604*^9}, {3.823974128100473*^9, 3.823974133300931*^9}, {
   3.8239793476525993`*^9, 3.823979348229547*^9}, {3.82397938216415*^9, 
   3.823979383614059*^9}, {3.8240206958881893`*^9, 3.824020717134119*^9}, {
   3.8240209562121572`*^9, 3.8240209831703653`*^9}, {3.8240492940378857`*^9, 
   3.824049297654853*^9}, {3.8240497456850567`*^9, 3.824049752363537*^9}, {
   3.824051279910428*^9, 3.82405131184378*^9}, {3.824052852138592*^9, 
   3.8240528611015778`*^9}, {3.824053223033325*^9, 3.8240532382843437`*^9}, {
   3.824054602680853*^9, 3.8240546035395803`*^9}, {3.8240638385595827`*^9, 
   3.8240638454708033`*^9}, {3.824065279453116*^9, 3.824065280737172*^9}, {
   3.82409118921537*^9, 3.824091189556869*^9}, {3.824091573920651*^9, 
   3.8240915741656847`*^9}, {3.824125095140192*^9, 3.8241251012456837`*^9}, 
   3.824130072264329*^9, {3.824131049770438*^9, 3.824131074135786*^9}, {
   3.824131593149633*^9, 3.824131595383919*^9}, {3.824131628021697*^9, 
   3.8241316347452173`*^9}, {3.8241316792429457`*^9, 
   3.8241316807800627`*^9}, {3.82413712925144*^9, 3.824137180088971*^9}, {
   3.824138319575501*^9, 3.8241383201579*^9}, 3.8241395500957747`*^9, {
   3.824139667886754*^9, 3.8241396685886297`*^9}, {3.824142189290392*^9, 
   3.8241421947485437`*^9}, {3.8241849064565973`*^9, 3.824184915083124*^9}, {
   3.824185815845581*^9, 3.824185825912298*^9}, {3.824185856685478*^9, 
   3.824185869223283*^9}, {3.8241869485870247`*^9, 3.824186950218775*^9}, {
   3.824195640074129*^9, 3.824195651382399*^9}, {3.824196812325418*^9, 
   3.824196812861724*^9}, {3.824197550786913*^9, 3.824197601859136*^9}, {
   3.824197772238358*^9, 3.824197772397932*^9}, {3.824200292574737*^9, 
   3.8242002934283667`*^9}, {3.824202895172578*^9, 3.824202895348465*^9}, {
   3.82420479580443*^9, 3.8242048030658693`*^9}, {3.824213219507972*^9, 
   3.824213219774549*^9}, {3.824214252099929*^9, 3.824214252658174*^9}, {
   3.824216042837442*^9, 3.824216044736319*^9}, {3.8242161245458403`*^9, 
   3.824216124724917*^9}, {3.824220550091831*^9, 3.824220572142672*^9}, {
   3.82429186995331*^9, 3.8242918700719547`*^9}, {3.824291943761018*^9, 
   3.824291948901667*^9}, {3.824292834248906*^9, 3.824292840019733*^9}, {
   3.824295269569665*^9, 3.824295282080508*^9}, {3.824296978818947*^9, 
   3.824296984568932*^9}, {3.824297039397471*^9, 3.824297072889823*^9}, {
   3.824297295954026*^9, 3.824297306229732*^9}, {3.824297450880324*^9, 
   3.824297464401432*^9}, {3.824297598101737*^9, 3.824297598501204*^9}, {
   3.824297992841387*^9, 3.824298079987135*^9}, {3.824299034915987*^9, 
   3.8242991008553*^9}, {3.824299698684299*^9, 3.824299722298293*^9}, {
   3.8242998040087833`*^9, 3.824299830305743*^9}, {3.824299921369522*^9, 
   3.824299980676434*^9}, {3.824300013651925*^9, 3.824300014626668*^9}, {
   3.82430015434828*^9, 3.8243001578494263`*^9}, {3.8243002530947866`*^9, 
   3.8243002754357452`*^9}, {3.824300772496114*^9, 3.824300773057437*^9}, {
   3.824300896625185*^9, 3.824300896788039*^9}, {3.824301337108037*^9, 
   3.824301374892742*^9}, {3.8243015856810207`*^9, 3.824301619293652*^9}, {
   3.8243016926100082`*^9, 3.824301697469431*^9}, {3.824301767409707*^9, 
   3.82430176984584*^9}, {3.824301871786395*^9, 3.824301910664502*^9}, {
   3.8243019871290703`*^9, 3.8243019891160088`*^9}, {3.824302166825658*^9, 
   3.824302169189*^9}, {3.8243023095486717`*^9, 3.8243023126033487`*^9}, {
   3.824302618198454*^9, 3.8243026200779963`*^9}, {3.8243026840510883`*^9, 
   3.824302692634973*^9}, {3.8243028145228662`*^9, 3.824302814693572*^9}, {
   3.8243029297447844`*^9, 3.8243029511172647`*^9}, {3.824303220953045*^9, 
   3.824303233957591*^9}, 3.824303323034603*^9, {3.824303483541753*^9, 
   3.824303488804241*^9}, {3.824304045397726*^9, 3.8243040638704567`*^9}, {
   3.824304138536475*^9, 3.824304164311273*^9}, {3.824304223625922*^9, 
   3.824304230261549*^9}, {3.824304263282188*^9, 3.824304271445046*^9}, {
   3.824304435027128*^9, 3.8243044454603987`*^9}, {3.824304931546842*^9, 
   3.824304933871558*^9}, {3.8243053292351923`*^9, 3.824305330856634*^9}, {
   3.824305361338915*^9, 3.824305364869566*^9}, {3.824305587402055*^9, 
   3.8243055900878*^9}, 3.824305670403624*^9, {3.824305702453067*^9, 
   3.8243057025952587`*^9}, {3.824305850620491*^9, 3.8243058649756327`*^9}, {
   3.824305918258247*^9, 3.824305984862797*^9}, {3.824306059718233*^9, 
   3.8243060605051613`*^9}, {3.8243068122854357`*^9, 3.824306828917617*^9}, {
   3.824307095131831*^9, 3.824307115448481*^9}, {3.8243071835266037`*^9, 
   3.824307197038419*^9}, {3.824307514721499*^9, 3.82430751552456*^9}, {
   3.824307927008442*^9, 3.8243079271857452`*^9}, {3.8243087486695747`*^9, 
   3.8243087522899837`*^9}, {3.8243090527062387`*^9, 3.824309058913826*^9}, {
   3.824309824806261*^9, 3.824309826766378*^9}, {3.824310011181995*^9, 
   3.824310013249536*^9}, {3.82431009553188*^9, 3.824310108938323*^9}, {
   3.8243101470415*^9, 3.824310197287382*^9}, {3.8243105887684402`*^9, 
   3.824310598663357*^9}, {3.824311037411502*^9, 3.824311048315686*^9}, {
   3.824311566587453*^9, 3.824311570196048*^9}, {3.824317474334806*^9, 
   3.824317561729545*^9}, {3.824318180634218*^9, 3.8243182238025017`*^9}, {
   3.824322244166374*^9, 3.824322271450988*^9}, {3.8243224482606153`*^9, 
   3.824322454575778*^9}, {3.824323072685689*^9, 3.824323073253592*^9}, {
   3.824323271263726*^9, 3.824323286375359*^9}, {3.82432339071871*^9, 
   3.824323435415464*^9}, {3.8243235159706507`*^9, 3.824323607899365*^9}, {
   3.824323801801243*^9, 3.824323802585102*^9}, {3.8243239030647383`*^9, 
   3.824323903225143*^9}, {3.8243243581319838`*^9, 3.824324358265316*^9}, {
   3.8243244632320023`*^9, 3.824324488894313*^9}, {3.824324790700268*^9, 
   3.824324790867475*^9}, {3.824325123081376*^9, 3.824325131870253*^9}, {
   3.824325527467545*^9, 3.8243255284437437`*^9}, {3.824391871531067*^9, 
   3.824391872453556*^9}, {3.824391913420295*^9, 3.824391937809766*^9}, {
   3.824392142332385*^9, 3.824392146025683*^9}, {3.824392549512349*^9, 
   3.8243925497664013`*^9}, {3.824450698287002*^9, 3.824450725588139*^9}, {
   3.824538313431115*^9, 3.824538313631535*^9}, {3.824539608332206*^9, 
   3.8245396282446136`*^9}, {3.82484927614927*^9, 3.824849356972815*^9}, {
   3.8248523807657127`*^9, 3.824852415036909*^9}, {3.824852462073677*^9, 
   3.824852480937911*^9}, {3.8248835021606407`*^9, 3.824883507731675*^9}, {
   3.82488375500373*^9, 3.8248837992243547`*^9}, {3.8248838454968367`*^9, 
   3.824883847970928*^9}, {3.824883970042897*^9, 3.824883970188904*^9}, {
   3.824884451533407*^9, 3.824884451652705*^9}, {3.82501790190792*^9, 
   3.825017919957704*^9}, {3.8250630763272867`*^9, 3.825063080096944*^9}, {
   3.82506331878854*^9, 3.825063344254057*^9}, {3.82506370090467*^9, 
   3.825063701024376*^9}, {3.825105878266479*^9, 3.825105879446809*^9}, {
   3.825145421640697*^9, 3.825145461197824*^9}, {3.8251673391935463`*^9, 
   3.825167341714999*^9}, {3.825268982516733*^9, 3.825268982615323*^9}, {
   3.825269990580853*^9, 3.825269990754506*^9}, {3.825274735682439*^9, 
   3.825274739306239*^9}, {3.825496021193411*^9, 3.825496105252838*^9}, 
   3.82549656683491*^9, {3.825497063346908*^9, 3.825497088222774*^9}, {
   3.825508699930352*^9, 3.8255087210290117`*^9}, {3.825524619857788*^9, 
   3.825524621282948*^9}, {3.825533823615574*^9, 3.825533995403607*^9}, {
   3.825534031587137*^9, 3.825534032495379*^9}, {3.825534086114925*^9, 
   3.825534096781209*^9}, {3.825534279922015*^9, 3.825534280118454*^9}, {
   3.825534314670027*^9, 3.825534318706846*^9}, {3.825534777389049*^9, 
   3.825534778240087*^9}, {3.825535094814331*^9, 3.8255350981137047`*^9}, {
   3.825575129616001*^9, 3.825575136262732*^9}, {3.825575202596689*^9, 
   3.825575215676532*^9}, {3.825664826086795*^9, 3.8256648292621727`*^9}, {
   3.825673942886323*^9, 3.825673981658659*^9}, 3.825675164729877*^9, {
   3.8256753349748087`*^9, 3.825675419094758*^9}, {3.8256765561558733`*^9, 
   3.825676563776988*^9}, {3.825710331836781*^9, 3.8257103364879007`*^9}, {
   3.825778732073214*^9, 3.825778747179637*^9}, 3.8261458079851513`*^9, {
   3.8261458433357563`*^9, 3.826145865938196*^9}, {3.8261990774806347`*^9, 
   3.82619909805707*^9}, {3.826264404242158*^9, 3.826264412697117*^9}, {
   3.826264754968704*^9, 3.826264758582149*^9}, {3.826722091899021*^9, 
   3.826722092666061*^9}, {3.826722195949998*^9, 3.826722196215054*^9}, {
   3.826724799706133*^9, 3.8267248000850477`*^9}, {3.8267250785020323`*^9, 
   3.826725090486352*^9}, {3.826725860242621*^9, 3.82672586054368*^9}, {
   3.8267413654707212`*^9, 3.8267414220287323`*^9}, {3.8267414851389227`*^9, 
   3.826741485981628*^9}, {3.8267415469730387`*^9, 3.826741552496661*^9}, 
   3.8267468261494713`*^9, {3.826746880354741*^9, 3.826746887361047*^9}, 
   3.826746927655795*^9, {3.8267782663292522`*^9, 3.826778267438078*^9}, 
   3.826787148720089*^9, {3.8267886428035727`*^9, 3.826788644788178*^9}, {
   3.826788874199359*^9, 3.826788877745757*^9}, {3.826789483674252*^9, 
   3.826789485733569*^9}, {3.826790325012451*^9, 3.826790334855319*^9}, {
   3.8267909561900578`*^9, 3.826791002208929*^9}, {3.826791140076524*^9, 
   3.826791157082987*^9}, {3.8314553151706123`*^9, 3.831455318709008*^9}, {
   3.831455436290523*^9, 3.8314554574731913`*^9}, {3.83145560778415*^9, 
   3.831455619115917*^9}, {3.831455780061911*^9, 3.83145578125496*^9}, {
   3.831455854084832*^9, 3.83145586321454*^9}, {3.8314560768327637`*^9, 
   3.831456077241248*^9}, {3.831457014660515*^9, 3.8314570156122026`*^9}, {
   3.831457510876141*^9, 3.831457547713481*^9}, {3.831495612621667*^9, 
   3.831495617822191*^9}, {3.831495664177681*^9, 3.83149567742943*^9}, {
   3.831495753616089*^9, 3.831495767885497*^9}, {3.831495800232214*^9, 
   3.831495805362604*^9}, {3.8314958416853447`*^9, 3.831495858436157*^9}, {
   3.8314959152823877`*^9, 3.8314959160126257`*^9}, {3.831496235437895*^9, 
   3.831496237513307*^9}, {3.831498153477954*^9, 3.831498166870716*^9}, {
   3.831498304403758*^9, 3.8314983051095123`*^9}, {3.831529613672267*^9, 
   3.831529641829269*^9}, {3.8315303314097023`*^9, 3.831530331664961*^9}, {
   3.831719342277*^9, 3.831719353348557*^9}, {3.831719523964628*^9, 
   3.8317195727631617`*^9}, {3.83173966798881*^9, 3.831739668778665*^9}, {
   3.831740077882123*^9, 3.831740078639255*^9}, {3.8319813263678017`*^9, 
   3.8319813333510027`*^9}, {3.831986655250884*^9, 3.8319866562781143`*^9}, {
   3.831986828784374*^9, 3.831986833104121*^9}, {3.832058176818738*^9, 
   3.832058178057377*^9}, {3.8320583424049187`*^9, 3.832058343583805*^9}, {
   3.832063209579536*^9, 3.8320632107276278`*^9}, {3.832064024988419*^9, 
   3.8320640259764*^9}, {3.83206509770455*^9, 3.8320651046111813`*^9}, {
   3.8320655580126038`*^9, 3.8320655597814293`*^9}, {3.833279831339108*^9, 
   3.833279923732565*^9}, {3.8332799685239162`*^9, 3.833280031577898*^9}, {
   3.8332824296713457`*^9, 3.833282430329876*^9}, {3.833283448964033*^9, 
   3.833283450033428*^9}, {3.833356839342844*^9, 3.833356842908008*^9}, 
   3.833356945910289*^9, {3.83335698127297*^9, 3.833356982180999*^9}, {
   3.8333574663479853`*^9, 3.8333574698343763`*^9}, {3.833455459261056*^9, 
   3.833455459445706*^9}, {3.8339980925849543`*^9, 3.833998096693747*^9}, 
   3.833998312194483*^9, {3.834002218542345*^9, 3.8340022434166594`*^9}, {
   3.834002275389736*^9, 3.834002294693252*^9}, {3.8340461558911457`*^9, 
   3.834046173405208*^9}, {3.834127368122781*^9, 3.834127394528672*^9}, {
   3.835472476069433*^9, 3.8354725630381117`*^9}, {3.835472648183673*^9, 
   3.835472764653825*^9}, {3.835473414441287*^9, 3.835473428900317*^9}, {
   3.835473595053505*^9, 3.835473712574977*^9}, {3.835474019603677*^9, 
   3.835474060184654*^9}, {3.836919741555204*^9, 3.836919784628749*^9}, {
   3.8371473324647017`*^9, 3.837147378249689*^9}, {3.850484217005662*^9, 
   3.850484274819066*^9}, {3.8504859128649597`*^9, 3.8504859571397333`*^9}, {
   3.850486163877418*^9, 3.8504861755427017`*^9}, {3.850487550016069*^9, 
   3.85048756314012*^9}, {3.850487803413947*^9, 3.8504878093316193`*^9}, {
   3.850488132696266*^9, 3.8504881393347*^9}, {3.8505423201164503`*^9, 
   3.850542322205769*^9}, {3.8505424625261374`*^9, 3.8505424955390377`*^9}, {
   3.8505781613763723`*^9, 3.8505781731775427`*^9}, {3.850579162986046*^9, 
   3.850579170700952*^9}, 3.8506323681713753`*^9, {3.8506325231531153`*^9, 
   3.850632620261703*^9}, {3.850712175778759*^9, 3.850712180509404*^9}, {
   3.850712618787881*^9, 3.8507126222810926`*^9}, {3.850712679357748*^9, 
   3.850712690220286*^9}, {3.850805597889509*^9, 3.8508056011766768`*^9}, {
   3.850805917676055*^9, 3.850805920467605*^9}, {3.850806654445088*^9, 
   3.850806658800313*^9}, {3.8508066948472567`*^9, 3.850806695989957*^9}, {
   3.850814883381968*^9, 3.85081488371972*^9}, {3.85081492266778*^9, 
   3.850814927510345*^9}, {3.850827829877652*^9, 3.850827850766757*^9}, {
   3.850845126530452*^9, 3.8508451458241*^9}, {3.8508796537047033`*^9, 
   3.850879654100772*^9}, {3.8509709424127293`*^9, 3.850970954375321*^9}, {
   3.850983264370288*^9, 3.850983268092772*^9}, {3.850990867491825*^9, 
   3.8509908816008253`*^9}, {3.852014167740056*^9, 3.852014181074997*^9}, {
   3.8520325779506617`*^9, 3.8520325847919817`*^9}, {3.85204756517204*^9, 
   3.852047596989232*^9}, 3.8520480337826967`*^9, {3.85208883491218*^9, 
   3.852088838134057*^9}, {3.852119902299098*^9, 3.852119905849111*^9}, {
   3.852618670238964*^9, 3.852618672509355*^9}, {3.852618786937015*^9, 
   3.852618793546336*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"d59efb8e-5439-4ec9-b913-64b1683d8faf"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Random gates generation related", "Subsection",
 CellChangeTimes->{{3.8211291780732937`*^9, 3.821129199186705*^9}, {
  3.821294812613449*^9, 
  3.82129483075172*^9}},ExpressionUUID->"8bc0f4f2-35d8-464a-9cf4-\
1e017ee3b0d2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"slotCount", "::", "usage"}], "=", 
  "\"\<slotCount[f]. Count the slot number in a pure function.\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"slotCount", "[", "f_Function", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "deleteInner", "}"}], ",", 
    RowBox[{
     RowBox[{"deleteInner", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"f", ",", 
        RowBox[{"_Function", "\[RuleDelayed]", 
         RowBox[{"Sequence", "[", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "Infinity"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"deleteInner", ",", "_Slot", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "Infinity"}], "}"}], ",", 
         RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}], "]"}], "//", 
      "Length"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"slotCount", "[", "f_Subscript", "]"}], ":=", "0"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gateIdxLen", "[", "gate_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "lidx", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "gate", "]"}], "===", "Function"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lidx", "=", 
         RowBox[{"slotCount", "[", "gate", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"lidx", "===", "0"}], ",", 
          RowBox[{"lidx", "=", 
           RowBox[{"Length", "@", 
            RowBox[{
            "gate", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"lidx", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"GetIndicesOfGate", "[", "gate", "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "lidx"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.835080789094059*^9, 3.8350807890945473`*^9}, {
  3.835082743188176*^9, 3.835082744275662*^9}, {3.835084587790079*^9, 
  3.835084608087885*^9}, {3.83547168728804*^9, 3.835471690687805*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"336db206-e2dd-4e26-8577-7b1820ca40eb"],

Cell[BoxData["\<\"slotCount[f]. Count the slot number in a pure \
function.\"\>"], "Output",
 CellChangeTimes->{
  3.835084634747047*^9, 3.8350862818760033`*^9, 3.8350883755822353`*^9, 
   3.835099449432117*^9, 3.835105689627887*^9, 3.8351165883316393`*^9, 
   3.835126196226*^9, 3.8351264567488613`*^9, 3.835473351663992*^9, 
   3.835473382178719*^9, 3.8354734546330347`*^9, 3.83547397813696*^9, 
   3.835887010039814*^9, 3.836557699455289*^9, 3.83662176898962*^9, 
   3.836638507592863*^9, {3.836671214450035*^9, 3.83667123701965*^9}, 
   3.836671353089546*^9, 3.83667146879914*^9, 3.836671585074884*^9, 
   3.8366725747862864`*^9, 3.836672792905484*^9, 3.8367374446773643`*^9, 
   3.836815882213602*^9, 3.8368159275621367`*^9, 3.836815962862818*^9, 
   3.83681637216612*^9, 3.8368164091002283`*^9, 3.836816697267315*^9, 
   3.8368167540996637`*^9, 3.836817134720707*^9, {3.83681723132209*^9, 
   3.836817250448559*^9}, 3.836817375513892*^9, 3.83681741447301*^9, 
   3.836817519323531*^9, 3.836817627050997*^9, 3.836847268921961*^9, 
   3.836847385979774*^9, 3.8368474518319807`*^9, 3.8368477317720947`*^9, 
   3.836847992770664*^9, 3.836887142387371*^9, 3.836888978127738*^9, 
   3.8368890422536707`*^9, 3.836889114294133*^9, 3.836889171483212*^9, 
   3.8368910677469263`*^9, 3.836891117631171*^9, 3.836891174755204*^9, 
   3.836928486400415*^9, 3.836969167748249*^9, 3.836970063635786*^9, 
   3.836970592565711*^9, 3.836970674915262*^9, 3.836970751496315*^9, 
   3.8370026723995667`*^9, 3.837146515795416*^9, 3.83714656394106*^9, 
   3.837146680461156*^9, 3.8371473868663483`*^9, 3.842250929886303*^9, 
   3.843540815949552*^9, {3.8504844269229517`*^9, 3.8504844363681507`*^9}, 
   3.850484476483514*^9, 3.850485413659658*^9, 3.850485603666329*^9, 
   3.850578360595509*^9, {3.850579203980527*^9, 3.850579213154666*^9}, 
   3.850661898344245*^9, 3.8506623001789713`*^9, 3.850712614492543*^9, 
   3.85080671963558*^9, 3.8508087734933567`*^9, 3.85081396418908*^9, 
   3.850814799780546*^9, 3.8508168933283987`*^9, 3.850817388069994*^9, 
   3.850817673159045*^9, 3.850818357333571*^9, 3.850818456931931*^9, {
   3.8508278231967983`*^9, 3.850827835799573*^9}, 3.85082786685736*^9, 
   3.8508454044391336`*^9, {3.850879661099896*^9, 3.85087968122652*^9}, 
   3.8509908802114763`*^9, 3.8520137316982393`*^9, 3.8520138337876873`*^9, 
   3.8520139483657713`*^9, 3.852618728439608*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"ca48d0bf-87ea-4d08-8f00-f108b2ddd000"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RandomGate", "::", "usage"}], "=", 
   "\"\<RandomGate[conf]. Generate a random gate given the \
configuration.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"RandomGate", ",", "HoldFirst"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RandomGate", "[", "conf_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gatepool", ",", "indices", ",", 
      RowBox[{"ngatespool", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"conf", "[", "\"\<gateset\>\"", "]"}]}]}], ",", "newgate", 
      ",", "nqgate", ",", 
      RowBox[{"trial", "=", "0"}], ",", "nidx", ",", "swapforms", ",", 
      "idxtrial"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"nqgate", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"conf", "[", "\"\<weightgate\>\"", "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "\[Rule]", 
        RowBox[{
         RowBox[{"conf", "[", "\"\<weightgate\>\"", "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"gatepool", "=", 
      RowBox[{"Permute", "[", 
       RowBox[{
        RowBox[{"conf", "[", "\"\<gateset\>\"", "]"}], ",", 
        RowBox[{"RandomPermutation", "[", "ngatespool", "]"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"choose", " ", "the", " ", "gate"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"newgate", "=", 
         RowBox[{"RandomChoice", "[", "gatepool", "]"}]}], ";", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"nidx", "=", 
         RowBox[{"gateIdxLen", "[", "newgate", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nidx", "\[NotEqual]", " ", "nqgate"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "@", "newgate"}], "===", "Function"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Function", " ", "form"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"indices", "=", 
            RowBox[{"RandomSample", "[", 
             RowBox[{
              RowBox[{"conf", "[", "\"\<ansatzspace\>\"", "]"}], ",", 
              "nqgate"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"newgate", "=", 
            RowBox[{"newgate", "@@", "indices"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Break", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"++", "trial"}], ">", "100"}], ",", 
          RowBox[{
          "Return", "[", 
           "\"\<Your gateset and hardware gates dont match.\>\"", "]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "newgate"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.821211053481781*^9, 3.821211057082307*^9}, {
   3.821211107461388*^9, 3.821211146278824*^9}, {3.82121119418298*^9, 
   3.821211211573235*^9}, {3.821212792581646*^9, 3.8212128017925777`*^9}, {
   3.821212842452324*^9, 3.821212845333952*^9}, {3.821222790947249*^9, 
   3.8212228255712957`*^9}, {3.8212229552129583`*^9, 
   3.8212229610452433`*^9}, {3.821223088899898*^9, 3.821223152745389*^9}, {
   3.82127657222432*^9, 3.82127658590271*^9}, {3.821294790137776*^9, 
   3.82129479311372*^9}, {3.821294846125636*^9, 3.821294876667325*^9}, {
   3.822860949638047*^9, 3.822861085973349*^9}, {3.822861240894787*^9, 
   3.822861248164556*^9}, {3.82361077023706*^9, 3.823610779717332*^9}, {
   3.823610843888846*^9, 3.8236108789414167`*^9}, {3.823610909984694*^9, 
   3.823610982176641*^9}, {3.8236110459799623`*^9, 3.823611111053121*^9}, 
   3.823614045711873*^9, {3.823615568281521*^9, 3.823615616067548*^9}, {
   3.82361594156811*^9, 3.823615943480225*^9}, {3.823615997967476*^9, 
   3.8236160233258257`*^9}, {3.823616102774231*^9, 3.823616361924815*^9}, {
   3.8273457434562683`*^9, 3.827345815618978*^9}, 3.827345847375451*^9, 
   3.827345942132071*^9, {3.82734598045263*^9, 3.827345991755144*^9}, {
   3.827346034177433*^9, 3.827346061794156*^9}, {3.827346436683916*^9, 
   3.8273464426354237`*^9}, {3.827346576458173*^9, 3.827346583446295*^9}, {
   3.827346711224354*^9, 3.827346718035988*^9}, {3.827346905082059*^9, 
   3.827346943459874*^9}, {3.827347054353827*^9, 3.827347104738797*^9}, {
   3.8338768229212646`*^9, 3.833876840008181*^9}, {3.834745550725882*^9, 
   3.8347456089072742`*^9}, {3.834745660417335*^9, 3.834745753967931*^9}, {
   3.8347458064288177`*^9, 3.834745834277896*^9}, {3.834745997071066*^9, 
   3.834746021928718*^9}, {3.834746058155314*^9, 3.834746061080752*^9}, {
   3.834746572887467*^9, 3.8347467213620977`*^9}, {3.83474691940774*^9, 
   3.8347470242351522`*^9}, {3.834747068814962*^9, 3.834747094327911*^9}, {
   3.8347472678183613`*^9, 3.834747279647365*^9}, {3.834747312956851*^9, 
   3.834747327862329*^9}, {3.834747718432692*^9, 3.834747743741581*^9}, {
   3.834747936316923*^9, 3.834748049484922*^9}, {3.834748183575695*^9, 
   3.834748332240588*^9}, {3.834748543274914*^9, 3.834748544590815*^9}, {
   3.835002028293394*^9, 3.83500205627518*^9}, 3.8350023968973923`*^9, {
   3.835002967441381*^9, 3.83500298623601*^9}, {3.835003111455964*^9, 
   3.8350032689533987`*^9}, {3.835003318481223*^9, 3.8350033194315147`*^9}, {
   3.8350046693345003`*^9, 3.835004707659972*^9}, {3.8350047633683653`*^9, 
   3.835004768924683*^9}, {3.835004843685717*^9, 3.835004845772009*^9}, {
   3.835005178995305*^9, 3.835005180430621*^9}, {3.835006246918736*^9, 
   3.835006247211801*^9}, {3.8350073651814833`*^9, 3.8350073712916603`*^9}, 
   3.8350093707852716`*^9, {3.835009849054274*^9, 3.835009875736953*^9}, {
   3.835010517627646*^9, 3.835010522509713*^9}, 3.835010663229039*^9, {
   3.8350110634427853`*^9, 3.835011079480441*^9}, {3.835014675311263*^9, 
   3.835014741614357*^9}, {3.8350153252171164`*^9, 3.835015549472519*^9}, {
   3.835015599883896*^9, 3.835015635575227*^9}, 3.8350158224530497`*^9, {
   3.8350813301878233`*^9, 3.835081332071846*^9}, {3.835082774793323*^9, 
   3.835082839037196*^9}, {3.835083164235015*^9, 3.835083555065625*^9}, {
   3.835083586488872*^9, 3.8350836497301083`*^9}, {3.835083694100637*^9, 
   3.8350836961282663`*^9}, {3.8350837323309317`*^9, 3.835083755420382*^9}, {
   3.835083787923875*^9, 3.8350838573323917`*^9}, {3.835085062910646*^9, 
   3.835085083727557*^9}, {3.835085136451303*^9, 3.835085154290332*^9}, {
   3.8350851979263563`*^9, 3.835085212457591*^9}, {3.835085243160082*^9, 
   3.835085369484853*^9}, {3.8350854129777813`*^9, 3.835085553004809*^9}, {
   3.8350855989268837`*^9, 3.835085650786237*^9}, {3.835085940027137*^9, 
   3.835085963393211*^9}, {3.835086905744803*^9, 3.83508716806411*^9}, {
   3.835087214290823*^9, 3.8350873898477716`*^9}, {3.835088511448403*^9, 
   3.8350885593169603`*^9}, {3.835088622477759*^9, 3.835088632607217*^9}, {
   3.8350886752169027`*^9, 3.835088678332713*^9}, {3.835088816912648*^9, 
   3.835088825311335*^9}, {3.835103994251163*^9, 3.835104023467353*^9}, {
   3.835104054276087*^9, 3.835104108961931*^9}, {3.835104148491415*^9, 
   3.835104194640313*^9}, {3.835104238489354*^9, 3.835104246344083*^9}, {
   3.835105712254649*^9, 3.8351057136539593`*^9}, {3.8351058174017572`*^9, 
   3.835105828714332*^9}, {3.8351262175479*^9, 3.835126254586536*^9}, {
   3.83512636032325*^9, 3.835126360710228*^9}, {3.835126469085246*^9, 
   3.8351264907420673`*^9}, {3.835126547190123*^9, 3.8351265790236263`*^9}, 
   3.8351266511773977`*^9, {3.835126689586296*^9, 3.8351266907894287`*^9}, {
   3.835127794953038*^9, 3.8351278178687477`*^9}, {3.835127861695808*^9, 
   3.835127866817526*^9}, {3.835127899529853*^9, 3.835128106750216*^9}, {
   3.8351287023333673`*^9, 3.835128812153344*^9}, {3.835128911457788*^9, 
   3.8351289240930557`*^9}, {3.835473051386921*^9, 3.835473155519843*^9}, 
   3.8354735045006943`*^9, {3.835473793205996*^9, 3.835473793706019*^9}, {
   3.835473828077209*^9, 3.835473829973194*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"16c427de-5418-4c81-ba37-a0a6b3d3dd3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ExtendAnsatz", "::", "usage"}], "=", 
   "\"\<ExtendAnsatz[conf, ansatz, naddgates].\nExtend ansatz by adding \
naddgates gates. There is no redundancy check here. \nArguments aren't \
changed, except the start index. Return the new ansatz candidate.\nAnsatz is \
done 50% globally spread, 25% appended at the end, and 25% appended in the \
begining.\nReturn: extended ansatz\n\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"ExtendAnsatz", ",", "HoldFirst"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExtendAnsatz", "[", 
   RowBox[{"idx_", ",", "conf_", ",", "ansatz_", ",", "naddgates_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"linit", "=", 
       RowBox[{"Length", "@", "ansatz"}]}], ",", 
      RowBox[{"ansatztmp", "=", "ansatz"}], ",", "assocgates", ",", "rloc", 
      ",", "rgate", ",", "i", ",", "method"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"method", ":", " ", 
       RowBox[{"1", "-", "global"}]}], ",", " ", 
      RowBox[{"2", "-", 
       RowBox[{"appended", " ", "end"}]}], ",", " ", 
      RowBox[{"3", "-", 
       RowBox[{"appended", " ", "begining"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"method", "=", 
      RowBox[{"RandomChoice", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.25", ",", "0.25"}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], " ", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"method", "===", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", "naddgates"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"globally", " ", "spread", " ", "at", " ", "random"}], ";",
            " ", 
           RowBox[{"no", " ", "redundancy", " ", "check"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rloc", "=", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"Length", "@", "ansatztmp"}], "+", "1"}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rgate", "=", 
           RowBox[{
            RowBox[{"RandomGate", "[", "conf", "]"}], "/.", 
            RowBox[{"\[Theta]", "\[RuleDelayed]", 
             SubscriptBox["\[Theta]", 
              RowBox[{"idx", "++"}]]}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ansatztmp", "=", 
           RowBox[{"Insert", "[", 
            RowBox[{"ansatztmp", ",", "rgate", ",", "rloc"}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "appended", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ansatztmp", "=", 
         RowBox[{"GenerateAnsatz", "[", 
          RowBox[{"naddgates", ",", "conf", ",", "ansatz"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ansatztmp", "=", 
         RowBox[{"ansatztmp", "/.", 
          RowBox[{"\[Theta]", "\[RuleDelayed]", 
           SubscriptBox["\[Theta]", 
            RowBox[{"idx", "++"}]]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"method", "===", "2"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"append", " ", "at", " ", "the", " ", "end"}], " ", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ansatztmp", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"ansatz", ",", "ansatztmp"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"append", " ", "in", " ", "the", " ", "beginning"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ansatztmp", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"ansatztmp", ",", "ansatz"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "ansatztmp"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8225103508733377`*^9, 3.82251042273604*^9}, {
   3.822510561512796*^9, 3.8225105796439867`*^9}, {3.822510699716448*^9, 
   3.822510792752338*^9}, {3.822510904385147*^9, 3.8225109231546383`*^9}, {
   3.822510964768598*^9, 3.822510971095509*^9}, {3.822511023601866*^9, 
   3.822511067580325*^9}, {3.822511138878039*^9, 3.8225111496516848`*^9}, 
   3.822511217282497*^9, {3.822511278783037*^9, 3.822511312843759*^9}, {
   3.82251135188765*^9, 3.8225113701253033`*^9}, {3.822511408188191*^9, 
   3.822511457220406*^9}, {3.822511564680543*^9, 3.8225115723476*^9}, {
   3.822511616668672*^9, 3.822511805848434*^9}, {3.822512119815372*^9, 
   3.822512159290296*^9}, {3.822512195847115*^9, 3.822512221426786*^9}, {
   3.822512257927112*^9, 3.8225122894722977`*^9}, {3.822512549826274*^9, 
   3.822512568056159*^9}, {3.822512599293363*^9, 3.822512600408626*^9}, {
   3.8225126611569147`*^9, 3.822512665525062*^9}, {3.8225128092511377`*^9, 
   3.822512869905108*^9}, {3.822515277447317*^9, 3.822515277863172*^9}, {
   3.822515890598476*^9, 3.8225159365631332`*^9}, {3.82251603038221*^9, 
   3.82251605478272*^9}, {3.82251633742994*^9, 3.822516378903781*^9}, {
   3.822780217191021*^9, 3.8227802763508987`*^9}, {3.82278030709058*^9, 
   3.8227803769479637`*^9}, {3.822780885683519*^9, 3.822780928539036*^9}, {
   3.823420433944407*^9, 3.823420507469698*^9}, {3.8234205930502872`*^9, 
   3.823420647926174*^9}, {3.823420834548324*^9, 3.823420869139626*^9}, {
   3.823420987160308*^9, 3.823421109727474*^9}, {3.8234211939818783`*^9, 
   3.823421206938301*^9}, 3.8236145669794407`*^9, {3.823614642839005*^9, 
   3.823614686459836*^9}, {3.823614788798781*^9, 3.823614789121813*^9}, {
   3.823615410651177*^9, 3.82361543265734*^9}, {3.8236154798228817`*^9, 
   3.82361548453759*^9}, {3.823615519915835*^9, 3.82361552019497*^9}, 
   3.8354732351699743`*^9, {3.8354733213706703`*^9, 3.835473344915766*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"c3d1114c-8972-44e7-b083-793ce614511c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GenerateAnsatz", "::", "usage"}], "=", 
   "\"\<GenerateAnsatz[nqubit,ngates,conf,ansatzref:{}] generate an ansatz on \
a subspace specified in conf[`ansatzspace`].\n Suitable for extending ansatz \
by appending the new gates after the old ones.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"GenerateAnsatz", ",", "HoldRest"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenerateAnsatz", "[", 
   RowBox[{"ngates_", ",", "conf_", ",", 
    RowBox[{"ansatzref_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ansatz", "=", 
       RowBox[{"{", "}"}]}], ",", "ansatzparam", ",", "gate", ",", 
      RowBox[{"indices", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"trial", "=", 
       RowBox[{"-", "1"}]}], ",", "x", ",", "y", ",", "z", ",", "testpattern",
       ",", 
      RowBox[{"assocgates", "=", 
       RowBox[{"<|", "|>"}]}], ",", "\[IndentingNewLine]", "newindices", ",", 
      "Akl", ",", 
      RowBox[{"\[Theta]vars", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"idx", "=", "0"}], ",", "j", ",", 
      RowBox[{"wmsg", "=", "\"\<\>\""}], ",", 
      RowBox[{"maxtrial", "=", 
       RowBox[{"2", "*", "ngates"}]}], ",", "restcond", ",", 
      "ansatzohneindex"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "ansatzref"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ansatzohneindex", "=", 
         RowBox[{"ansatzref", "/.", 
          RowBox[{
           SubscriptBox["\[Theta]", "_"], "\[Rule]", "\[Theta]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"GetAssocGates", "[", 
         RowBox[{"ansatzohneindex", ",", "assocgates"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "ansatz"}], "<", "ngates"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"adding", " ", "gate", " ", "one", " ", "by", " ", "one"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"ansatz", ",", 
          RowBox[{"RandomGate", "[", "conf", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newindices", "=", 
         RowBox[{"GetIndicesOfGate", "[", 
          RowBox[{"Last", "@", "ansatz"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[Not]", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"assocgates", ",", "i"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"assocgates", "[", "i", "]"}], "=", 
              RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"assocgates", "[", "i", "]"}], ",", 
             RowBox[{"Last", "@", "ansatz"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "newindices"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "return", " ", "whatever", " ", "after", " ", "fail", " ", "to", " ",
           "find", " ", "the", " ", "good", " ", "one"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"trial", "++"}], ">", "maxtrial"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Failed to find the good ansatz with \>\"", "<>", 
             RowBox[{"ToString", "[", "ngates", "]"}], "<>", 
             "\"\< gates\>\""}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"test", " ", "pattern"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Or", "@@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"assocgates", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"___", ",", "x_", ",", "x_"}], "}"}]}], "]"}], "||", 
              "\[IndentingNewLine]", 
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"IsOneQGate", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"assocgates", "[", "i", "]"}]}], ")"}], ",", 
                RowBox[{"{", 
                 RowBox[{"___", ",", "1", ",", "1", ",", "1", ",", "1"}], 
                 "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "newindices"}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Delete", " ", "the", " ", "last", " ", "gate"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ansatz", "=", 
            RowBox[{"Drop", "[", 
             RowBox[{"ansatz", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"assocgates", "[", "i", "]"}], "=", 
              RowBox[{"Drop", "[", 
               RowBox[{
                RowBox[{"assocgates", "[", "i", "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "newindices"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "ansatz"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.820067291162745*^9, 3.82006744151583*^9}, {
   3.820067616622252*^9, 3.820067643412346*^9}, {3.8200678702696943`*^9, 
   3.8200678719793262`*^9}, {3.820068219855094*^9, 3.820068283178565*^9}, {
   3.8212097334804163`*^9, 3.821209768326539*^9}, {3.821209898726635*^9, 
   3.821209904201894*^9}, {3.8212099634514313`*^9, 3.821210068657999*^9}, {
   3.8212101010551023`*^9, 3.821210120446919*^9}, {3.821210949075779*^9, 
   3.8212109958164377`*^9}, {3.821211167880692*^9, 3.821211176923472*^9}, {
   3.821211376045136*^9, 3.821211427865377*^9}, {3.8212114796739807`*^9, 
   3.8212114960095253`*^9}, {3.821212506978045*^9, 3.8212125176938963`*^9}, {
   3.821212687317034*^9, 3.82121270040245*^9}, {3.8212127465265627`*^9, 
   3.8212127614551888`*^9}, {3.821222839651848*^9, 3.8212228458232193`*^9}, {
   3.821223332305893*^9, 3.821223333200255*^9}, {3.821283526691218*^9, 
   3.821283535593761*^9}, {3.8212948926663637`*^9, 3.821294897913508*^9}, {
   3.821294959328724*^9, 3.8212950383664618`*^9}, {3.821428322037043*^9, 
   3.821428322165259*^9}, {3.821428389321467*^9, 3.821428428975959*^9}, {
   3.8214287223919086`*^9, 3.821428731105875*^9}, {3.821428771298444*^9, 
   3.8214287740416822`*^9}, {3.821428830790443*^9, 3.8214288317455606`*^9}, {
   3.8214290753402576`*^9, 3.821429087785557*^9}, {3.821429132198698*^9, 
   3.8214291383378553`*^9}, {3.821429231665127*^9, 3.82142929947584*^9}, {
   3.821429342548582*^9, 3.821429351690527*^9}, {3.821429406392004*^9, 
   3.821429412218886*^9}, {3.821429454034584*^9, 3.821429484476812*^9}, {
   3.821429610045368*^9, 3.821429611130475*^9}, 3.8214296482394333`*^9, {
   3.8214298027506027`*^9, 3.821429811492475*^9}, {3.821429867593882*^9, 
   3.821429903922015*^9}, {3.8214431292289553`*^9, 3.8214431424003973`*^9}, {
   3.8214431770588427`*^9, 3.821443205422512*^9}, {3.821443339885743*^9, 
   3.8214434051193533`*^9}, {3.8214434590326147`*^9, 3.821443459294072*^9}, {
   3.8225104366176233`*^9, 3.822510513127597*^9}, {3.823614759910266*^9, 
   3.823614766858691*^9}, {3.8338783322620087`*^9, 3.833878341495797*^9}, 
   3.835473313635446*^9, {3.8354739257649*^9, 3.835473937110798*^9}, {
   3.837230974348888*^9, 3.837230980007491*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"09a958fd-760a-4f76-87b4-e1f36b6b64d2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Modules and delayed functions of compilations", "Subsection",
 CellChangeTimes->{{3.821294734161747*^9, 
  3.821294772872951*^9}},ExpressionUUID->"86d71386-1a3b-4b80-81b4-\
3a549c53d3cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetIndicesOfGate", "::", "usage"}], "=", 
   "\"\<GetIndicesOfGate[gate_] return indices of the corresponding qubits, \
watch for exotic gates, it might fail!\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetIndicesOfGate", "[", "gate_", "]"}], ":=", 
   RowBox[{"gate", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"_", "[", 
        RowBox[{"_", ",", 
         RowBox[{
          SubscriptBox["_", "i_"], 
          SubscriptBox["_", "j_"]}]}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["C", "i_"], "[", 
        SubscriptBox["_", "j_"], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["_", "i__"], "[", 
        RowBox[{
         SubscriptBox["_", "j_"], "[", "_", "]"}], "]"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}]}], ",", 
      RowBox[{
       RowBox[{
        SubscriptBox["_", "i__"], "[", "_", "]"}], "\[Rule]", 
       RowBox[{"{", "i", "}"}]}], ",", 
      RowBox[{
       SubscriptBox["_", "i__"], "\[Rule]", 
       RowBox[{"{", "i", "}"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAssocGates", "::", "usage"}], "=", 
   "\"\<GetAssocGates[ansatz_,assocgatesref_] return association version of \
gates -- per layer. It might works only for 1 and 2-qubit gates \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"GetAssocGates", ",", "HoldRest"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetAssocGates", "[", 
    RowBox[{"ansatz_", ",", "assocgatesref_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"indices", ",", "key", ",", "idxs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"ToString", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"GetIndicesOfGate", "[", "gate", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"key", "=", 
         RowBox[{"StringRiffle", "[", 
          RowBox[{
           RowBox[{"Sort", "@", "indices"}], ",", "\"\<-\>\""}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{"assocgatesref", ",", "key"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"assocgatesref", "[", "key", "]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "put", " ", "also", " ", "gates", " ", "in", " ", "the", " ", 
          "overlaping", " ", "cases"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"idxs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"key", ",", "indices"}], "}"}], "//", "Flatten"}], "//", 
          "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", " ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IntersectingQ", "[", 
             RowBox[{"idxs", ",", 
              RowBox[{"StringSplit", "[", 
               RowBox[{"k", ",", "\"\<-\>\""}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{"assocgatesref", "[", "k", "]"}], ",", "gate"}], 
             "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Keys", "@", "assocgatesref"}]}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"gate", ",", "ansatz"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"temporary", " ", "solution"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsOneQGate", "::", "usage"}], "=", 
   "\"\<IsOneQGate[gate_] tells if gate is a one-qubit rotation \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IsOneQGate", "[", "g_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["Rx", "i"], "[", "\[Theta]", "]"}], ",", 
         RowBox[{
          SubscriptBox["Ry", "i"], "[", "\[Theta]", "]"}], ",", 
         RowBox[{
          SubscriptBox["Rz", "i"], "[", "\[Theta]", "]"}]}], "}"}], "/.", 
       RowBox[{"i", "\[Rule]", 
        RowBox[{
         RowBox[{"GetIndicesOfGate", "[", "g", "]"}], "\[LeftDoubleBracket]", 
         "1", "\[RightDoubleBracket]"}]}]}], ",", "g"}], "]"}], ",", "1", ",",
     "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsControlQubit", "::", "usage"}], "=", 
   "\"\<IsControlQubit[gate_] tells if a gate is Controlled-Rotation \
gate\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IsControlQubit", "[", "g_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MatchQ", "[", 
     RowBox[{"g", ",", 
      RowBox[{
       SubscriptBox["C", "_"], "[", "_", "]"}]}], "]"}], ",", "1", ",", "0"}],
    "]"}]}]}], "Input",
 CellChangeTimes->{{3.821295109933714*^9, 3.821295205333378*^9}, {
   3.821295630734865*^9, 3.821295746633294*^9}, {3.826706159945641*^9, 
   3.826706170226931*^9}, {3.826706300452044*^9, 3.8267063110425863`*^9}, {
   3.826706392372262*^9, 3.826706401416502*^9}, {3.826706435269744*^9, 
   3.826706448767438*^9}, {3.826706843679255*^9, 3.826706924016656*^9}, {
   3.8267069596855583`*^9, 3.826706964370286*^9}, {3.8267072175847473`*^9, 
   3.826707366831184*^9}, {3.826707406375952*^9, 3.826707555340001*^9}, 
   3.826708857378797*^9, {3.826709836393098*^9, 3.826709883190195*^9}, {
   3.8267103279221907`*^9, 3.826710345127419*^9}, {3.826710526303787*^9, 
   3.826710543025364*^9}, {3.826710654816433*^9, 3.8267107056144543`*^9}, {
   3.826710752274165*^9, 3.826710778190982*^9}, {3.826710814445335*^9, 
   3.826710911636353*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"a0dd377d-8d24-4f0f-a698-b5a7b7d2df22"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gradient evals and optimization", "Subsection",
 CellChangeTimes->{{3.8211291780732937`*^9, 3.821129199186705*^9}, {
  3.821220029699461*^9, 3.821220036793016*^9}, {3.822585279874415*^9, 
  3.822585280201477*^9}, {3.823592708597734*^9, 
  3.823592710742581*^9}},ExpressionUUID->"4b588684-548a-4e1e-aed2-\
19b22ae42b45"],

Cell[BoxData[
 RowBox[{"Remove", "[", 
  RowBox[{
  "GradDescent", ",", " ", "NatGrad", ",", "CalcEcurVarGrad", ",", " ", 
   "RelaxAnsatz"}], "]"}]], "Input",
 CellChangeTimes->{{3.821296769844429*^9, 3.821296777558631*^9}, {
  3.823534469183619*^9, 3.8235344706545353`*^9}, {3.823592723763975*^9, 
  3.8235927279769506`*^9}, {3.825788110064734*^9, 3.825788112430414*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"06c0f746-bfa5-400b-a757-751bf6da5e6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Calculate", " ", "<", 
      RowBox[{"ansatz", 
       RowBox[{"(", "\[Theta]", ")"}]}]}], "|", "hamiltonian", "|", 
     RowBox[{
      RowBox[{"ansatz", 
       RowBox[{"(", "\[Theta]", ")"}]}], ">"}]}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GradDescent", "::", "usage"}], "=", 
     "\"\<GradDescent[conf, hamiltonian, \[Theta]vars, ansatz, \[Psi], \
\[Psi]work] Steepest-garadient descent method, invoked when \[Theta]vars has \
only one entry\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"GradDescent", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GradDescent", "[", 
     RowBox[{
     "conf_", ",", "hamiltonian_", ",", "\[Theta]vars_", ",", "ansatz_", ",", 
      "\[Psi]_", ",", "\[Psi]work_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"gradList", "=", 
         RowBox[{"{", "}"}]}], ",", "baseE", ",", "\[Theta]varst", ",", 
        "newvals"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ApplyCircuit", "[", 
        RowBox[{
         RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
         RowBox[{"ansatz", "/.", "\[Theta]vars"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"baseE", "=", 
        RowBox[{"CalcExpecPauliSum", "[", 
         RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"gradList", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]varst", "=", "\[Theta]vars"}], ";", 
           RowBox[{
            RowBox[{"\[Theta]varst", "[", "k", "]"}], "+=", 
            RowBox[{"conf", "[", "\"\<d\[Theta]\>\"", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ApplyCircuit", "[", 
            RowBox[{
             RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
             RowBox[{"ansatz", "/.", "\[Theta]varst"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"CalcExpecPauliSum", "[", 
               RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], 
               "]"}], "-", "baseE"}], ")"}], "/", 
            RowBox[{"conf", "[", "\"\<d\[Theta]\>\"", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Keys", "[", "\[Theta]vars", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]vars", "[", "#1", "]"}], "-=", 
           RowBox[{
            RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}], "*", "#2"}]}], 
          "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Keys", "[", "\[Theta]vars", "]"}], ",", "gradList"}], 
          "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8188402257802467`*^9, 3.818840295306058*^9}, {
   3.818840347093824*^9, 3.81884040242109*^9}, {3.818857754370862*^9, 
   3.8188578740356073`*^9}, {3.81885794281238*^9, 3.8188581916459846`*^9}, {
   3.818859266806093*^9, 3.8188593292047787`*^9}, {3.818859575363727*^9, 
   3.818859577999069*^9}, {3.818863068653926*^9, 3.818863122860899*^9}, {
   3.818863519948546*^9, 3.818863542475685*^9}, {3.8188641954807167`*^9, 
   3.818864212564416*^9}, {3.8188753990131207`*^9, 3.818875399413454*^9}, {
   3.819711858857606*^9, 3.8197118627781363`*^9}, {3.8212194496169453`*^9, 
   3.821219457017105*^9}, {3.821219995889182*^9, 3.821220000171612*^9}, {
   3.821278487921351*^9, 3.8212784915761633`*^9}, {3.821283510957572*^9, 
   3.8212835122320433`*^9}, {3.821295794994623*^9, 3.821295852537937*^9}, {
   3.8224954101698914`*^9, 3.822495437121378*^9}, {3.8224955567063704`*^9, 
   3.822495558548101*^9}, 3.822495604030249*^9, {3.824298157081708*^9, 
   3.82429817652169*^9}, {3.824849816178541*^9, 3.8248498426566467`*^9}, {
   3.824849873206789*^9, 3.8248499957418756`*^9}, {3.824850610799006*^9, 
   3.824850680599347*^9}, {3.825268018116556*^9, 3.825268073589407*^9}, {
   3.8256647733502483`*^9, 3.8256647834324913`*^9}, {3.825673780204805*^9, 
   3.825673796998872*^9}, {3.8256738465176764`*^9, 3.825673921930035*^9}, {
   3.825674019218742*^9, 3.825674020743771*^9}, {3.825675051181312*^9, 
   3.825675060841704*^9}, {3.8257880592202787`*^9, 3.825788093513323*^9}, {
   3.826745201980463*^9, 3.826745209923526*^9}, {3.8267452831841707`*^9, 
   3.826745321513023*^9}, {3.8267453678917017`*^9, 3.826745394970336*^9}, {
   3.826788403691379*^9, 3.826788419286159*^9}, {3.8267884501473103`*^9, 
   3.826788450332198*^9}, {3.8318156765211067`*^9, 3.831815676717187*^9}, {
   3.843540792596946*^9, 3.843540811365912*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"6dfc71a2-81c6-4e6f-b18f-976a203c5174"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CalcEcurVarGrad", "::", "usage"}], "=", 
   "\"\<CalcEcurVarGrad[conf,ansatz,\[Theta]vars,NG,\[Psi]init,\[Psi]initu,\
\[Psi],\[Psi]work]. Return the minimum energy among different choices of \
gradient. \[Theta]vars is updated.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"CalcEcurVarGrad", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalcEcurVarGrad", "[", 
    RowBox[{
    "conf_", ",", "hamiltonian_", ",", "ansatz_", ",", "\[Theta]vars_", ",", 
     "NG_", ",", "\[Psi]_", ",", "\[Psi]work_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "tvars", ",", "gradsteps", ",", "Ebest", ",", "Enew", ",", "minidx", 
       ",", "gradstep", ",", "beststep"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"gradsteps", "=", 
       RowBox[{
        RowBox[{"conf", "[", "\"\<multigradstep\>\"", "]"}], "*", 
        RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}]}]}], " ", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"gradstep", "=", 
       RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"beststep", "=", "gradstep"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tvars", "=", 
       RowBox[{"Normal", "@", "\[Theta]vars"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"tvars", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-=", 
       RowBox[{"gradstep", "*", "NG"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ApplyCircuit", "[", 
       RowBox[{
        RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
        RowBox[{"ansatz", "/.", "tvars"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ebest", "=", 
       RowBox[{"CalcExpecPauliSum", "[", 
        RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{"True", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gradstep", "*=", 
          RowBox[{"conf", "[", "\"\<gradstepmultiply\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tvars", "=", 
          RowBox[{"Normal", "@", "\[Theta]vars"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tvars", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-=", 
          RowBox[{"gradstep", "*", "NG"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ApplyCircuit", "[", 
          RowBox[{
           RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
           RowBox[{"ansatz", "/.", "tvars"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Enew", "=", 
          RowBox[{"CalcExpecPauliSum", "[", 
           RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Enew", "\[GreaterEqual]", "Ebest"}], ",", " ", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Ebest", "=", "Enew"}], ";", "\[IndentingNewLine]", 
         RowBox[{"beststep", "=", "gradstep"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tvars", "=", 
       RowBox[{"Normal", "@", "\[Theta]vars"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"tvars", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-=", 
       RowBox[{"beststep", "*", "NG"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]vars", "=", 
       RowBox[{"Association", "@", "tvars"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Ebest", ",", "beststep"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalcEcurVarGradOld", "::", "usage"}], "=", 
   "\"\<CalcEcurVarGrad[conf,hamiltonian,ansatz,\[Theta]vars,NG,\[Psi],\[Psi]\
work]. Return the minimum energy among different choices of gradient. \
\[Theta]vars is updated.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"CalcEcurVarGradOld", ",", "HoldAll"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalcEcurVarGradOld", "[", 
   RowBox[{
   "conf_", ",", "hamiltonian_", ",", "ansatz_", ",", "\[Theta]vars_", ",", 
    "NG_", ",", "\[Psi]_", ",", "\[Psi]work_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tvars", ",", "gradsteps", ",", 
      RowBox[{"Ecurs", "=", 
       RowBox[{"{", "}"}]}], ",", "minidx"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"gradsteps", "=", 
      RowBox[{
       RowBox[{"conf", "[", "\"\<multigradstep\>\"", "]"}], "*", 
       RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tvars", "=", 
         RowBox[{"Normal", "@", "\[Theta]vars"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tvars", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-=", 
         RowBox[{"g", "*", "NG"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{
          RowBox[{"ansatz", "/.", "tvars"}], ",", 
          RowBox[{"InitZeroState", "@", "\[Psi]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"Ecurs", ",", 
          RowBox[{"CalcExpecPauliSum", "[", 
           RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], "]"}]}],
          "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "gradsteps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"minidx", "=", 
      RowBox[{"First", "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{"Ecurs", ",", 
          RowBox[{"Min", "[", "Ecurs", "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tvars", "=", 
      RowBox[{"Normal", "@", "\[Theta]vars"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tvars", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-=", 
      RowBox[{
       RowBox[{
       "gradsteps", "\[LeftDoubleBracket]", "minidx", 
        "\[RightDoubleBracket]"}], "*", "NG"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[Theta]vars", "=", 
      RowBox[{"Association", "@", "tvars"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Ecurs", "\[LeftDoubleBracket]", "minidx", "\[RightDoubleBracket]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.822501167758786*^9, 3.8225013978198633`*^9}, {
   3.82250145397721*^9, 3.8225014562569933`*^9}, {3.8225014929321823`*^9, 
   3.822501505909144*^9}, {3.8225015649052563`*^9, 3.822501565221809*^9}, {
   3.822501981087596*^9, 3.8225019815255632`*^9}, {3.8225028862772512`*^9, 
   3.822503075703972*^9}, {3.822503111975678*^9, 3.822503241489229*^9}, {
   3.8225034008371773`*^9, 3.8225035964983253`*^9}, {3.8225053006742077`*^9, 
   3.8225053275112133`*^9}, {3.8225063361622667`*^9, 3.822506356038657*^9}, {
   3.822507168703652*^9, 3.82250721018452*^9}, {3.822507250895001*^9, 
   3.822507356166524*^9}, {3.8225858767037888`*^9, 3.822585882300541*^9}, {
   3.822586018170231*^9, 3.822586043778635*^9}, {3.822586306725877*^9, 
   3.822586311672144*^9}, 3.8225863610246572`*^9, {3.822586498971168*^9, 
   3.822586500699479*^9}, {3.822586808474917*^9, 3.8225868202718687`*^9}, 
   3.8225868541905947`*^9, {3.822587132966751*^9, 3.822587162989271*^9}, {
   3.822587200607856*^9, 3.8225872241314774`*^9}, {3.822587272094627*^9, 
   3.822587329106608*^9}, {3.822587521906859*^9, 3.822587534300653*^9}, {
   3.822588465362074*^9, 3.822588479974429*^9}, {3.8225887145117826`*^9, 
   3.82258872849284*^9}, {3.8225888329888983`*^9, 3.82258917785392*^9}, {
   3.822589320012045*^9, 3.822589320488736*^9}, {3.822589373390956*^9, 
   3.822589399346641*^9}, {3.822589571814995*^9, 3.822589579925229*^9}, {
   3.822592251636771*^9, 3.822592285809779*^9}, {3.822592488597134*^9, 
   3.822592488780192*^9}, 3.8225964230350513`*^9, {3.822596637005093*^9, 
   3.822596671322006*^9}, {3.8225967624732227`*^9, 3.822596787634377*^9}, {
   3.8225968197062197`*^9, 3.8225970519390907`*^9}, {3.8225970908308992`*^9, 
   3.822597106580166*^9}, {3.822773204011257*^9, 3.8227732041272697`*^9}, 
   3.82278625601103*^9, {3.822830956481735*^9, 3.8228309566833487`*^9}, {
   3.822835528101021*^9, 3.822835528673502*^9}, {3.822846788012587*^9, 
   3.822846788141794*^9}, {3.823532948827042*^9, 3.823533016413938*^9}, {
   3.823533054642415*^9, 3.8235331466128387`*^9}, {3.823533189117271*^9, 
   3.823533261035637*^9}, {3.823533898558715*^9, 3.823533927005526*^9}, {
   3.823534256245357*^9, 3.823534369213719*^9}, {3.8236039986984367`*^9, 
   3.823604003382687*^9}, {3.8236041163904676`*^9, 3.823604125458642*^9}, {
   3.823604184481264*^9, 3.823604234744273*^9}, {3.823604268877194*^9, 
   3.8236042740121613`*^9}, {3.823606002679968*^9, 3.8236060145727797`*^9}, {
   3.823606183642124*^9, 3.823606187525655*^9}, {3.8237800630166597`*^9, 
   3.8237801031735277`*^9}, {3.8240649541482067`*^9, 3.824064993979375*^9}, {
   3.82429843096704*^9, 3.824298436302549*^9}, {3.824300194468647*^9, 
   3.8243002035091143`*^9}, {3.8243002340292683`*^9, 3.824300234363946*^9}, {
   3.824849429690955*^9, 3.824849473457967*^9}, 3.824849514836054*^9, {
   3.824849546138092*^9, 3.824849610581976*^9}, {3.825267902953039*^9, 
   3.825267925565012*^9}, {3.825664765921049*^9, 3.8256647685518723`*^9}, {
   3.825673442801981*^9, 3.825673464429339*^9}, {3.825675068929885*^9, 
   3.825675075590418*^9}, {3.82571026988378*^9, 3.825710270099717*^9}, {
   3.825788017067041*^9, 3.8257880412347937`*^9}, {3.8261457319754457`*^9, 
   3.826145745813802*^9}, 3.8261458967818327`*^9, {3.826745075044147*^9, 
   3.826745127974423*^9}, {3.826788254392084*^9, 3.826788264669692*^9}, {
   3.826788357891427*^9, 3.826788358139677*^9}, {3.843540917538224*^9, 
   3.843540923204777*^9}, {3.843541844032401*^9, 3.8435418477857113`*^9}, {
   3.8435420119992723`*^9, 3.8435420132054853`*^9}, 3.850483782187463*^9, {
   3.8504846344322863`*^9, 3.850484697339425*^9}, {3.850484878638726*^9, 
   3.850484883393964*^9}, {3.8504849174583397`*^9, 3.850485003725525*^9}, 
   3.85048515521553*^9, 3.850485230653358*^9, {3.8504853143388767`*^9, 
   3.850485360682763*^9}, {3.8504856780704613`*^9, 3.8504857054138727`*^9}, {
   3.85048581046649*^9, 3.8504858377787743`*^9}, {3.8506324959410543`*^9, 
   3.8506325059513397`*^9}, {3.8506326827995872`*^9, 3.850632687696986*^9}, {
   3.850632753310296*^9, 3.850632783653987*^9}, {3.850633519538033*^9, 
   3.850633536670643*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"66614a13-c7b5-4205-9cbb-4b7567b62989"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetFQIfromMeasured", "[", 
    RowBox[{"A_", ",", "B_", ",", "C_"}], "]"}], ":=", 
   RowBox[{"A", "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "B", "]"}], ".", "B"}], "-", 
    RowBox[{
     RowBox[{"Transpose", "[", "C", "]"}], ".", "C"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.826198135886208*^9, 3.8261981860681753`*^9}, {
  3.826202392987166*^9, 3.82620239407379*^9}, {3.826202532058041*^9, 
  3.826202536627797*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"a2173d43-a9a4-4b2c-9c53-8586c2197ca5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NatGrad", "::", "usage"}], "=", 
   "\"\<NatGrad[conf, hamiltonian, ansatz, \[Theta]vars, Akl,  \[Psi], \
\[Psi]work, \[Psi]\[Theta]k] natural-gradient method, returns the \
energy.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"NatGrad", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NatGrad", "[", 
   RowBox[{
   "conf_", ",", "hamiltonian_", ",", "ansatz_", ",", "\[Theta]vars_", ",", 
    "Akl_", ",", "\[Psi]_", ",", "\[Psi]work_", ",", "\[Psi]\[Theta]k_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "NG", ",", "Ck", ",", "tvars", ",", "Ecur", ",", "rbell", ",", 
      "\[Theta]varst", ",", "baseE", ",", "gradlist", ",", "A1", ",", "A2", 
      ",", "Ebase", ",", "d\[Theta]", ",", "\[Psi]amp", ",", "gradstep"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "This", " ", "is", " ", "executed", " ", "on", " ", "a", " ", "QC"}], 
      ",", " ", 
      RowBox[{
      "fev", " ", "calculate", " ", "how", " ", "many", " ", "times", " ", 
       "QC", " ", "is", " ", "used"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"conf", "[", "\"\<methode\>\"", "]"}], "===", "\"\<NG\>\""}],
         " ", "&&", " ", 
        RowBox[{
         RowBox[{"Length", "@", "\[Theta]vars"}], ">", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Prepare", " ", 
          RowBox[{"(", 
           RowBox[{
            TemplateBox[{
              RowBox[{"d\[Psi]", 
                RowBox[{"(", "\[Theta]", ")"}]}]},
             "Ket"], "/", 
            SubscriptBox["d\[Theta]", "j"]}], ")"}], " ", "on", " ", 
          "\[Psi]\[Theta]k"}], " ", ";", " ", 
         RowBox[{"analytic", " ", "evals"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CalcQuregDerivs", "[", 
         RowBox[{"ansatz", ",", 
          RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
          RowBox[{"Normal", "[", "\[Theta]vars", "]"}], ",", 
          "\[Psi]\[Theta]k"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"First", " ", "term", " ", "only"}], ",", " ", 
          RowBox[{"ignore", " ", "global", " ", "space", " ", 
           RowBox[{"Re", "[", 
            TemplateBox[{
              RowBox[{
                SubscriptBox["d", "k"], "\[Psi]"}], 
              RowBox[{
                SubscriptBox["d", "l"], "\[Psi]"}]},
             "BraKet"], "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Akl", "=", 
         RowBox[{
          RowBox[{"CalcInnerProducts", "[", "\[Psi]\[Theta]k", "]"}], "//", 
          "Re"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{
          RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
          RowBox[{"ansatz", "/.", "\[Theta]vars"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ApplyPauliSum", "[", 
         RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "dE", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Ck", "=", 
         RowBox[{
          RowBox[{"CalcInnerProducts", "[", 
           RowBox[{"\[Psi]work", ",", "\[Psi]\[Theta]k"}], "]"}], "//", 
          "Re"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"The", " ", "natural", " ", "gradient", " ", 
          SuperscriptBox["A", 
           RowBox[{"-", "1"}]], "g"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"NG", "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{
           RowBox[{"Akl", "+", 
            RowBox[{
             RowBox[{"conf", "[", "\"\<\[Alpha]tikhonov\>\"", "]"}], "*", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Length", "@", "Akl"}], "]"}]}]}], ",", "Ck"}], "]"}]}],
         ";", " ", "\[IndentingNewLine]", 
        RowBox[{"NG", "=", 
         RowBox[{"NG", "/", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"NG", ",", "2"}], "]"}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "10"}]]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "try", " ", "with", " ", "several", " ", "choices", " ", "of", " ", 
          "steps"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ecur", ",", "gradstep"}], "}"}], "=", 
         RowBox[{"CalcEcurVarGrad", "[", 
          RowBox[{
          "conf", ",", "hamiltonian", ",", "ansatz", ",", "\[Theta]vars", ",",
            "NG", ",", "\[Psi]", ",", "\[Psi]work"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conf", "[", "\"\<methode\>\"", "]"}], "===", 
        "\"\<NGFD\>\""}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Natural", " ", "gradient", " ", "with", " ", "finite", " ", 
         "difference", " ", "\[IndentingNewLine]", 
         RowBox[{"TODO", ":", " ", 
          RowBox[{"compare", " ", "it", " ", "with", " ", "NG"}]}]}], 
        "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d\[Theta]", "=", 
         RowBox[{"conf", "[", "\"\<\[Epsilon]fin\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"ansatz", ":", " ", 
          RowBox[{
           RowBox[{"U", 
            RowBox[{"(", "\[Theta]", ")"}]}], "|", 
           RowBox[{"\[Psi]", ">"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Prepare", " ", 
           RowBox[{"(", 
            RowBox[{
             TemplateBox[{
               RowBox[{"d\[Psi]", 
                 RowBox[{"(", "\[Theta]", ")"}]}]},
              "Ket"], "/", 
             SubscriptBox["d\[Theta]", "j"]}], ")"}], " ", "on", " ", 
           "\[Psi]\[Theta]k"}], ",", " ", 
          RowBox[{"sorted", " ", "by", " ", "keys", " ", 
           SubscriptBox["\[Theta]", "j"]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"\[Psi]\[Theta]k", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]varst", "=", "\[Theta]vars"}], ";", 
            RowBox[{
             RowBox[{"\[Theta]varst", "[", "k", "]"}], "-=", "d\[Theta]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"ApplyCircuit", "[", 
             RowBox[{
              RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
              RowBox[{"ansatz", "/.", "\[Theta]vars"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Psi]amp", "=", 
             RowBox[{
              RowBox[{"GetQuregMatrix", "[", "\[Psi]", "]"}], "//", 
              "Chop"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            " ", 
            RowBox[{"\[Theta]varst", "=", "\[Theta]vars"}], ";", 
            RowBox[{
             RowBox[{"\[Theta]varst", "[", "k", "]"}], "+=", "d\[Theta]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"ApplyCircuit", "[", 
             RowBox[{
              RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
              RowBox[{"ansatz", "/.", "\[Theta]varst"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"GetQuregMatrix", "[", "\[Psi]", "]"}], "-", 
               "\[Psi]amp"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", "*", "d\[Theta]"}], ")"}]}]}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Sort", "@", 
              RowBox[{"Keys", "@", "\[Theta]vars"}]}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Akl", "=", 
         RowBox[{"Re", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Conjugate", "[", "\[Psi]l", "]"}], ".", "\[Psi]k"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\[Psi]l", ",", "\[Psi]\[Theta]k"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Psi]k", ",", "\[Psi]\[Theta]k"}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Ck", "=", 
          RowBox[{"Re", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d\[Psi]", "/", "d\[Theta]"}], ")"}], "H\[Psi]"}], 
           "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{
          RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
          RowBox[{"ansatz", "/.", "\[Theta]vars"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ApplyPauliSum", "[", 
         RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"\[Psi]amp", "=", 
         RowBox[{"GetQuregMatrix", "[", "\[Psi]work", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ck", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"0.5", "*", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{"Conjugate", "[", "#", "]"}], ".", "\[Psi]amp"}], 
             "]"}]}], "&"}], "/@", "\[Psi]\[Theta]k"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"The", " ", "natural", " ", "gradient", " ", 
          SuperscriptBox["A", 
           RowBox[{"-", "1"}]], "g"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"NG", "=", 
         RowBox[{"LinearSolve", "[", 
          RowBox[{
           RowBox[{"Akl", "+", 
            RowBox[{
             RowBox[{"conf", "[", "\"\<\[Alpha]tikhonov\>\"", "]"}], "*", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Length", "@", "Akl"}], "]"}]}]}], ",", "Ck"}], "]"}]}],
         ";", " ", "\[IndentingNewLine]", 
        RowBox[{"NG", "=", 
         RowBox[{"NG", "/", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"NG", ",", "2"}], "]"}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "10"}]]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "try", " ", "with", " ", "several", " ", "choices", " ", "of", " ", 
          "steps"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ecur", ",", "gradstep"}], "}"}], "=", 
         RowBox[{"CalcEcurVarGrad", "[", 
          RowBox[{
          "conf", ",", "hamiltonian", ",", "ansatz", ",", "\[Theta]vars", ",",
            "NG", ",", "\[Psi]", ",", "\[Psi]work"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"conf", "[", "\"\<methode\>\"", "]"}], "===", 
         "\"\<SGD\>\""}], " ", "||", " ", 
        RowBox[{
         RowBox[{"Length", "@", "\[Theta]vars"}], "===", "1"}]}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"GradDescent", "[", 
         RowBox[{
         "conf", ",", "hamiltonian", ",", "\[Theta]vars", ",", "ansatz", ",", 
          "\[Psi]", ",", "\[Psi]work"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{
          RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
          RowBox[{"ansatz", "/.", "\[Theta]vars"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ecur", "=", 
         RowBox[{"CalcExpecPauliSum", "[", 
          RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], 
          "]"}]}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "True", "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{
          RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
          RowBox[{"ansatz", "/.", "\[Theta]vars"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ecur", "=", 
         RowBox[{"CalcExpecPauliSum", "[", 
          RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Ecur", ",", "gradstep"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8145651229113607`*^9, 3.814565131224815*^9}, {
   3.814565197275292*^9, 3.814565237892199*^9}, {3.8145653217221603`*^9, 
   3.8145653555213957`*^9}, {3.814566486862211*^9, 3.814566587541048*^9}, {
   3.814566694886903*^9, 3.8145667045070477`*^9}, {3.814566739223289*^9, 
   3.814566740521263*^9}, {3.814566875232751*^9, 3.8145669000297527`*^9}, {
   3.814567354831608*^9, 3.814567355787154*^9}, {3.8145678453761997`*^9, 
   3.814567853790951*^9}, {3.814568396916923*^9, 3.8145684310257072`*^9}, {
   3.814568633930657*^9, 3.81456866754175*^9}, {3.814568703916349*^9, 
   3.814568725906514*^9}, {3.814568879895219*^9, 3.8145688854844713`*^9}, {
   3.814569013467224*^9, 3.814569045818192*^9}, {3.814569202617873*^9, 
   3.814569203404765*^9}, 3.8145692443799963`*^9, {3.814569307882967*^9, 
   3.814569317754715*^9}, {3.814569431040119*^9, 3.814569445073986*^9}, {
   3.814569575108128*^9, 3.814569601206812*^9}, {3.814569634914991*^9, 
   3.814569651550861*^9}, {3.814569742549768*^9, 3.814569826512186*^9}, {
   3.814569865307675*^9, 3.814569878651533*^9}, {3.814569921060718*^9, 
   3.8145699317820377`*^9}, {3.814570615780901*^9, 3.814570652186305*^9}, {
   3.8145712686645393`*^9, 3.8145713414207993`*^9}, {3.814606605982613*^9, 
   3.8146066102476883`*^9}, 3.814606878998337*^9, {3.814607779930056*^9, 
   3.814607784115923*^9}, {3.814607829704867*^9, 3.814607853166135*^9}, {
   3.814607900884932*^9, 3.8146079689116173`*^9}, 3.814618491427526*^9, {
   3.814619634842605*^9, 3.814619648689643*^9}, {3.8146197549426413`*^9, 
   3.814619767149983*^9}, {3.816418134075634*^9, 3.816418137400489*^9}, {
   3.81659229937011*^9, 3.816592327591382*^9}, {3.8165925755310698`*^9, 
   3.816592604988566*^9}, {3.81659264088864*^9, 3.8165926413573503`*^9}, 
   3.8165926835556803`*^9, 3.816592730047427*^9, {3.816601379607592*^9, 
   3.816601405238776*^9}, {3.8171425709611673`*^9, 3.8171426001423492`*^9}, {
   3.8188582389690733`*^9, 3.818858282877643*^9}, {3.8188591181528997`*^9, 
   3.818859248504154*^9}, {3.818859341784321*^9, 3.818859448627881*^9}, {
   3.818863653311886*^9, 3.8188636717969627`*^9}, {3.818864123173338*^9, 
   3.818864181477895*^9}, {3.818864217067428*^9, 3.8188642429771423`*^9}, {
   3.819570388367764*^9, 3.819570403746334*^9}, {3.819570667370081*^9, 
   3.8195706833432302`*^9}, {3.819711599927309*^9, 3.8197116049667*^9}, {
   3.81971167095063*^9, 3.819711823897573*^9}, 3.819711922033938*^9, {
   3.819797826743479*^9, 3.819797831396549*^9}, 3.819798102912348*^9, {
   3.819806922147182*^9, 3.819806927332144*^9}, {3.819806981768742*^9, 
   3.819807011114702*^9}, 3.819834785467504*^9, {3.821217971989524*^9, 
   3.821217992637686*^9}, 3.821218057394573*^9, {3.8212181089432383`*^9, 
   3.821218150624427*^9}, {3.82121827554303*^9, 3.821218291419099*^9}, {
   3.8212183706532288`*^9, 3.821218426422104*^9}, {3.821218457537121*^9, 
   3.8212185078002*^9}, {3.82121865486709*^9, 3.821218761144868*^9}, {
   3.82121880762181*^9, 3.8212188867436438`*^9}, {3.821218920009582*^9, 
   3.821218920424328*^9}, {3.821219035974807*^9, 3.8212190400664873`*^9}, {
   3.8212194713307333`*^9, 3.821219502350026*^9}, {3.8212195782372847`*^9, 
   3.8212196099922256`*^9}, {3.821219675311214*^9, 3.821219690623665*^9}, {
   3.821219721305599*^9, 3.821219745291902*^9}, {3.821219782814999*^9, 
   3.821219815911697*^9}, {3.821219962675324*^9, 3.821219987473794*^9}, {
   3.821223952481887*^9, 3.8212239625989437`*^9}, {3.821223997686069*^9, 
   3.8212240325456142`*^9}, {3.821224067624959*^9, 3.8212240741323137`*^9}, 
   3.8212244205783587`*^9, {3.821278545809437*^9, 3.821278552124793*^9}, {
   3.821283320027614*^9, 3.821283330890338*^9}, {3.821283377156844*^9, 
   3.8212833793868217`*^9}, {3.821283488048662*^9, 3.821283489623514*^9}, {
   3.82128395018368*^9, 3.821283977794917*^9}, {3.8212840405066957`*^9, 
   3.821284043130577*^9}, {3.821295860644511*^9, 3.821295923522204*^9}, {
   3.82130655721968*^9, 3.821306575052437*^9}, {3.821397369060665*^9, 
   3.8213974541194677`*^9}, {3.8213975466949387`*^9, 
   3.8213975561106586`*^9}, {3.8214422909130497`*^9, 3.8214422937993317`*^9}, 
   3.821442432846245*^9, {3.821443577458523*^9, 3.821443597570602*^9}, 
   3.8214437625916157`*^9, {3.822495296938005*^9, 3.8224954052641897`*^9}, {
   3.822495525607018*^9, 3.8224955498550386`*^9}, {3.822500880584393*^9, 
   3.822500944071538*^9}, {3.8225009925076427`*^9, 3.822500995990798*^9}, {
   3.822501122490892*^9, 3.822501179550211*^9}, {3.8225012322983427`*^9, 
   3.822501234155552*^9}, {3.822501535584119*^9, 3.8225015598279657`*^9}, {
   3.822501634981448*^9, 3.822501653875*^9}, {3.822501758721664*^9, 
   3.8225020022518587`*^9}, {3.822503094533936*^9, 3.8225031070376873`*^9}, {
   3.82250366682623*^9, 3.8225036735902653`*^9}, {3.822505342673802*^9, 
   3.822505343959243*^9}, {3.822505565050631*^9, 3.822505565934556*^9}, {
   3.8225056102299747`*^9, 3.8225056693502417`*^9}, {3.822506927401723*^9, 
   3.822506968510818*^9}, {3.822507015323913*^9, 3.822507033564126*^9}, {
   3.8225070656054983`*^9, 3.822507154978451*^9}, {3.822507484497789*^9, 
   3.822507488046324*^9}, 3.8225077766272583`*^9, {3.822508265507409*^9, 
   3.8225082733679857`*^9}, {3.822508335056993*^9, 3.822508387068571*^9}, {
   3.82250841825294*^9, 3.82250842127031*^9}, {3.822590225651207*^9, 
   3.8225902586087837`*^9}, {3.8225902933244953`*^9, 3.822590354370637*^9}, {
   3.8225904174514313`*^9, 3.8225904243698597`*^9}, {3.822767391849195*^9, 
   3.822767409274201*^9}, {3.822773275918724*^9, 3.822773289864462*^9}, {
   3.823532878598151*^9, 3.8235329361361217`*^9}, {3.823534387848805*^9, 
   3.823534431522682*^9}, {3.8236032995025063`*^9, 3.823603300117716*^9}, {
   3.8236033384110203`*^9, 3.823603354044311*^9}, {3.823603695175344*^9, 
   3.8236037017808247`*^9}, {3.8236039307108583`*^9, 3.823603933117702*^9}, {
   3.8236078102152863`*^9, 3.823607814224904*^9}, {3.8236079254920473`*^9, 
   3.823607926483111*^9}, {3.824298472413872*^9, 3.824298492629422*^9}, {
   3.824849716191134*^9, 3.824849749384798*^9}, {3.82484979691706*^9, 
   3.824849807784749*^9}, {3.824850006621173*^9, 3.824850014091011*^9}, {
   3.825106384203801*^9, 3.82510639583782*^9}, {3.825267943358492*^9, 
   3.8252679960088*^9}, {3.825498220165264*^9, 3.825498224065509*^9}, {
   3.825545480961656*^9, 3.825545481262164*^9}, {3.825575098511948*^9, 
   3.82557509885867*^9}, {3.8256647497341948`*^9, 3.8256647610024853`*^9}, {
   3.82567310095831*^9, 3.825673193425332*^9}, {3.8256735835765343`*^9, 
   3.8256735927206593`*^9}, {3.825673725546986*^9, 3.825673732186619*^9}, {
   3.825674037641699*^9, 3.8256740460676937`*^9}, {3.825675467486355*^9, 
   3.825675482368498*^9}, {3.825676040833406*^9, 3.825676046361745*^9}, {
   3.8256790844036617`*^9, 3.825679088167893*^9}, {3.825685367374589*^9, 
   3.825685370763653*^9}, {3.825685401575429*^9, 3.825685437758995*^9}, 
   3.825685568022294*^9, 3.825685702349497*^9, {3.825685768074728*^9, 
   3.82568579113529*^9}, {3.825710164175132*^9, 3.825710219031056*^9}, {
   3.825710537007016*^9, 3.825710640771845*^9}, {3.825762872454769*^9, 
   3.825762914596414*^9}, {3.8257630621905127`*^9, 3.8257630630071917`*^9}, {
   3.825763101976015*^9, 3.8257631090775642`*^9}, {3.825772347893659*^9, 
   3.8257723792407846`*^9}, {3.825772461411737*^9, 3.825772600039616*^9}, {
   3.8257729404050713`*^9, 3.825772941798464*^9}, {3.825776265992339*^9, 
   3.825776267775201*^9}, {3.8257773666787453`*^9, 3.825777369565556*^9}, {
   3.8257779497485123`*^9, 3.825777983413329*^9}, {3.825778075128171*^9, 
   3.825778101074932*^9}, {3.825787954200268*^9, 3.825787990015835*^9}, {
   3.825788137583811*^9, 3.8257881544206133`*^9}, {3.825788417239546*^9, 
   3.8257884195976057`*^9}, {3.825789625212804*^9, 3.825789630689177*^9}, {
   3.826094768766697*^9, 3.826094855740271*^9}, {3.826117119311099*^9, 
   3.826117135626417*^9}, {3.8261172585211887`*^9, 3.826117345646879*^9}, {
   3.8261173925293827`*^9, 3.826117405044087*^9}, {3.826117502243576*^9, 
   3.8261175155815763`*^9}, {3.826118309789216*^9, 3.8261183404981403`*^9}, {
   3.826118418914081*^9, 3.826118460262999*^9}, {3.8261185282955303`*^9, 
   3.826118535929057*^9}, {3.82611868372797*^9, 3.82611879674522*^9}, {
   3.826118859816153*^9, 3.826118958315939*^9}, {3.826119034511088*^9, 
   3.8261191200155687`*^9}, {3.826119497629159*^9, 3.8261196528864326`*^9}, {
   3.826119770816991*^9, 3.826119775945118*^9}, {3.826119838492045*^9, 
   3.826119841738121*^9}, {3.8261202239309063`*^9, 3.8261202310289793`*^9}, 
   3.8261222967954807`*^9, {3.82612376715513*^9, 3.826123782418157*^9}, {
   3.826123818538568*^9, 3.8261238538299913`*^9}, {3.826123988974992*^9, 
   3.8261240005998297`*^9}, {3.826124039712616*^9, 3.826124185373274*^9}, {
   3.826124228651812*^9, 3.826124240215835*^9}, {3.826124311219376*^9, 
   3.826124401482939*^9}, 3.8261265023419228`*^9, {3.826126555082096*^9, 
   3.826126555616465*^9}, {3.826126635244508*^9, 3.826126644666497*^9}, {
   3.826126760577024*^9, 3.8261267687892838`*^9}, {3.826126798954359*^9, 
   3.826126801958281*^9}, {3.8261268558893337`*^9, 3.826126873674266*^9}, {
   3.8261269314744473`*^9, 3.82612699299339*^9}, {3.826127035324594*^9, 
   3.826127035708516*^9}, 3.826128246825659*^9, {3.82612833871297*^9, 
   3.826128343806291*^9}, {3.82612838754377*^9, 3.826128548683502*^9}, {
   3.826128607694454*^9, 3.826128651938051*^9}, 3.8261286827268248`*^9, {
   3.826128720512982*^9, 3.826128728796011*^9}, 3.8261287807713346`*^9, {
   3.826129772055492*^9, 3.826129795648479*^9}, {3.826129971373317*^9, 
   3.8261299786041613`*^9}, {3.826130981873802*^9, 3.8261310051893806`*^9}, {
   3.8261310813908443`*^9, 3.82613115224474*^9}, {3.826131223085566*^9, 
   3.826131238507985*^9}, {3.826131291883041*^9, 3.8261313169783087`*^9}, {
   3.826138729818275*^9, 3.826138731804173*^9}, {3.826138811821913*^9, 
   3.8261388126321287`*^9}, {3.82613945764749*^9, 3.826139459947276*^9}, {
   3.826140501295795*^9, 3.8261405047050667`*^9}, {3.826141192295804*^9, 
   3.826141194541287*^9}, {3.826144247411593*^9, 3.826144264029414*^9}, {
   3.8261970646024837`*^9, 3.826197065384852*^9}, {3.826197819231688*^9, 
   3.826197900094102*^9}, {3.826197992637348*^9, 3.8261981121917353`*^9}, {
   3.826198194080101*^9, 3.826198201510179*^9}, {3.826198247061562*^9, 
   3.8261982859780273`*^9}, {3.826198333771929*^9, 3.826198337361631*^9}, {
   3.8261983835165358`*^9, 3.8261984150330973`*^9}, {3.8261984493111973`*^9, 
   3.826198489054117*^9}, {3.826198519861081*^9, 3.826198527742054*^9}, {
   3.82619858996329*^9, 3.8261985990745907`*^9}, {3.826200116101247*^9, 
   3.826200120852358*^9}, {3.8262011453802567`*^9, 3.826201156028687*^9}, {
   3.826201223828164*^9, 3.826201252949747*^9}, 3.8262012865883017`*^9, {
   3.8262013507888193`*^9, 3.826201351031973*^9}, {3.826201445924572*^9, 
   3.826201452059423*^9}, {3.826201596559092*^9, 3.826201601647393*^9}, {
   3.826202138185244*^9, 3.826202138583157*^9}, {3.826202410085243*^9, 
   3.826202427228778*^9}, {3.826202459834753*^9, 3.826202460062336*^9}, {
   3.8262665273364067`*^9, 3.8262666325746527`*^9}, {3.826266748233727*^9, 
   3.826266793422152*^9}, {3.826267007841344*^9, 3.826267062074677*^9}, {
   3.8262684297748747`*^9, 3.826268456257777*^9}, {3.826268536201627*^9, 
   3.826268579355805*^9}, {3.826268653393942*^9, 3.8262686731244297`*^9}, {
   3.826268940972047*^9, 3.826268985189208*^9}, {3.826269074195568*^9, 
   3.826269079403335*^9}, {3.826269122651071*^9, 3.826269187456448*^9}, {
   3.826269293123436*^9, 3.826269387434231*^9}, {3.826269429472971*^9, 
   3.826269437057564*^9}, {3.826269494150833*^9, 3.826269552576234*^9}, {
   3.826269600634962*^9, 3.826269788060586*^9}, {3.82626982956542*^9, 
   3.8262698320099993`*^9}, {3.826269953727418*^9, 3.826270064589972*^9}, {
   3.826270536468943*^9, 3.826270536845602*^9}, {3.8262705739483423`*^9, 
   3.8262705856776257`*^9}, {3.826298204581472*^9, 3.826298212429365*^9}, {
   3.826298261681683*^9, 3.82629826410887*^9}, 3.826699627911086*^9, {
   3.8267439919462843`*^9, 3.826744026515657*^9}, {3.8267440661932898`*^9, 
   3.826744102409974*^9}, {3.826744500813407*^9, 3.826744572945703*^9}, {
   3.826744606770849*^9, 3.826744684555552*^9}, {3.826744796363353*^9, 
   3.826744797650792*^9}, {3.826744833813284*^9, 3.826744925529415*^9}, {
   3.826745062527598*^9, 3.826745067279051*^9}, {3.826745432096553*^9, 
   3.826745469050787*^9}, {3.826778317382288*^9, 3.8267783244747143`*^9}, {
   3.826778358862602*^9, 3.8267783828519993`*^9}, {3.8267877584074717`*^9, 
   3.8267877794497433`*^9}, {3.826788120032227*^9, 3.826788123215164*^9}, {
   3.826788202117234*^9, 3.826788202492247*^9}, {3.8267884608035173`*^9, 
   3.826788471319296*^9}, {3.82678853489778*^9, 3.826788538730036*^9}, {
   3.8312001770272293`*^9, 3.831200195617361*^9}, {3.83120024722578*^9, 
   3.83120024798346*^9}, {3.831718116936263*^9, 3.8317181265403957`*^9}, {
   3.83171964864797*^9, 3.8317197759929953`*^9}, {3.831719843014683*^9, 
   3.8317198595210943`*^9}, {3.831740126131765*^9, 3.831740144447913*^9}, {
   3.831744608050763*^9, 3.8317446337247953`*^9}, {3.831788920893805*^9, 
   3.8317889882245913`*^9}, {3.831789531026846*^9, 3.831789556351355*^9}, {
   3.831789629102871*^9, 3.831789635039863*^9}, {3.831789675048017*^9, 
   3.831789688796611*^9}, {3.831789909863237*^9, 3.8317899461534567`*^9}, {
   3.831789978692528*^9, 3.831789985611415*^9}, {3.831790032149892*^9, 
   3.831790046202877*^9}, {3.831790155080637*^9, 3.8317902433947268`*^9}, 
   3.831791495769699*^9, {3.8317916040546217`*^9, 3.8317916213368387`*^9}, {
   3.831791652712734*^9, 3.831791657094824*^9}, {3.8317918058593407`*^9, 
   3.8317918407564487`*^9}, {3.831792015191862*^9, 3.831792060602839*^9}, 
   3.831792632968443*^9, {3.831793019272655*^9, 3.831793023254499*^9}, {
   3.831793065651743*^9, 3.83179312653505*^9}, {3.831793158688208*^9, 
   3.831793160043895*^9}, {3.8317935225471087`*^9, 3.831793559772451*^9}, 
   3.831793770047439*^9, {3.831794440708619*^9, 3.831794467966022*^9}, {
   3.831795321073151*^9, 3.8317953875996103`*^9}, {3.831796437691166*^9, 
   3.831796438347334*^9}, {3.831797356537561*^9, 3.8317973619886093`*^9}, {
   3.831797622432293*^9, 3.8317976225793047`*^9}, {3.831797920986095*^9, 
   3.831797959139063*^9}, {3.8317979970117197`*^9, 3.831798041361618*^9}, 
   3.831798085833557*^9, {3.8317981605581207`*^9, 3.831798351723256*^9}, {
   3.83180349381042*^9, 3.8318035623807907`*^9}, {3.831803696156163*^9, 
   3.831803718744596*^9}, {3.8318044242427187`*^9, 3.8318044412125196`*^9}, 
   3.831804491031885*^9, {3.8318045644709187`*^9, 3.8318045649742804`*^9}, {
   3.831804611638061*^9, 3.831804617615443*^9}, {3.831804744539542*^9, 
   3.8318047537858753`*^9}, {3.831804839636839*^9, 3.8318048448722*^9}, {
   3.831804888955399*^9, 3.831804889308045*^9}, 3.831805643743572*^9, {
   3.831805687468183*^9, 3.831805791911893*^9}, {3.831805822568495*^9, 
   3.831805827937289*^9}, {3.831805868396295*^9, 3.831805928279668*^9}, {
   3.8318060339251957`*^9, 3.831806034830933*^9}, {3.83180608359072*^9, 
   3.831806144488299*^9}, {3.8318063224138517`*^9, 3.831806381174646*^9}, {
   3.8318064386166487`*^9, 3.831806463792478*^9}, {3.8318075549392767`*^9, 
   3.831807557495995*^9}, {3.831931455086838*^9, 3.831931487810396*^9}, {
   3.83193152917874*^9, 3.831931536384511*^9}, {3.83198063551425*^9, 
   3.831980671139634*^9}, {3.83198070344705*^9, 3.831980706012533*^9}, {
   3.831986868006075*^9, 3.831986868211843*^9}, {3.8319872593811073`*^9, 
   3.8319872755594587`*^9}, {3.831987385038369*^9, 3.831987412899394*^9}, {
   3.8319878310807123`*^9, 3.831987832461701*^9}, {3.831988303667625*^9, 
   3.831988304456462*^9}, {3.832058427579741*^9, 3.832058428213521*^9}, {
   3.832058734208322*^9, 3.8320587399811068`*^9}, {3.832606148805649*^9, 
   3.8326061651021357`*^9}, {3.8435408623383837`*^9, 3.843540909670179*^9}, {
   3.8506335599370747`*^9, 3.850633631533154*^9}, {3.8508081983354177`*^9, 
   3.850808214975945*^9}, {3.850808307363821*^9, 3.850808315599255*^9}, {
   3.8508083970744867`*^9, 3.8508084056047173`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"915d477a-b6c5-4de3-8c4a-db480cf1a6c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RelaxAnsatz", "::", "usage"}], "=", 
   "\"\<RelaxAnsatz[conf,fev,ansatz,\[Theta]vars,Akl,\[Psi],\[Psi]work,\[Psi]\
\[Theta]k,Ecur,gradstep,convergence,maxiter:\[Infinity]]. \nRelax ansatz \
until converge: improvements are smaller than convergence.\n\nReturn: Elist, \
recorded energy calculation. Ecur and \[Theta]vars are updated.\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"RelaxAnsatz", ",", " ", "HoldAll"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RelaxAnsatz", "[", 
   RowBox[{
   "conf_", ",", "hamiltonian_", ",", "fev_", ",", "ansatz_", ",", 
    "\[Theta]vars_", ",", "Akl_", ",", "\[Psi]_", ",", "\[Psi]work_", ",", 
    "\[Psi]\[Theta]k_", ",", "Ecur_", ",", "gradstep_", ",", "convergence_", 
    ",", 
    RowBox[{"maxiter_", ":", "Infinity"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Eold", ",", "\[Theta]varsold", ",", 
      RowBox[{"Elist", "=", 
       RowBox[{"{", "}"}]}], ",", "dE", ",", 
      RowBox[{"econverge", "=", "0"}], ",", 
      RowBox[{"Einit", "=", "Ecur"}], ",", 
      RowBox[{"\[Theta]varsinit", "=", "\[Theta]vars"}], ",", 
      RowBox[{"failing", "=", "0"}], ",", 
      RowBox[{"iter", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"++", "iter"}], "<", "maxiter"}], " ", "&&", " ", 
        RowBox[{
         RowBox[{"Length", "@", "\[Theta]vars"}], ">", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Eold", ",", "\[Theta]varsold"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{"Ecur", ",", "\[Theta]vars"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ecur", ",", "gradstep"}], "}"}], "=", 
         RowBox[{"NatGrad", "[", 
          RowBox[{
          "conf", ",", "hamiltonian", ",", "ansatz", ",", "\[Theta]vars", ",",
            "Akl", ",", "\[Psi]", ",", "\[Psi]work", ",", "\[Psi]\[Theta]k"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"++", "fev"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE", "=", 
         RowBox[{"Ecur", "-", "Eold"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"dE", ">", "0"}], " ", "&&", " ", 
           RowBox[{"iter", ">", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "revert", " ", "to", " ", "the", " ", "old", " ", "condition"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Ecur", ",", "\[Theta]vars"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{"Eold", ",", "\[Theta]varsold"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"Elist", ",", "Ecur"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dE", "\[LessEqual]", "0"}], " ", "&&", 
           RowBox[{
            RowBox[{"Abs", "[", "dE", "]"}], "<", "convergence"}]}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"econverge", "+=", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"econverge", "=", "0"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"econverge", ">", 
           RowBox[{"conf", "[", "\"\<iterconverge\>\"", "]"}]}], ",", " ", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Ecur", "\[GreaterEqual]", " ", "Einit"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Ecur", ",", "\[Theta]vars"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{"Einit", ",", "\[Theta]varsinit"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Elist", "=", 
         RowBox[{"{", "Einit", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "Elist"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8235927410964403`*^9, 3.823592761083789*^9}, {
   3.8235931364763613`*^9, 3.823593482709688*^9}, {3.82359358324328*^9, 
   3.82359371226038*^9}, {3.823595763565378*^9, 3.823595770519547*^9}, 
   3.8235968617391872`*^9, {3.823599792259081*^9, 3.823599807577887*^9}, 
   3.823600250816772*^9, {3.8236053852240353`*^9, 3.823605400434469*^9}, {
   3.8236054700156612`*^9, 3.8236054737133827`*^9}, {3.823605955321334*^9, 
   3.8236059628790293`*^9}, 3.823606022614809*^9, 3.823606060230424*^9, {
   3.823606157398403*^9, 3.823606162161229*^9}, 3.8236062045746937`*^9, {
   3.8236076801718197`*^9, 3.823607688092615*^9}, 3.82360778378113*^9, {
   3.82360793424885*^9, 3.823607948111787*^9}, {3.82362192351435*^9, 
   3.823621923665942*^9}, {3.8236337433513613`*^9, 3.823633745463202*^9}, {
   3.823712403455068*^9, 3.8237125162962713`*^9}, {3.823712829117251*^9, 
   3.8237129622640953`*^9}, {3.823712995327037*^9, 3.823713051395349*^9}, {
   3.8237170723501863`*^9, 3.82371708849133*^9}, {3.8237187264681473`*^9, 
   3.823718754357345*^9}, {3.823769833059547*^9, 3.8237698408271303`*^9}, {
   3.824305121813753*^9, 3.82430515189592*^9}, {3.824305184524411*^9, 
   3.8243051894814577`*^9}, {3.8243114328151073`*^9, 3.82431145388627*^9}, 
   3.824311520837833*^9, {3.824311826589088*^9, 3.8243118280195637`*^9}, {
   3.824545595787467*^9, 3.824545686645562*^9}, {3.8245463872199306`*^9, 
   3.8245463973325644`*^9}, {3.824546428974061*^9, 3.824546436886327*^9}, {
   3.824546555627058*^9, 3.824546561519527*^9}, {3.8245466075516253`*^9, 
   3.824546638378248*^9}, {3.8245469114936*^9, 3.824547012229998*^9}, {
   3.8245473079425983`*^9, 3.8245473086204576`*^9}, {3.8245477346369047`*^9, 
   3.824547735323283*^9}, {3.8251064076328783`*^9, 3.8251064763260393`*^9}, {
   3.825106552993147*^9, 3.825106618419346*^9}, {3.8251069585929193`*^9, 
   3.8251069621231747`*^9}, {3.8251774901222553`*^9, 
   3.8251774931612387`*^9}, {3.825177538547682*^9, 3.825177538665023*^9}, {
   3.825495669029435*^9, 3.8254956914603653`*^9}, {3.825787917035969*^9, 
   3.8257879493457003`*^9}, {3.8261991111244183`*^9, 
   3.8261991184285517`*^9}, {3.8263018327117147`*^9, 3.826301851668845*^9}, {
   3.8263019072676573`*^9, 3.826301913751103*^9}, {3.8263019467863283`*^9, 
   3.826301967679969*^9}, {3.826302012631027*^9, 3.826302013279245*^9}, {
   3.826302072243198*^9, 3.826302072792397*^9}, {3.826743939064108*^9, 
   3.826743948229686*^9}, {3.826745475349536*^9, 3.826745481866342*^9}, {
   3.826790142425187*^9, 3.826790145871825*^9}, {3.836919893391045*^9, 
   3.836919923871557*^9}, {3.83714570616416*^9, 3.837145713214882*^9}, {
   3.850579130222002*^9, 3.850579137299869*^9}, {3.850579194192099*^9, 
   3.850579196419629*^9}, {3.850633649662402*^9, 3.8506336619999228`*^9}, {
   3.850661857032627*^9, 3.850661859418269*^9}, {3.850808264266923*^9, 
   3.850808296673934*^9}, {3.850808387288064*^9, 3.8508083879272423`*^9}, {
   3.850818219937084*^9, 3.850818228164611*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"e92c345a-290a-4a0a-a739-d6519efa13a4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Prunings", "Subsection",
 CellChangeTimes->{{3.8211291780732937`*^9, 3.821129199186705*^9}, {
   3.821195903481749*^9, 3.821195911170946*^9}, {3.821212480633562*^9, 
   3.8212124813518047`*^9}, 3.821215055886223*^9, {3.821293387849106*^9, 
   3.821293396700285*^9}},ExpressionUUID->"2193745b-35cd-48e1-b811-\
90b2c4779fe8"],

Cell[BoxData[
 RowBox[{"Remove", "[", 
  RowBox[{
  "AdjustQuregs\[Psi]\[Theta]k", ",", "PruneGates", ",", "MergeGates", ",", 
   "BruteForceSmall\[Theta]", ",", "DeleteGatesByMetric"}], "]"}]], "Input",
 CellChangeTimes->{{3.82129679437915*^9, 3.8212967981663857`*^9}, {
  3.8213484917396183`*^9, 3.8213485023035*^9}, {3.823945180951437*^9, 
  3.823945201232728*^9}, {3.823945289512898*^9, 3.823945291437634*^9}, {
  3.8256840876209497`*^9, 3.825684090359476*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"9fe547ff-fe0a-419d-ae2c-5e507a4a3987"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Adjust", " ", "quantum", " ", "register", " ", "\[Psi]\[Theta]k", " ", 
    "wrt", " ", "\[Theta]vars"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "::", "usage"}], "=", 
     "\"\<AdjustQuregs\[Psi]\[Theta]k[nqubit_,\[Theta]vars_,\[Psi]\[Theta]k_] \
adjust allocation of \[Psi]\[Theta]k according to \[Theta]vars\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"AdjustQuregs\[Psi]\[Theta]k", ",", "HoldRest"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
     RowBox[{"nqubit_", ",", "\[Theta]vars_", ",", "\[Psi]\[Theta]k_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "lendiff", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lendiff", "=", 
        RowBox[{
         RowBox[{"Length", "@", "\[Psi]\[Theta]k"}], "-", 
         RowBox[{"Length", "@", "\[Theta]vars"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"lendiff", ">", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"release", " ", "some", " ", "quantum", " ", "memories"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"DestroyQureg", "[", 
             RowBox[{"\[Psi]\[Theta]k", "\[LeftDoubleBracket]", 
              RowBox[{"-", "q"}], "\[RightDoubleBracket]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"q", ",", "lendiff"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Psi]\[Theta]k", "=", 
           RowBox[{"\[Psi]\[Theta]k", "\[LeftDoubleBracket]", 
            RowBox[{";;", 
             RowBox[{
              RowBox[{"-", "1"}], "-", "lendiff"}]}], 
            "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"lendiff", " ", "<", " ", "0"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
          "add", " ", "some", " ", "quantum", " ", "memories", " ", 
           "otherwise"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Psi]\[Theta]k", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"\[Psi]\[Theta]k", ",", 
             RowBox[{"CreateQuregs", "[", 
              RowBox[{"nqubit", ",", 
               RowBox[{"Abs", "[", "lendiff", "]"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8212760798374987`*^9, 3.821276080208611*^9}, {
  3.8212761152854*^9, 3.8212761406432743`*^9}, {3.821295755599484*^9, 
  3.821295787831954*^9}, {3.821348589988394*^9, 3.821348622553043*^9}, {
  3.82134865802839*^9, 3.8213486749839582`*^9}, {3.821444143182252*^9, 
  3.8214441859065123`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"50c3a9ea-1878-48ac-a5d7-253fb3651fec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PruneGates", "::", "usage"}], "=", 
   "\"\<PruneGates[conf, hamiltonian, fev, Akl, Ecur, ansatz, \[Theta]vars, \
TotalCirc,  \[Psi], \[Psi]work, \[Psi]\[Theta]k, maxcost, fullbf, status]. \n\
Prune the circuit using the 4 methods.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"PruneGates", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PruneGates", "[", 
   RowBox[{
   "conf_", ",", "hamiltonian_", ",", "fev_", ",", "Akl_", ",", "Ecur_", ",", 
    "gradstep_", ",", "ansatz_", ",", "\[Theta]vars_", ",", "TotalCirc_", ",",
     "\[Psi]_", ",", "\[Psi]work_", ",", "\[Psi]\[Theta]k_", ",", "maxcost_", 
    ",", "fullbf_", ",", "status_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"slen", ",", 
      RowBox[{"dl", "=", "1"}], ",", 
      RowBox[{"elimmerge", "=", "0"}], ",", 
      RowBox[{"elimmetov", "=", "0"}], ",", 
      RowBox[{"elimbfsmall", "=", "0"}], ",", 
      RowBox[{"elimbf", "=", "0"}], ",", 
      RowBox[{"Einit", "=", "Ecur"}], ",", "total"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"status", "=", "\"\<merge gates\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"total", ":=", 
      RowBox[{"\"\< ;merged:\>\"", "<>", 
       RowBox[{"ToString", "[", "elimmerge", "]"}], "<>", "\"\<, metric:\>\"",
        "<>", 
       RowBox[{"ToString", "[", "elimmetov", "]"}], "<>", 
       "\"\<, small\[Theta]:\>\"", "<>", 
       RowBox[{"ToString", "[", "elimbfsmall", "]"}], "<>", 
       "\"\<, bffirst:\>\"", "<>", 
       RowBox[{"ToString", "[", "elimbf", "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"elimmerge", "+=", 
      RowBox[{"MergeGates", "[", 
       RowBox[{"ansatz", ",", "\[Theta]vars"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
      RowBox[{
       RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", "\[Theta]vars", ",",
        "\[Psi]\[Theta]k"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"dl", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"slen", "=", 
         RowBox[{"Length", "@", "ansatz"}]}], " ", ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "\[Theta]vars"}], ">", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AdjustAngles", "[", "\[Theta]vars", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"status", "=", 
            RowBox[{"\"\<delete gates by metric\>\"", "<>", "total"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"elimmetov", "+=", 
            RowBox[{"DeleteGatesByMetric", "[", 
             RowBox[{
             "conf", ",", "hamiltonian", ",", "fev", ",", "Akl", ",", "Ecur", 
              ",", "gradstep", ",", "ansatz", ",", "\[Theta]vars", ",", 
              "TotalCirc", ",", "\[Psi]", ",", "\[Psi]work", ",", 
              "\[Psi]\[Theta]k", ",", "maxcost"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"status", "=", 
            RowBox[{"\"\<merge gates\>\"", "<>", "total"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"elimmerge", "+=", 
            RowBox[{"MergeGates", "[", 
             RowBox[{"ansatz", ",", "\[Theta]vars"}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "\[Theta]vars"}], ">", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AdjustAngles", "[", "\[Theta]vars", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"status", "=", 
            RowBox[{"\"\<brute-force small \[Theta]\>\"", "<>", "total"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"elimbfsmall", "+=", 
            RowBox[{"BruteForceSmall\[Theta]", "[", 
             RowBox[{
             "conf", ",", "hamiltonian", ",", "fev", ",", "Akl", ",", "Ecur", 
              ",", "gradstep", ",", "ansatz", ",", "\[Theta]vars", ",", 
              "TotalCirc", ",", "\[Psi]", ",", "\[Psi]work", ",", 
              "\[Psi]\[Theta]k", ",", "maxcost", ",", "fullbf"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"status", "=", 
            RowBox[{"\"\<merge gates\>\"", "<>", "total"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"elimmerge", "+=", 
            RowBox[{"MergeGates", "[", 
             RowBox[{"ansatz", ",", "\[Theta]vars"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", "\[Theta]vars"}], ">", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AdjustAngles", "[", "\[Theta]vars", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"status", "=", 
            RowBox[{"\"\<quick brute-force\>\"", "<>", "total"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"elimbf", "+=", 
            RowBox[{"DeleteGateBF", "[", 
             RowBox[{
             "conf", ",", "hamiltonian", ",", "fev", ",", "Akl", ",", "Ecur", 
              ",", "gradstep", ",", "ansatz", ",", "\[Theta]vars", ",", 
              "TotalCirc", ",", "\[Psi]", ",", "\[Psi]work", ",", 
              "\[Psi]\[Theta]k", ",", "maxcost", ",", "fullbf"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"status", "=", 
            RowBox[{"\"\<merge gates\>\"", "<>", "total"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"elimmerge", "+=", 
            RowBox[{"MergeGates", "[", 
             RowBox[{"ansatz", ",", "\[Theta]vars"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"dl", "=", 
         RowBox[{"slen", "-", 
          RowBox[{"Length", "@", "ansatz"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
      RowBox[{
       RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", "\[Theta]vars", ",",
        "\[Psi]\[Theta]k"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Ecur", ">", "maxcost"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<pruning exceeds the maxcost: \>\"", ",", 
         RowBox[{"N", "@", "maxcost"}], ",", "\"\<; cost=\>\"", ",", "Ecur"}],
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "elimmerge", ",", "elimbfsmall", ",", "elimmetov", ",", " ", "elimbf"}],
       "}"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.821866958507078*^9, 3.821867366028901*^9}, {
   3.8218678828637657`*^9, 3.8218678888283663`*^9}, {3.821870930287362*^9, 
   3.821870944033374*^9}, 3.821871127317276*^9, {3.8224956952731752`*^9, 
   3.8224957225858507`*^9}, {3.822590439317616*^9, 3.822590445269671*^9}, {
   3.822590898845168*^9, 3.822590900497531*^9}, {3.8227758484944077`*^9, 
   3.8227758703318577`*^9}, {3.822776072124447*^9, 3.822776076400689*^9}, {
   3.822777632961391*^9, 3.822777709765242*^9}, 3.8235922793270397`*^9, {
   3.823599985929393*^9, 3.823600044474637*^9}, {3.823600839102754*^9, 
   3.82360090094571*^9}, {3.823600931592101*^9, 3.8236009360576687`*^9}, {
   3.823601011722878*^9, 3.823601017794593*^9}, {3.823606290882453*^9, 
   3.823606302571995*^9}, {3.823606760197836*^9, 3.823606761119253*^9}, {
   3.823607290806696*^9, 3.8236072944583178`*^9}, {3.8236074264751043`*^9, 
   3.8236074558531933`*^9}, {3.8236079620968103`*^9, 3.823607971512236*^9}, 
   3.8236080022597303`*^9, {3.823609059242917*^9, 3.823609083204905*^9}, {
   3.823609462209725*^9, 3.8236094704074163`*^9}, {3.823609971504673*^9, 
   3.823609972718932*^9}, {3.8236103414102793`*^9, 3.8236103427367287`*^9}, 
   3.823610385472362*^9, {3.823610610047825*^9, 3.823610611428357*^9}, {
   3.823611811506034*^9, 3.8236118208251333`*^9}, {3.82361709617749*^9, 
   3.823617100412554*^9}, {3.823617153143416*^9, 3.8236171644120092`*^9}, {
   3.8236171958688726`*^9, 3.8236172041102953`*^9}, {3.8236189201864843`*^9, 
   3.823618923084415*^9}, {3.823620110151793*^9, 3.823620127323472*^9}, {
   3.8236202095511303`*^9, 3.823620212945384*^9}, {3.8236202472274513`*^9, 
   3.823620247925028*^9}, {3.823621051171729*^9, 3.823621059664776*^9}, {
   3.823621147191905*^9, 3.823621180576344*^9}, {3.8236291611762114`*^9, 
   3.823629162365293*^9}, {3.8236299199351387`*^9, 3.8236299586395407`*^9}, {
   3.823633803756132*^9, 3.8236338065282507`*^9}, {3.8236339542192287`*^9, 
   3.823633956069682*^9}, {3.8236346757628613`*^9, 3.823634682620233*^9}, {
   3.823641178911132*^9, 3.823641184106861*^9}, {3.8236703573274393`*^9, 
   3.823670365372301*^9}, {3.8236717883841677`*^9, 3.823671816943964*^9}, {
   3.823673031675315*^9, 3.8236730661799183`*^9}, {3.823673255368863*^9, 
   3.823673259281843*^9}, {3.8236761091432133`*^9, 3.823676110932122*^9}, {
   3.8236820771127996`*^9, 3.823682080440757*^9}, {3.823682140681443*^9, 
   3.8236821461142282`*^9}, {3.823686620003998*^9, 3.823686624275858*^9}, {
   3.8236872958550043`*^9, 3.823687296976797*^9}, {3.823688074252479*^9, 
   3.823688076014595*^9}, {3.823688424531693*^9, 3.823688425622406*^9}, {
   3.823688947549406*^9, 3.82368894991759*^9}, {3.823689374362568*^9, 
   3.82368937554205*^9}, 3.8236896693595552`*^9, {3.8236897267041388`*^9, 
   3.823689727663813*^9}, {3.82369066549345*^9, 3.823690731111994*^9}, {
   3.823695807023925*^9, 3.8236958092391644`*^9}, {3.823696034762424*^9, 
   3.823696036342349*^9}, {3.823698030174838*^9, 3.823698030652543*^9}, {
   3.8236988198605213`*^9, 3.823698821296816*^9}, {3.823721826909511*^9, 
   3.8237218298994923`*^9}, {3.823722299713496*^9, 3.823722325468225*^9}, {
   3.8237224531611357`*^9, 3.823722457601986*^9}, {3.82375436594608*^9, 
   3.823754382987277*^9}, {3.823769334584931*^9, 3.823769432642294*^9}, {
   3.8239425993607397`*^9, 3.823942672816846*^9}, 3.823942726415268*^9, {
   3.823944970534753*^9, 3.823944973518611*^9}, {3.823945144255595*^9, 
   3.823945145595071*^9}, {3.823947161984149*^9, 3.8239471878970547`*^9}, {
   3.823947785783839*^9, 3.823947800052207*^9}, {3.8239478460642633`*^9, 
   3.82394785984249*^9}, {3.8239481164372797`*^9, 3.823948117719376*^9}, {
   3.823948420928385*^9, 3.823948431908855*^9}, {3.823948987066682*^9, 
   3.823949005144734*^9}, {3.823949060890376*^9, 3.82394906896036*^9}, 
   3.823949786566554*^9, {3.823952531636753*^9, 3.823952554644217*^9}, {
   3.8239527110473948`*^9, 3.8239527346184273`*^9}, {3.823952802012348*^9, 
   3.823952868641827*^9}, {3.8239535473146057`*^9, 3.823953576985722*^9}, {
   3.824209850718347*^9, 3.8242098576900387`*^9}, {3.8242100351783123`*^9, 
   3.824210066008883*^9}, {3.824220288884663*^9, 3.824220317979226*^9}, {
   3.824306365891819*^9, 3.824306372642044*^9}, {3.824306970079681*^9, 
   3.82430697857752*^9}, {3.824318122243824*^9, 3.824318125381604*^9}, {
   3.824319071607942*^9, 3.824319095661972*^9}, {3.824547832426849*^9, 
   3.824547897229863*^9}, {3.824547938278412*^9, 3.824548049639491*^9}, {
   3.8250154751973257`*^9, 3.825015479261756*^9}, {3.825273845910091*^9, 
   3.8252738946551647`*^9}, {3.825515230681651*^9, 3.8255152378407803`*^9}, {
   3.825515414038652*^9, 3.825515419039789*^9}, {3.825515936430826*^9, 
   3.8255159415029907`*^9}, {3.825516861318369*^9, 3.825516862830495*^9}, {
   3.825675502041663*^9, 3.8256755210033817`*^9}, {3.8257829782497263`*^9, 
   3.8257830636723433`*^9}, {3.825788189733644*^9, 3.825788232280842*^9}, {
   3.826202912566021*^9, 3.8262029558876257`*^9}, {3.826203005460499*^9, 
   3.82620301435483*^9}, {3.826273218344248*^9, 3.8262732238192043`*^9}, {
   3.826702345347746*^9, 3.8267023569016542`*^9}, {3.826702416175194*^9, 
   3.8267024276459703`*^9}, {3.826722244899756*^9, 3.826722269279179*^9}, {
   3.826723503500682*^9, 3.826723529964252*^9}, {3.826723677797003*^9, 
   3.826723678779928*^9}, {3.826724021271275*^9, 3.8267240377569942`*^9}, {
   3.8267260086613092`*^9, 3.826726022030188*^9}, {3.8267275253690367`*^9, 
   3.826727563102295*^9}, {3.826745562989751*^9, 3.8267456444651403`*^9}, {
   3.826746383937262*^9, 3.826746386365035*^9}, {3.836845545348722*^9, 
   3.836845558470358*^9}, {3.836845923991296*^9, 3.836845926637439*^9}, {
   3.836847098557713*^9, 3.83684710674835*^9}, {3.8369706668184023`*^9, 
   3.836970670861658*^9}, {3.836970728881482*^9, 3.836970733520679*^9}, {
   3.8506622068868847`*^9, 3.85066222775132*^9}, {3.850662268713726*^9, 
   3.8506622703722277`*^9}, {3.8508083453569727`*^9, 3.850808348777463*^9}, {
   3.85081386936797*^9, 3.850813956649295*^9}, {3.8508144815045643`*^9, 
   3.850814735162149*^9}, {3.850827055357687*^9, 3.850827071541314*^9}, {
   3.850827809561503*^9, 3.85082781138632*^9}, {3.852615009722616*^9, 
   3.8526150359411793`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"0dc22a7e-82f3-470c-86ca-45b2d57fad15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Merging", " ", "gates"}], ",", " ", 
    RowBox[{
     RowBox[{
     "only", " ", "tested", " ", "for", " ", "single", " ", "rotation", " ", 
      "and", " ", "controlled"}], "-", 
     RowBox[{"rotation", " ", "so", " ", "far"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MergeGates", "::", "usage"}], "=", 
     "\"\<MergeGates[ansatz_,\[Theta]vars_] merge obvious gate in ansatz. It \
is not optimized for non-parametric gates. Works well with single rotation \
and controlled-rotations\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"MergeGates", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MergeGates", "[", 
     RowBox[{"ansatz_", ",", 
      RowBox[{"\[Theta]vars_", ":", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ancol", ",", "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "f", 
        ",", "i", ",", "j", ",", "slen", ",", "k", ",", "l", ",", 
        RowBox[{"\[Theta]merge", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"deleted", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{"True", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"slen", "=", 
           RowBox[{"Length", "@", "ansatz"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ancol", "=", 
           RowBox[{"GetCircuitColumns", "[", "ansatz", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"simplify", " ", "non"}], "-", 
            RowBox[{"parametric", " ", "gates"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"ancol", "=", 
           RowBox[{"ancol", "//.", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   SubscriptBox["H", "j_"], ",", "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   SubscriptBox["H", "j_"], ",", "e___"}], "}"}], ",", 
                 "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "c"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "e"}], "}"}], ",", "f"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   SubscriptBox["X", "j_"], ",", "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   SubscriptBox["X", "j_"], ",", "e___"}], "}"}], ",", 
                 "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "c"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "e"}], "}"}], ",", "f"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   SubscriptBox["Y", "j_"], ",", "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   SubscriptBox["Y", "j_"], ",", "e___"}], "}"}], ",", 
                 "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "c"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "e"}], "}"}], ",", "f"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   SubscriptBox["Z", "j_"], ",", "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   SubscriptBox["Z", "j_"], ",", "e___"}], "}"}], ",", 
                 "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "c"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "e"}], "}"}], ",", "f"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i_"], "[", 
                    SubscriptBox["Z", "j_"], "]"}], ",", "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i_"], "[", 
                    SubscriptBox["Z", "j_"], "]"}], ",", "e___"}], "}"}], ",",
                  "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "c"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "e"}], "}"}], ",", "f"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i_"], "[", 
                    SubscriptBox["X", "j_"], "]"}], ",", "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i_"], "[", 
                    SubscriptBox["X", "j_"], "]"}], ",", "e___"}], "}"}], ",",
                  "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "c"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "e"}], "}"}], ",", "f"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i_"], "[", 
                    SubscriptBox["Y", "j_"], "]"}], ",", "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i_"], "[", 
                    SubscriptBox["Y", "j_"], "]"}], ",", "e___"}], "}"}], ",",
                  "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "c"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "e"}], "}"}], ",", "f"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   SubscriptBox["SWAP", 
                    RowBox[{"i_", ",", "j_"}]], ",", "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   SubscriptBox["SWAP", 
                    RowBox[{"i_", ",", "j_"}]], ",", "e___"}], "}"}], ",", 
                 "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "c"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "e"}], "}"}], ",", "f"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   SubscriptBox["SWAP", 
                    RowBox[{"i_", ",", "j_"}]], ",", "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   SubscriptBox["SWAP", 
                    RowBox[{"j_", ",", "i_"}]], ",", "e___"}], "}"}], ",", 
                 "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", "c"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", "e"}], "}"}], ",", "f"}], "}"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"simplify", " ", "parametric", " ", "gates"}], " ", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"ancol", "=", 
           RowBox[{"ancol", "//.", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   RowBox[{
                    SubscriptBox["Rx", "j_"], "[", 
                    SubscriptBox["\[Theta]", "k_"], "]"}], ",", "c___"}], "}"}
                  ], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   RowBox[{
                    SubscriptBox["Rx", "j_"], "[", 
                    SubscriptBox["\[Theta]", "l_"], "]"}], ",", "e___"}], 
                  "}"}], ",", "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", 
                   RowBox[{
                    SubscriptBox["Rx", "j"], "[", 
                    SubscriptBox["\[Theta]", "k"], "]"}], ",", "c"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "k"], ",", 
                    SubscriptBox["\[Theta]", "l"]}], "}"}], ",", "e"}], "}"}],
                  ",", "f"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   RowBox[{
                    SubscriptBox["Ry", "j_"], "[", 
                    SubscriptBox["\[Theta]", "k_"], "]"}], ",", "c___"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   RowBox[{
                    SubscriptBox["Ry", "j_"], "[", 
                    SubscriptBox["\[Theta]", "l_"], "]"}], ",", "e___"}], 
                  "}"}], ",", "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", 
                   RowBox[{
                    SubscriptBox["Ry", "j"], "[", 
                    SubscriptBox["\[Theta]", "k"], "]"}], ",", "c"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "k"], ",", 
                    SubscriptBox["\[Theta]", "l"]}], "}"}], ",", "e"}], "}"}],
                  ",", "f"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   RowBox[{
                    SubscriptBox["Rz", "j_"], "[", 
                    SubscriptBox["\[Theta]", "k_"], "]"}], ",", "c___"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   RowBox[{
                    SubscriptBox["Rz", "j_"], "[", 
                    SubscriptBox["\[Theta]", "l_"], "]"}], ",", "e___"}], 
                  "}"}], ",", "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", 
                   RowBox[{
                    SubscriptBox["Rz", "j"], "[", 
                    SubscriptBox["\[Theta]", "k"], "]"}], ",", "c"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "k"], ",", 
                    SubscriptBox["\[Theta]", "l"]}], "}"}], ",", "e"}], "}"}],
                  ",", "f"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i"], "[", 
                    RowBox[{
                    SubscriptBox["Rz", "j_"], "[", 
                    SubscriptBox["\[Theta]", "k_"], "]"}], "]"}], ",", 
                   "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i"], "[", 
                    RowBox[{
                    SubscriptBox["Rz", "j_"], "[", 
                    SubscriptBox["\[Theta]", "k_"], "]"}], "]"}], ",", 
                   "e___"}], "}"}], ",", "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", 
                   RowBox[{
                    SubscriptBox["C", "i"], "[", 
                    RowBox[{
                    SubscriptBox["Rz", "j"], "[", 
                    SubscriptBox["\[Theta]", "k"], "]"}], "]"}], ",", "c"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "k"], ",", 
                    SubscriptBox["\[Theta]", "l"]}], "}"}], ",", "e"}], "}"}],
                  ",", "f"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i"], "[", 
                    RowBox[{
                    SubscriptBox["Rx", "j_"], "[", 
                    SubscriptBox["\[Theta]", "k_"], "]"}], "]"}], ",", 
                   "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i"], "[", 
                    RowBox[{
                    SubscriptBox["Rx", "j_"], "[", 
                    SubscriptBox["\[Theta]", "k_"], "]"}], "]"}], ",", 
                   "e___"}], "}"}], ",", "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", 
                   RowBox[{
                    SubscriptBox["C", "i"], "[", 
                    RowBox[{
                    SubscriptBox["Rx", "j"], "[", 
                    SubscriptBox["\[Theta]", "k"], "]"}], "]"}], ",", "c"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "k"], ",", 
                    SubscriptBox["\[Theta]", "l"]}], "}"}], ",", "e"}], "}"}],
                  ",", "f"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a___", ",", 
                 RowBox[{"{", 
                  RowBox[{"b___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i"], "[", 
                    RowBox[{
                    SubscriptBox["Ry", "j_"], "[", 
                    SubscriptBox["\[Theta]", "k_"], "]"}], "]"}], ",", 
                   "c___"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d___", ",", 
                   RowBox[{
                    SubscriptBox["C", "i"], "[", 
                    RowBox[{
                    SubscriptBox["Ry", "j_"], "[", 
                    SubscriptBox["\[Theta]", "k_"], "]"}], "]"}], ",", 
                   "e___"}], "}"}], ",", "f___"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"b", ",", 
                   RowBox[{
                    SubscriptBox["C", "i"], "[", 
                    RowBox[{
                    SubscriptBox["Ry", "j"], "[", 
                    SubscriptBox["\[Theta]", "k"], "]"}], "]"}], ",", "c"}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"d", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "k"], ",", 
                    SubscriptBox["\[Theta]", "l"]}], "}"}], ",", "e"}], "}"}],
                  ",", "f"}], "}"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"ansatz", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"ancol", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"\[Theta]merge", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"ansatz", ",", "ListQ"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ansatz", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"ansatz", ",", "_List"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"merge", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"deleted", "+=", 
           RowBox[{"Length", "@", "\[Theta]merge"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "\[Theta]merge"}], ">", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[Theta]vars", "[", 
                 RowBox[{
                 "t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "]"}], "+=", 
                RowBox[{"\[Theta]vars", "[", 
                 RowBox[{
                 "t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"\[Theta]vars", "=", 
                RowBox[{"KeyDrop", "[", 
                 RowBox[{"\[Theta]vars", ",", 
                  RowBox[{
                  "t", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "\[Theta]merge"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "ansatz"}], "==", "slen"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "deleted"}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8181783430785007`*^9, 3.818178373960538*^9}, 
   3.8181815385091877`*^9, {3.818183527179865*^9, 3.8181835527097807`*^9}, {
   3.818183694226061*^9, 3.81818371569168*^9}, {3.8181837517100163`*^9, 
   3.818183810634286*^9}, {3.8181838587437687`*^9, 3.81818386263164*^9}, {
   3.818183934518463*^9, 3.8181839756918488`*^9}, {3.818184062721219*^9, 
   3.818184166188184*^9}, {3.8181860565601788`*^9, 3.818186060660878*^9}, {
   3.8188662777181587`*^9, 3.8188662801911917`*^9}, {3.8205653285105953`*^9, 
   3.8205653460537443`*^9}, {3.820565656788571*^9, 3.820565807042951*^9}, {
   3.82056671538337*^9, 3.820566732859226*^9}, {3.82056715576589*^9, 
   3.820567327122254*^9}, {3.820567365452201*^9, 3.8205673855358677`*^9}, {
   3.820567736633729*^9, 3.820567770891005*^9}, 3.82056802151891*^9, {
   3.820568069374905*^9, 3.820568079226941*^9}, {3.8205681097323313`*^9, 
   3.820568121167489*^9}, {3.82056829659692*^9, 3.820568333110229*^9}, {
   3.82056837273374*^9, 3.8205683779281397`*^9}, {3.820582534614221*^9, 
   3.8205825617680264`*^9}, {3.820582605206716*^9, 3.820582635362645*^9}, 
   3.820582779105164*^9, {3.8205841065955153`*^9, 3.820584122384589*^9}, {
   3.820585384327263*^9, 3.8205854188170233`*^9}, {3.820585451528512*^9, 
   3.8205854536472692`*^9}, {3.82058673140893*^9, 3.820586784515963*^9}, 
   3.820586941633479*^9, {3.8205871425134287`*^9, 3.820587250508157*^9}, {
   3.82058742507642*^9, 3.8205874524008512`*^9}, {3.8205879333954268`*^9, 
   3.820587991652424*^9}, {3.820588252541177*^9, 3.820588281159019*^9}, {
   3.820588327045553*^9, 3.820588402958119*^9}, 3.820588442359911*^9, {
   3.82058946982316*^9, 3.8205894996883907`*^9}, {3.8205895648411617`*^9, 
   3.8205895774564953`*^9}, {3.820589631147852*^9, 3.820589671332962*^9}, {
   3.820589713189786*^9, 3.820589803072893*^9}, {3.82058985005087*^9, 
   3.820589856662859*^9}, {3.820589941939468*^9, 3.8205899685925207`*^9}, {
   3.8205903331746693`*^9, 3.8205903421367397`*^9}, {3.8205903749441423`*^9, 
   3.820590386971662*^9}, 3.820590621977439*^9, {3.820591621071718*^9, 
   3.820591634084134*^9}, {3.82059198090737*^9, 3.820591981242777*^9}, {
   3.820592021512986*^9, 3.820592024798676*^9}, {3.820592551801166*^9, 
   3.820592588144807*^9}, 3.820593484249713*^9, 3.82059356677217*^9, {
   3.820597763329774*^9, 3.820597826845077*^9}, {3.820597869481145*^9, 
   3.820597871119771*^9}, {3.8205979520097103`*^9, 3.8205980095864153`*^9}, {
   3.8206041831352*^9, 3.8206042008444242`*^9}, {3.820604321956541*^9, 
   3.8206043251781883`*^9}, {3.820604460824152*^9, 3.8206045083675137`*^9}, {
   3.82060509470475*^9, 3.820605256290481*^9}, {3.820605297202382*^9, 
   3.820605334166439*^9}, {3.82060544727005*^9, 3.820605505753015*^9}, {
   3.820605590369006*^9, 3.8206056200600853`*^9}, {3.820605674734445*^9, 
   3.820605704798202*^9}, {3.820606005354319*^9, 3.8206061553789062`*^9}, {
   3.820606377684765*^9, 3.82060639018797*^9}, {3.8206064459167347`*^9, 
   3.8206065520518217`*^9}, {3.820606642206402*^9, 3.820606700896222*^9}, {
   3.820606748903014*^9, 3.820606758644475*^9}, {3.820606792747056*^9, 
   3.820606795106575*^9}, {3.82060685919601*^9, 3.820606924734901*^9}, {
   3.820606992286337*^9, 3.820607042472383*^9}, {3.8206071200353403`*^9, 
   3.820607147364149*^9}, {3.820607255613263*^9, 3.8206072564512777`*^9}, {
   3.820607317642276*^9, 3.820607366040677*^9}, {3.820609391617889*^9, 
   3.820609404610262*^9}, {3.821293548556136*^9, 3.8212935704091377`*^9}, {
   3.8212959285326014`*^9, 3.821295975396806*^9}, {3.821349111142521*^9, 
   3.821349141640801*^9}, 3.821349659860861*^9, {3.821811415734954*^9, 
   3.821811468204713*^9}, {3.821811528706624*^9, 3.821811529216406*^9}, {
   3.8218767486431217`*^9, 3.821876994038789*^9}, 3.82187713350207*^9, 
   3.821877239862979*^9, 3.821877288024396*^9, 3.823616886402093*^9, {
   3.823670564424387*^9, 3.8236706556166058`*^9}, {3.823670825180327*^9, 
   3.823670868509602*^9}, {3.823670967826877*^9, 3.8236710103242483`*^9}, {
   3.823671651465732*^9, 3.823671661931498*^9}, {3.8236730811928577`*^9, 
   3.823673122280308*^9}, {3.823673365273386*^9, 3.823673366150177*^9}, {
   3.82395297193475*^9, 3.823953001311503*^9}, {3.825535296257371*^9, 
   3.825535377290172*^9}, {3.8257833877979727`*^9, 3.82578338845082*^9}, {
   3.826701747676702*^9, 3.826701783067309*^9}, {3.826701840232893*^9, 
   3.826701902203444*^9}, {3.82670209454916*^9, 3.826702187426648*^9}, {
   3.826702325784061*^9, 3.826702331671729*^9}, {3.826702455146092*^9, 
   3.826702457517173*^9}, {3.826702509584309*^9, 3.8267025511137123`*^9}, {
   3.826704796012869*^9, 3.826704843457568*^9}, {3.8267110850961514`*^9, 
   3.826711087674672*^9}, {3.826711229652351*^9, 3.8267113234916267`*^9}, {
   3.826712122858364*^9, 3.8267121366283484`*^9}, {3.826721218453601*^9, 
   3.826721258228978*^9}, {3.826721294086611*^9, 3.826721344710992*^9}, {
   3.826721383314136*^9, 3.8267214449338017`*^9}, {3.82674565439408*^9, 
   3.826745663382709*^9}, {3.833954612822612*^9, 3.833954628735763*^9}, {
   3.833955128200364*^9, 3.833955179078326*^9}, 3.835849393134869*^9, {
   3.8358496162649803`*^9, 3.8358496167629833`*^9}, {3.83585013768591*^9, 
   3.835850149774382*^9}, {3.835850202275364*^9, 3.835850205268401*^9}, {
   3.835850261253943*^9, 3.83585026195914*^9}, {3.835860904448992*^9, 
   3.835860904604116*^9}, {3.8358609774489937`*^9, 3.835860995795018*^9}, {
   3.8358611251431713`*^9, 3.8358611277129*^9}, {3.835861211492293*^9, 
   3.83586122382318*^9}, {3.83594893473487*^9, 3.835948939346427*^9}, {
   3.8359489906613617`*^9, 3.8359489923942013`*^9}, {3.83594945652248*^9, 
   3.835949532471826*^9}, {3.8359496248402767`*^9, 3.835949681979272*^9}, {
   3.83594983522908*^9, 3.8359498426114273`*^9}, {3.836034665774781*^9, 
   3.8360347537408752`*^9}, {3.836034822453673*^9, 3.8360348244948606`*^9}, {
   3.836038515321391*^9, 3.83603851713057*^9}, {3.8363731728453693`*^9, 
   3.8363731935219603`*^9}, 3.8363732269588203`*^9, {3.836374580521338*^9, 
   3.836374582154237*^9}, {3.836374749595697*^9, 3.836374806583365*^9}, {
   3.852446017623949*^9, 3.852446060575046*^9}, {3.852446224588173*^9, 
   3.85244631811236*^9}, {3.8524463724866257`*^9, 3.852446469088979*^9}, {
   3.852451648520093*^9, 3.8524517384403973`*^9}, {3.852451791683628*^9, 
   3.852451951786169*^9}, {3.852452079725132*^9, 3.852452126547175*^9}, {
   3.8524521577047777`*^9, 3.852452306717977*^9}, {3.8524524240153522`*^9, 
   3.852452507157977*^9}, {3.852452575730393*^9, 3.852452601159251*^9}, {
   3.852452639489917*^9, 3.852452676142037*^9}, {3.852452711220645*^9, 
   3.852452764491448*^9}, {3.8524528251065407`*^9, 3.852452908742371*^9}, {
   3.852453047430769*^9, 3.852453092763134*^9}, {3.852453139034419*^9, 
   3.852453241756259*^9}, {3.852453291947012*^9, 3.852453354740806*^9}, {
   3.852453416372768*^9, 3.8524534462009974`*^9}, {3.8524534904194937`*^9, 
   3.852453609051879*^9}, {3.852453675757341*^9, 3.852453693605288*^9}, {
   3.852453877002857*^9, 3.852453907133024*^9}, {3.8524539378557673`*^9, 
   3.8524539564470053`*^9}, {3.85245406227498*^9, 3.852454087179893*^9}, {
   3.852454156728087*^9, 3.852454199158599*^9}, {3.852454362373596*^9, 
   3.852454406540771*^9}, {3.852455418334076*^9, 3.85245542257983*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"ea5d5c6f-a445-4b38-afbc-cb1e57a37cb7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DeleteGateBF", "::", "usage"}], "=", 
   "\"\<BruteForceSmall\[Theta][conf,hamiltonian,fev,Akl,Ecur,ansatz,\[Theta]\
vars,TotalCirc,\[Psi],\[Psi]work,\[Psi]\[Theta]k,maxcost]. \nBrute force \
deletion, layer by layer. The first layer sometimes are useless since most of \
the time states are started from zeros.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"DeleteGateBF", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeleteGateBF", "[", 
   RowBox[{
   "conf_", ",", "hamiltonian_", ",", "fev_", ",", "Akl_", ",", "Ecur_", ",", 
    "gradstep_", ",", "ansatz_", ",", "\[Theta]vars_", ",", "TotalCirc_", ",",
     "\[Psi]_", ",", "\[Psi]work_", ",", "\[Psi]\[Theta]k_", ",", "maxcost_", 
    ",", 
    RowBox[{"full_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"idxdel", ",", "oldidxdel", ",", 
      RowBox[{"deleted", "=", "0"}], ",", 
      RowBox[{"deltot", "=", "0"}], ",", "\[Theta]del", ",", "ansatzcol", ",",
       "idxcol", ",", "idx", ",", 
      RowBox[{"\[Theta]varstmp", "=", "\[Theta]vars"}], ",", 
      RowBox[{"ansatztmp", "=", "ansatz"}], ",", "j", ",", "Eold", ",", 
      "\[Theta]varsold", ",", 
      RowBox[{"Etmp", "=", "Ecur"}], ",", "converge", ",", 
      RowBox[{"Einit", "=", "Ecur"}], ",", 
      RowBox[{"maxlayer", "=", "0"}], ",", "old\[Theta]vars", ",", "oldE", 
      ",", "nlayers", ",", 
      RowBox[{"maxiter", "=", "10"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "ansatz"}], ">", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"re", "-", 
         RowBox[{"arrange", " ", "the", " ", "ansatz"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ansatzcol", "=", 
         RowBox[{"GetCircuitColumns", "[", "ansatz", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ansatz", "=", 
         RowBox[{"Flatten", "@", "ansatzcol"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"idx", "=", "0"}], ";", 
        RowBox[{"deleted", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"idxcol", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"++", "idx"}], ",", 
             RowBox[{"{", 
              RowBox[{"Length", "@", "col"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"col", ",", "ansatzcol"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nlayers", "=", 
         RowBox[{"If", "[", 
          RowBox[{"full", ",", 
           RowBox[{"Length", "@", "idxcol"}], ",", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"0.2", "*", 
             RowBox[{"Length", "@", "idxcol"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "try", " ", "to", " ", "delete", " ", "the", " ", "first", " ", 
            "layer"}], ";", " ", 
           RowBox[{"track", " ", "ansatz"}]}], ",", " ", "\[Theta]vars", ",", 
          " ", 
          RowBox[{"E", " ", "for", " ", "a", " ", "layer"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxdel", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "record", " ", "before", " ", "removing", " ", "gate", " ", "q"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"oldidxdel", "=", "idxdel"}], ";", 
           RowBox[{"old\[Theta]vars", "=", "\[Theta]varstmp"}], ";", 
           RowBox[{"oldE", "=", "Etmp"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "update", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"idxdel", ",", 
             RowBox[{"{", "q", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ansatztmp", "=", 
            RowBox[{"Delete", "[", 
             RowBox[{"ansatz", ",", "idxdel"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Theta]del", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Level", "[", 
               RowBox[{
                RowBox[{
                "ansatz", "\[LeftDoubleBracket]", "q", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", 
              SubscriptBox["\[Theta]", "_"]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"\[Theta]varstmp", "=", 
            RowBox[{"KeyDrop", "[", 
             RowBox[{"\[Theta]varstmp", ",", "\[Theta]del"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ApplyCircuit", "[", 
            RowBox[{
             RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
             RowBox[{
              RowBox[{"TotalCirc", "[", "ansatztmp", "]"}], "/.", 
              "\[Theta]varstmp"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Etmp", "=", 
            RowBox[{"CalcExpecPauliSum", "[", 
             RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"update", " ", "ansatztmp"}], ",", "\[Theta]varstmp", 
             ",", 
             RowBox[{
             "Etmp", " ", "with", " ", "a", " ", "missing", " ", "gate"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
            RowBox[{
             RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", 
             "\[Theta]varstmp", ",", "\[Psi]\[Theta]k"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"converge", "=", "0"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "\[LessEqual]", "maxiter"}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Eold", ",", "\[Theta]varsold"}], "}"}], "=", 
               RowBox[{"{", 
                RowBox[{"Etmp", ",", "\[Theta]varstmp"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Etmp", ",", "gradstep"}], "}"}], "=", 
               RowBox[{"NatGrad", "[", 
                RowBox[{"conf", ",", "hamiltonian", ",", 
                 RowBox[{"TotalCirc", "[", "ansatztmp", "]"}], ",", 
                 "\[Theta]varstmp", ",", "Akl", ",", "\[Psi]", ",", 
                 "\[Psi]work", ",", "\[Psi]\[Theta]k"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fev", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Etmp", "\[LessEqual]", "Einit"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"converge", "+=", "1"}], ";", "\[IndentingNewLine]", 
                 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"converge", ">", "2"}], ",", 
                   RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Eold", "<", "Etmp"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"energy", " ", "is", " ", "increasing"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"Etmp", ",", "\[Theta]varstmp"}], "}"}], "=", 
                  RowBox[{"{", 
                   RowBox[{"Eold", ",", "\[Theta]varsold"}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}]}]}], " ", 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"\[Theta]varstmp", ",", 
             RowBox[{
             "Etmp", " ", "at", " ", "their", " ", "best", " ", "without", 
              " ", "gate", " ", "q"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"delete", "/", "keep"}], " ", "gate", " ", "q"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Etmp", "\[LessEqual]", "maxcost"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"deleted", "++"}], "\[IndentingNewLine]", ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", "reject", " ", "*)"}], "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Etmp", ",", "\[Theta]varstmp", ",", "idxdel"}], "}"}],
               "=", 
              RowBox[{"{", 
               RowBox[{"oldE", ",", "old\[Theta]vars", ",", "oldidxdel"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"q", ",", 
            RowBox[{"Flatten", "@", 
             RowBox[{"idxcol", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", "nlayers"}], "\[RightDoubleBracket]"}]}]}], 
           "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "exploring", " ", "the", " ", "first", " ", "layer", " ", "ends", 
            " ", "here"}], ";", " ", "Etmp"}], ",", " ", "\[Theta]varstmp", 
          ",", " ", 
          RowBox[{
          "idxdel", " ", "are", " ", "at", " ", "their", " ", "best"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"ansatz", "=", 
         RowBox[{"Delete", "[", 
          RowBox[{"ansatz", ",", "idxdel"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]vars", "=", "\[Theta]varstmp"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Ecur", "=", "Etmp"}], ";", "\[IndentingNewLine]", 
        RowBox[{"deltot", "+=", "deleted"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"stop", " ", "at", " ", "this", " ", "layer"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"deleted", "===", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"++", "maxlayer"}], ">", "2"}], ",", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"maxlayer", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
      RowBox[{
       RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", "\[Theta]vars", ",",
        "\[Psi]\[Theta]k"}], "]"}], ";", "\[IndentingNewLine]", "deltot"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.836621817776767*^9, 3.8366219639235573`*^9}, {
   3.8366231537327433`*^9, 3.836623178476821*^9}, {3.836623833397497*^9, 
   3.83662394278389*^9}, {3.836623974893667*^9, 3.836623988705721*^9}, {
   3.836624052989444*^9, 3.8366240542845297`*^9}, {3.836624364942831*^9, 
   3.836624397221542*^9}, {3.836624490398782*^9, 3.836624642762208*^9}, {
   3.836624945604765*^9, 3.836625009779868*^9}, {3.836628976198637*^9, 
   3.83662909593604*^9}, {3.836630237339623*^9, 3.836630291048058*^9}, {
   3.8366309645046062`*^9, 3.836630974881421*^9}, {3.83663401150735*^9, 
   3.836634081808085*^9}, {3.836634138843286*^9, 3.836634173827648*^9}, {
   3.8366342081132917`*^9, 3.836634218148638*^9}, {3.8366342710850563`*^9, 
   3.836634347129417*^9}, {3.8366343800924873`*^9, 3.836634521310721*^9}, {
   3.836634571953568*^9, 3.836634580340584*^9}, {3.836634620435199*^9, 
   3.8366346216855516`*^9}, {3.8366354185805883`*^9, 3.836635426138947*^9}, {
   3.836635479078823*^9, 3.8366354869335012`*^9}, {3.836635543421794*^9, 
   3.836635593036117*^9}, {3.836635839638379*^9, 3.8366359885493927`*^9}, {
   3.836636020201988*^9, 3.8366360636948347`*^9}, {3.836636141147897*^9, 
   3.836636182231297*^9}, {3.836636213204706*^9, 3.836636340443462*^9}, {
   3.836636385891758*^9, 3.836636507367962*^9}, {3.8366365663991528`*^9, 
   3.8366366473866253`*^9}, {3.8366699665255327`*^9, 3.836669966725874*^9}, {
   3.836670961034211*^9, 3.8366710164752693`*^9}, {3.836671144311689*^9, 
   3.836671147426149*^9}, {3.836671572791704*^9, 3.83667157484299*^9}, {
   3.83667262538662*^9, 3.836672634919853*^9}, {3.83667267750366*^9, 
   3.836672696196475*^9}, {3.836672739996728*^9, 3.836672747192834*^9}, {
   3.836672782029915*^9, 3.83667278659543*^9}, {3.836672861601343*^9, 
   3.836672890103736*^9}, {3.8366733907171917`*^9, 3.836673395780321*^9}, {
   3.836674772347981*^9, 3.8366747727474527`*^9}, {3.836674804726362*^9, 
   3.836674808723342*^9}, {3.836675087887486*^9, 3.836675088274767*^9}, 
   3.8366757436143923`*^9, {3.8367316367065687`*^9, 3.836731664727727*^9}, {
   3.836731975070307*^9, 3.836731977038352*^9}, {3.836732010341254*^9, 
   3.836732011408627*^9}, {3.836732042254277*^9, 3.836732058341963*^9}, {
   3.8367322151650953`*^9, 3.836732235241214*^9}, {3.836736368522545*^9, 
   3.836736375184916*^9}, 3.836737389761825*^9, {3.83673743043438*^9, 
   3.83673743081115*^9}, {3.836742472779571*^9, 3.836742485936392*^9}, {
   3.836815915621726*^9, 3.836815919929845*^9}, {3.836815952035784*^9, 
   3.836815956139511*^9}, {3.836816354920033*^9, 3.8368163668379087`*^9}, {
   3.836816606687563*^9, 3.836816607271585*^9}, {3.836816644413088*^9, 
   3.836816691643502*^9}, {3.836816743686158*^9, 3.83681674988587*^9}, {
   3.836817118303303*^9, 3.836817127564746*^9}, {3.836817179253635*^9, 
   3.836817245410141*^9}, {3.836817361553335*^9, 3.836817366707061*^9}, {
   3.836817401006854*^9, 3.83681742371815*^9}, {3.8368174828331823`*^9, 
   3.836817513117016*^9}, {3.836817614464485*^9, 3.8368176219789248`*^9}, 
   3.836845364261538*^9, {3.8368824138446217`*^9, 3.836882420423218*^9}, {
   3.8368824601343203`*^9, 3.836882463048114*^9}, {3.836882627756649*^9, 
   3.836882635603615*^9}, {3.836882724097458*^9, 3.836882813100594*^9}, {
   3.836883020031021*^9, 3.836883069482835*^9}, {3.836887158738893*^9, 
   3.836887243228346*^9}, {3.836887620642557*^9, 3.836887719385228*^9}, {
   3.836887773129815*^9, 3.836887830722065*^9}, {3.836888805482313*^9, 
   3.8368888120776463`*^9}, {3.836888867318452*^9, 3.836888922506467*^9}, {
   3.836888963260622*^9, 3.836888967602556*^9}, {3.836889038073484*^9, 
   3.836889038236683*^9}, {3.836889107295884*^9, 3.836889110433589*^9}, {
   3.836889159183144*^9, 3.836889165559431*^9}, {3.8368892191852083`*^9, 
   3.836889245588292*^9}, {3.836889303597205*^9, 3.836889336609771*^9}, {
   3.836889367619385*^9, 3.8368893761062403`*^9}, {3.836889901476749*^9, 
   3.836889914766522*^9}, {3.836890653996151*^9, 3.836890672687337*^9}, {
   3.8368910559805593`*^9, 3.836891062395076*^9}, {3.836891101224144*^9, 
   3.836891103941915*^9}, {3.836891139123129*^9, 3.836891170685596*^9}, {
   3.836891224554327*^9, 3.8368912277816887`*^9}, {3.836891637502396*^9, 
   3.8368916491584883`*^9}, {3.836891680950432*^9, 3.83689168800758*^9}, {
   3.836891743436018*^9, 3.836891757725992*^9}, {3.83689179241368*^9, 
   3.8368918049580193`*^9}, {3.836891853636239*^9, 3.836891861512124*^9}, {
   3.836891975720533*^9, 3.836891983521742*^9}, {3.83689202371546*^9, 
   3.836892026521031*^9}, {3.8368920676961403`*^9, 3.836892147586886*^9}, {
   3.836892206015462*^9, 3.836892206189681*^9}, {3.836969115076797*^9, 
   3.836969120104246*^9}, 3.8369691609864407`*^9, {3.8369702889767027`*^9, 
   3.836970289530698*^9}, {3.8369705079418583`*^9, 3.836970535854033*^9}, {
   3.843540850093403*^9, 3.843540854667593*^9}, {3.850662079458786*^9, 
   3.850662093607074*^9}, {3.850662185451857*^9, 3.850662190959936*^9}, {
   3.850796637127273*^9, 3.850796638372381*^9}, {3.850805230373167*^9, 
   3.850805280825716*^9}, {3.850808759761683*^9, 3.8508087610420227`*^9}, {
   3.850814784895211*^9, 3.850814789477612*^9}, {3.850814993774186*^9, 
   3.85081502702461*^9}, {3.8508169286625843`*^9, 3.850816944675621*^9}, {
   3.850817032974497*^9, 3.850817056635614*^9}, {3.850817118740942*^9, 
   3.850817151098177*^9}, {3.8508172233918962`*^9, 3.850817235883977*^9}, {
   3.850817278190757*^9, 3.850817368684058*^9}, {3.850817602005966*^9, 
   3.850817602623748*^9}, {3.850827135610064*^9, 3.850827180417922*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"ddd6f67e-e161-4a99-919e-2cf240262349"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BruteForceSmall\[Theta]", "::", "usage"}], "=", 
   "\"\<BruteForceSmall\[Theta][conf,hamiltonian,fev,Akl,Ecur,ansatz,\[Theta]\
vars,TotalCirc,\[Psi],\[Psi]work,\[Psi]\[Theta]k,maxcost,fullbf]\n \
Burte-focefully try to eliminate small gates. Gates are sorted by the angles, \
and eliminate it one by one until it fails failtrial times, unless\n\
fullbf=True. If fullbf=True, SWAPs will be deleted as well.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"BruteForceSmall\[Theta]", ",", "HoldAll"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BruteForceSmall\[Theta]", "[", 
   RowBox[{
   "conf_", ",", "hamiltonian_", ",", "fev_", ",", "Akl_", ",", "Ecur_", ",", 
    "gradstep_", ",", "ansatz_", ",", "\[Theta]vars_", ",", "TotalCirc_", ",",
     "\[Psi]_", ",", "\[Psi]work_", ",", "\[Psi]\[Theta]k_", ",", "maxcost_", 
    ",", 
    RowBox[{"fullbf_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ansatztmp", ",", 
      RowBox[{"Etmp", "=", "Ecur"}], ",", 
      RowBox[{"Akltmp", "=", "Akl"}], ",", 
      RowBox[{"\[Theta]varstmp", "=", "\[Theta]vars"}], ",", 
      RowBox[{"\[Theta]varsinit", "=", "\[Theta]vars"}], ",", 
      RowBox[{"Einit", "=", "Ecur"}], ",", 
      RowBox[{"del\[Theta]", "=", 
       RowBox[{"{", "}"}]}], ",", "k", ",", "j", ",", "keysort\[Theta]vars", 
      ",", "ansatzold", ",", "Eold", ",", "\[Theta]varsold", ",", "Aklold", 
      ",", "\[Theta]cand", ",", 
      RowBox[{"converge", "=", "0"}], ",", 
      RowBox[{"deleted", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"fail", "=", "0"}], ",", 
      RowBox[{"fail\[Theta]", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"maxfail", "=", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Brutefocelly", " ", "try", " ", "to", " ", "delete", " ", "each", " ", 
      "gate", " ", "from", " ", "the", " ", "smallest", " ", "one"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"keysort\[Theta]vars", "=", 
      RowBox[{"Keys", "[", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"#", "-", 
               RowBox[{"4", "\[Pi]"}]}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"#", "-", 
               RowBox[{"2", "\[Pi]"}]}], "]"}], ",", 
             RowBox[{"Abs", "[", "#", "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"#", "+", 
               RowBox[{"2", "\[Pi]"}]}], "]"}], ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"#", "+", 
               RowBox[{"4", "\[Pi]"}]}], "]"}]}], "}"}], "]"}], "&"}], "/@", 
         "\[Theta]vars"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", " ", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "@", "keysort\[Theta]vars"}]}], ",", " ", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Theta]cand", "=", 
         RowBox[{
         "keysort\[Theta]vars", "\[LeftDoubleBracket]", "k", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"keep", " ", "the", " ", "parameterized", " ", "swaps"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Not]", "fullbf"}], " ", "&&", " ", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"ansatz", ",", 
                RowBox[{"_", "?", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ContainsAny", "[", 
                    RowBox[{
                    RowBox[{"Level", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                    RowBox[{"{", "\[Theta]cand", "}"}]}], "]"}], "&"}], 
                  ")"}]}]}], "]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              SubscriptBox["SW", "__"], "[", "_", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", 
        RowBox[{"\[Theta]varstmp", "=", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{"\[Theta]vars", ",", 
           RowBox[{"{", "\[Theta]cand", "}"}]}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"ansatztmp", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"ansatz", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ContainsAny", "[", 
               RowBox[{
                RowBox[{"Level", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"-", "1"}]}], "]"}], ",", 
                RowBox[{"{", "\[Theta]cand", "}"}]}], "]"}], "&"}], ")"}]}]}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{
          RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
          RowBox[{
           RowBox[{"TotalCirc", "[", "ansatztmp", "]"}], "/.", 
           "\[Theta]varstmp"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Etmp", "=", 
         RowBox[{"CalcExpecPauliSum", "[", 
          RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"relax", " ", "up", " ", "to", " ", "maxfevbf"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", 
          "\[Theta]varstmp", ",", "\[Psi]\[Theta]k"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"conf", "[", "\"\<maxfevbf\>\"", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "Eold", ",", "ansatzold", ",", "\[Theta]varsold", ",", 
              "Aklold"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
             "Etmp", ",", "ansatztmp", ",", "\[Theta]varstmp", ",", 
              "Akltmp"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"gradstep", ",", "Etmp"}], "}"}], "=", 
            RowBox[{"NatGrad", "[", 
             RowBox[{"conf", ",", "hamiltonian", ",", 
              RowBox[{"TotalCirc", "[", "ansatztmp", "]"}], ",", 
              "\[Theta]varstmp", ",", "Akltmp", ",", "\[Psi]", ",", 
              "\[Psi]work", ",", "\[Psi]\[Theta]k"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fev", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Etmp", "\[LessEqual]", "Einit"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"converge", "+=", "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"converge", ">", 
                 RowBox[{"0.1", "*", 
                  RowBox[{"conf", "[", "\"\<maxfevbf\>\"", "]"}]}]}], ",", 
                RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Eold", "<", "Etmp"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"energy", " ", "is", " ", "increasing"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "Etmp", ",", "ansatztmp", ",", "\[Theta]varstmp", ",", 
                 "Akltmp"}], "}"}], "=", 
               RowBox[{"{", 
                RowBox[{
                "Eold", ",", "ansatzold", ",", "\[Theta]varsold", ",", 
                 "Aklold"}], "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}]}]}], "]"}]}]}], " ", 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Etmp", "\[LessEqual]", " ", "maxcost"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"works", " ", "out"}], ",", " ", 
            RowBox[{"apply", " ", "changes"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ansatz", ",", "Ecur", ",", "\[Theta]vars", ",", "Akl"}],
              "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
             "ansatztmp", ",", "Etmp", ",", "\[Theta]varstmp", ",", 
              "Akltmp"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"del\[Theta]", ",", "\[Theta]cand"}], "]"}]}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fail", "+=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"fail\[Theta]", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Theta]varsinit", "[", "\[Theta]cand", "]"}], ",", 
                 
                 RowBox[{"{", 
                  RowBox[{"Ecur", ",", "Etmp"}], "}"}], ",", "maxcost"}], 
                "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"fail", "\[GreaterEqual]", "maxfail"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
      RowBox[{
       RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", "\[Theta]vars", ",",
        "\[Psi]\[Theta]k"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Length", "@", "del\[Theta]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.818873855255032*^9, 3.818874109953802*^9}, {
   3.818956030099131*^9, 3.818956087572915*^9}, {3.818956232793655*^9, 
   3.818956242352602*^9}, {3.818956309665516*^9, 3.818956310967348*^9}, {
   3.819722749505988*^9, 3.819722764173705*^9}, {3.8198098147852*^9, 
   3.8198098299709883`*^9}, {3.820009974335231*^9, 3.820009979646825*^9}, {
   3.8206071855756903`*^9, 3.8206072170459623`*^9}, {3.820607381312777*^9, 
   3.820607381574059*^9}, {3.820610350964765*^9, 3.820610351953207*^9}, {
   3.821308685943389*^9, 3.821308722095748*^9}, {3.821308886249062*^9, 
   3.8213089756168003`*^9}, {3.821309022190922*^9, 3.8213090568774233`*^9}, {
   3.821310298147174*^9, 3.821310298680398*^9}, {3.821310992841588*^9, 
   3.8213110049479027`*^9}, 3.821311731618533*^9, {3.8213117676465282`*^9, 
   3.8213118712754507`*^9}, {3.821468632759301*^9, 3.821468699110268*^9}, {
   3.8214690257233458`*^9, 3.82146902935087*^9}, {3.8214690757448053`*^9, 
   3.821469078575101*^9}, {3.82147118274763*^9, 3.821471203195614*^9}, {
   3.8214713172734537`*^9, 3.821471324773548*^9}, {3.8224957963992987`*^9, 
   3.8224958179011307`*^9}, {3.822590833906672*^9, 3.822590852461075*^9}, {
   3.822590954415786*^9, 3.822590954952507*^9}, {3.822591062252946*^9, 
   3.822591119779368*^9}, {3.8225912275007*^9, 3.8225912292622957`*^9}, 
   3.822591515616613*^9, {3.8225918213372602`*^9, 3.822591854753639*^9}, {
   3.822766885992096*^9, 3.822766887732272*^9}, 3.822770067883275*^9, 
   3.822770100526033*^9, {3.822772486529903*^9, 3.8227724956979094`*^9}, {
   3.822775813328052*^9, 3.822775832215436*^9}, 3.8227758818297777`*^9, {
   3.822776091537428*^9, 3.822776093152973*^9}, 3.8227798271096907`*^9, {
   3.82360060615659*^9, 3.823600653160192*^9}, {3.823600711517661*^9, 
   3.823600769260391*^9}, {3.823600805358383*^9, 3.823600817397183*^9}, {
   3.823607020475545*^9, 3.823607021166464*^9}, {3.823608945890375*^9, 
   3.82360894897884*^9}, {3.823610404846787*^9, 3.823610415912855*^9}, {
   3.823611495251521*^9, 3.823611505597125*^9}, {3.823611646322658*^9, 
   3.82361165491634*^9}, {3.823611727439192*^9, 3.823611728646472*^9}, 
   3.8236118598266783`*^9, {3.82361336351303*^9, 3.823613378872157*^9}, {
   3.823613481466988*^9, 3.823613485409556*^9}, {3.823617040626225*^9, 
   3.823617042019286*^9}, {3.8236212491020184`*^9, 3.8236212689249983`*^9}, {
   3.823627155346277*^9, 3.823627156100202*^9}, {3.8236280665243692`*^9, 
   3.8236282616051693`*^9}, {3.823629088703967*^9, 3.823629119243306*^9}, {
   3.8236292608649483`*^9, 3.82362928180029*^9}, {3.823629365338933*^9, 
   3.823629375570187*^9}, {3.823629483539925*^9, 3.823629518290625*^9}, {
   3.823629579723535*^9, 3.8236295812428303`*^9}, {3.82362996787331*^9, 
   3.823629969766327*^9}, {3.823631474831423*^9, 3.823631478238799*^9}, {
   3.823631680270007*^9, 3.823631688151613*^9}, {3.823632268279265*^9, 
   3.823632341698794*^9}, {3.823632743374199*^9, 3.8236327482576857`*^9}, {
   3.8236328849618597`*^9, 3.823632896753915*^9}, {3.8236330143507557`*^9, 
   3.823633057495964*^9}, {3.823633270979965*^9, 3.823633285792139*^9}, {
   3.823633343512781*^9, 3.823633345288516*^9}, 3.823633470197496*^9, {
   3.823633645421156*^9, 3.823633645865752*^9}, {3.823633940366403*^9, 
   3.823633945178944*^9}, 3.823634003062375*^9, {3.82363409391789*^9, 
   3.823634125779737*^9}, {3.8236342195483627`*^9, 3.823634292788316*^9}, {
   3.8236343364058037`*^9, 3.823634346786643*^9}, 3.82363450296206*^9, {
   3.82368665155647*^9, 3.82368665262477*^9}, {3.8236883682068787`*^9, 
   3.823688368500532*^9}, {3.8236897884443903`*^9, 3.823689812597711*^9}, {
   3.8236898622238493`*^9, 3.8236899965614634`*^9}, {3.823690291457019*^9, 
   3.82369029371835*^9}, {3.823690350245283*^9, 3.823690396836857*^9}, 
   3.823690558794621*^9, {3.823690654771811*^9, 3.823690655717033*^9}, {
   3.823694535784425*^9, 3.823694556669009*^9}, {3.823694616162448*^9, 
   3.823694616804895*^9}, {3.823694932279778*^9, 3.8236949518575153`*^9}, {
   3.823695553543325*^9, 3.8236955575534163`*^9}, {3.8236956339797773`*^9, 
   3.8236956342807693`*^9}, {3.823695735456471*^9, 3.8236957564113293`*^9}, {
   3.823696004738207*^9, 3.823696023352417*^9}, {3.8236961097895327`*^9, 
   3.82369611002678*^9}, {3.823696319561955*^9, 3.823696335731265*^9}, {
   3.8236963983075523`*^9, 3.8236964197618303`*^9}, {3.823696574309964*^9, 
   3.8236966103845873`*^9}, {3.823696696966457*^9, 3.823696714758093*^9}, {
   3.823696828049471*^9, 3.823696844193653*^9}, {3.823696916061658*^9, 
   3.823696919218289*^9}, {3.8236970832960253`*^9, 3.823697087713183*^9}, {
   3.82369718931507*^9, 3.8236972256028748`*^9}, {3.823697719306642*^9, 
   3.823697761336648*^9}, 3.8236981424819517`*^9, {3.823698757323741*^9, 
   3.823698759669546*^9}, {3.8236989712499733`*^9, 3.823698994217457*^9}, {
   3.823699423180088*^9, 3.823699447938558*^9}, {3.823699661900209*^9, 
   3.823699665735373*^9}, {3.823699804365018*^9, 3.823699865269108*^9}, {
   3.823703296727531*^9, 3.823703310719843*^9}, {3.823722266084755*^9, 
   3.8237222845427637`*^9}, {3.823722472087607*^9, 3.823722485370783*^9}, {
   3.8237682533715153`*^9, 3.8237683975758133`*^9}, {3.823872345008663*^9, 
   3.8238724186419497`*^9}, {3.8238724515982447`*^9, 3.82387248047033*^9}, {
   3.823872602954564*^9, 3.823872609957696*^9}, {3.823940484543015*^9, 
   3.823940503198367*^9}, {3.823940635533434*^9, 3.823940655922084*^9}, {
   3.8239407031568403`*^9, 3.82394077609368*^9}, {3.823941004880281*^9, 
   3.823941065082859*^9}, {3.823941277794383*^9, 3.823941300253818*^9}, {
   3.823941437838209*^9, 3.82394147126481*^9}, {3.823941525544861*^9, 
   3.8239416057313433`*^9}, {3.823941837773363*^9, 3.823941846812525*^9}, {
   3.823942107127816*^9, 3.823942154556027*^9}, {3.823942385643715*^9, 
   3.8239424392058983`*^9}, {3.8239424951207123`*^9, 3.823942516012985*^9}, {
   3.8239425502384577`*^9, 3.8239425807315617`*^9}, {3.8239427599399014`*^9, 
   3.823942889481806*^9}, {3.8239433360466413`*^9, 3.823943349084284*^9}, {
   3.8239435719201593`*^9, 3.823943575072782*^9}, {3.823943758653471*^9, 
   3.823943759432969*^9}, {3.823944033374577*^9, 3.8239440338173847`*^9}, {
   3.8239444174524317`*^9, 3.823944420655683*^9}, {3.8239445207419786`*^9, 
   3.823944535197578*^9}, {3.8239446848095093`*^9, 3.823944706306438*^9}, {
   3.823944912567836*^9, 3.823944919517774*^9}, {3.823945401095203*^9, 
   3.823945403271422*^9}, {3.823945664130427*^9, 3.823945672812993*^9}, {
   3.8239457447823544`*^9, 3.823945840052346*^9}, {3.823946281943831*^9, 
   3.823946282795823*^9}, {3.823946413787971*^9, 3.823946450596706*^9}, {
   3.823946972602528*^9, 3.8239471466131363`*^9}, {3.823947467767408*^9, 
   3.8239474925338907`*^9}, {3.823947661647028*^9, 3.823947662493882*^9}, {
   3.823947951508203*^9, 3.823947954525481*^9}, {3.823947987304728*^9, 
   3.823947992527081*^9}, {3.823948078807273*^9, 3.8239480831450872`*^9}, {
   3.823948142310906*^9, 3.823948146740965*^9}, 3.823948276757147*^9, {
   3.8239483114896317`*^9, 3.823948317985681*^9}, {3.823948485675153*^9, 
   3.823948491245616*^9}, {3.823948569016613*^9, 3.82394860095048*^9}, {
   3.8239487405622063`*^9, 3.823948825173196*^9}, {3.823948963428047*^9, 
   3.823948970955133*^9}, {3.823949672823942*^9, 3.823949698412364*^9}, {
   3.823949758166374*^9, 3.823949769838129*^9}, {3.823949824237797*^9, 
   3.8239498972987223`*^9}, {3.82395021289742*^9, 3.823950294850006*^9}, {
   3.823950549890459*^9, 3.823950568083723*^9}, {3.823950717011649*^9, 
   3.8239507668740807`*^9}, {3.823950822495401*^9, 3.823950865686021*^9}, {
   3.8239509115418673`*^9, 3.823950945663768*^9}, {3.823951442394627*^9, 
   3.823951442716689*^9}, {3.8239515286728573`*^9, 3.8239515609364367`*^9}, {
   3.823951610555811*^9, 3.8239516300176773`*^9}, {3.823951674700185*^9, 
   3.823951677581197*^9}, {3.823951752814521*^9, 3.8239517753205214`*^9}, {
   3.823951825262383*^9, 3.82395185854256*^9}, {3.823951924435261*^9, 
   3.823951924775259*^9}, {3.823951978310886*^9, 3.8239519791112833`*^9}, {
   3.82395201106339*^9, 3.823952025299223*^9}, {3.823952181042832*^9, 
   3.8239522219362297`*^9}, 3.823952989749249*^9, 3.823953051064802*^9, {
   3.823953082477406*^9, 3.823953085482381*^9}, 3.8239531601607513`*^9, {
   3.8241976506664953`*^9, 3.824197657399856*^9}, {3.824209870099125*^9, 
   3.824209883945196*^9}, {3.824209915236794*^9, 3.824209948776367*^9}, {
   3.824209991267199*^9, 3.8242100258178387`*^9}, {3.824212164777116*^9, 
   3.824212202944515*^9}, {3.824220331752522*^9, 3.824220365673822*^9}, {
   3.8242204005820704`*^9, 3.82422046836042*^9}, {3.824294236643528*^9, 
   3.824294247861829*^9}, {3.824299155502481*^9, 3.824299160295725*^9}, {
   3.82430653705016*^9, 3.8243067235036583`*^9}, {3.8243097239406853`*^9, 
   3.824309806297893*^9}, 3.8243112891507587`*^9, {3.824318843120521*^9, 
   3.824318887398119*^9}, {3.824318923692133*^9, 3.824319015450757*^9}, {
   3.824319046128158*^9, 3.8243190512423897`*^9}, {3.824321060793516*^9, 
   3.824321097656966*^9}, {3.824321229400552*^9, 3.824321240627344*^9}, {
   3.82432135474119*^9, 3.824321355179895*^9}, {3.8243215786652937`*^9, 
   3.8243216091726627`*^9}, {3.824321660945291*^9, 3.824321685707899*^9}, {
   3.824322362118515*^9, 3.824322377594945*^9}, {3.824539373444551*^9, 
   3.824539387588983*^9}, {3.8245394203625193`*^9, 3.824539435824663*^9}, {
   3.824539773646077*^9, 3.824539821894484*^9}, {3.824541006392351*^9, 
   3.824541044793991*^9}, {3.824541910156546*^9, 3.824541918084787*^9}, {
   3.82454207510058*^9, 3.824542082201923*^9}, {3.824542457049595*^9, 
   3.824542470899317*^9}, {3.824542729228791*^9, 3.824542841789768*^9}, {
   3.824543208306665*^9, 3.824543248946312*^9}, {3.82454328007117*^9, 
   3.824543280729487*^9}, {3.824543542445122*^9, 3.8245435474263763`*^9}, {
   3.824543612700886*^9, 3.8245436252599792`*^9}, {3.82454388033643*^9, 
   3.824543880761352*^9}, {3.824543959963067*^9, 3.8245440236987467`*^9}, {
   3.82454837858652*^9, 3.824548394728629*^9}, {3.824549981715664*^9, 
   3.82454999373595*^9}, {3.824550030963603*^9, 3.824550035993519*^9}, {
   3.8245502760217943`*^9, 3.82455031359163*^9}, {3.824852692530924*^9, 
   3.8248526963046913`*^9}, {3.824882835344887*^9, 3.824882885143928*^9}, {
   3.8255169024040327`*^9, 3.825516911763253*^9}, {3.825516975849502*^9, 
   3.825516978658951*^9}, {3.825517088370191*^9, 3.825517128791875*^9}, {
   3.825517250209673*^9, 3.82551730484807*^9}, {3.8255173724470663`*^9, 
   3.825517373690166*^9}, {3.825517407769643*^9, 3.82551741283834*^9}, {
   3.825517443420141*^9, 3.825517471496986*^9}, {3.825783406042478*^9, 
   3.825783450627048*^9}, {3.825785174712576*^9, 3.82578518666142*^9}, {
   3.825785657597742*^9, 3.825785657750877*^9}, {3.8257882505147457`*^9, 
   3.8257882776716747`*^9}, {3.826724330245575*^9, 3.826724361538409*^9}, {
   3.82672440521992*^9, 3.826724426212617*^9}, {3.8267244656827*^9, 
   3.826724477264516*^9}, {3.8267245161722393`*^9, 3.826724522861226*^9}, {
   3.826725121642517*^9, 3.826725125677885*^9}, {3.826725271795576*^9, 
   3.826725349724935*^9}, {3.826725390557951*^9, 3.826725390957159*^9}, {
   3.826725561273143*^9, 3.826725624152841*^9}, {3.826725660061062*^9, 
   3.826725663548873*^9}, {3.8267257464491568`*^9, 3.826725748360794*^9}, {
   3.826725871960617*^9, 3.826725880709556*^9}, {3.826745679869775*^9, 
   3.8267457281310043`*^9}, {3.8334551836329517`*^9, 3.833455204720096*^9}, {
   3.836623266604587*^9, 3.8366232710328693`*^9}, {3.836623375232317*^9, 
   3.836623377788216*^9}, {3.836817583603997*^9, 3.836817586917571*^9}, {
   3.843540838221579*^9, 3.843540842859898*^9}, {3.850662104798472*^9, 
   3.850662115004437*^9}, {3.8506621727354937`*^9, 3.850662178434848*^9}, {
   3.850827774231245*^9, 3.850827784828456*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"91a75a03-08f1-4019-b332-57233552b753"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DeleteGatesByMetric", "::", "usage"}], "=", 
   "\"\<DeleteGatesByMetric[conf,hamiltonian,fev,Akl,Ecur,ansatz,\[Theta]vars,\
TotalCirc,\[Psi],\[Psi]work,\[Psi]\[Theta]k,maxcost]\ndelete gates by \
similarity of rows in metric \!\(\*SubscriptBox[\(A\), \(kl\)]\)\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"DeleteGatesByMetric", ",", "HoldAll"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeleteGatesByMetric", "[", 
   RowBox[{
   "conf_", ",", "hamiltonian_", ",", "fev_", ",", "Akl_", ",", "Ecur_", ",", 
    "gradstep_", ",", "ansatz_", ",", "\[Theta]vars_", ",", "TotalCirc_", ",",
     "\[Psi]_", ",", "\[Psi]work_", ",", "\[Psi]\[Theta]k_", ",", 
    "maxcost_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"didx", "=", 
       RowBox[{"{", "}"}]}], ",", "\[Theta]del", ",", "elim\[Theta]", ",", 
      "gphase", ",", 
      RowBox[{"ndeleted", "=", "0"}], ",", "\[Theta]varskeys", ",", "Eold", 
      ",", "\[Theta]varsold", ",", "Aklold", ",", "dE", ",", 
      RowBox[{"econverge", "=", "0"}], ",", 
      RowBox[{"Etmp", "=", "Ecur"}], ",", 
      RowBox[{"Akltmp", "=", "Akl"}], ",", 
      RowBox[{"\[Theta]varstmp", "=", "\[Theta]vars"}], ",", 
      RowBox[{"ansatztmp", "=", "ansatz"}], ",", 
      RowBox[{"simidx", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"dim", "=", 
       SuperscriptBox["2", 
        RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}]]}], ",", "j", ",", 
      "sim\[Theta]"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"this", " ", 
       RowBox[{"isn", "'"}], "t", " ", "really", " ", "good"}], ",", " ", 
      RowBox[{"but", " ", "we", " ", "need", " ", "updated", " ", "Akl"}]}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
      RowBox[{
       RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", "\[Theta]vars", ",",
        "\[Psi]\[Theta]k"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"CalcQuregDerivs", "[", 
      RowBox[{
       RowBox[{"TotalCirc", "[", "ansatz", "]"}], ",", 
       RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
       RowBox[{"Normal", "[", "\[Theta]vars", "]"}], ",", "\[Psi]\[Theta]k"}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Akl", "=", 
      RowBox[{
       RowBox[{"CalcInnerProducts", "[", "\[Psi]\[Theta]k", "]"}], "//", 
       "Re"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"indices", " ", "of", " ", "redundant", " ", "rows"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", "i"}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{"Akl", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "<=", 
            RowBox[{"conf", "[", "\"\<metignore\>\"", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"too", " ", "flat"}], " ", "*)"}], "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"didx", ",", "i"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "find", " ", "other", " ", "similar", " ", "ones", " ", "by", " ",
              "projecting"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Catch", "[", 
              RowBox[{
               RowBox[{"VectorAngle", "[", 
                RowBox[{
                 RowBox[{"Akl", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"Akl", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[LessEqual]", 
               RowBox[{"conf", "[", "\"\<metignore\>\"", "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"didx", ",", "i"}], "]"}], ";", "\[IndentingNewLine]", 
              
              RowBox[{"AppendTo", "[", 
               RowBox[{"simidx", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"found", " ", "the", " ", "similar", " ", "one"}], " ",
                "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "Akl"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Theta]varskeys", "=", 
      RowBox[{"Keys", "@", "\[Theta]vars"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"elim\[Theta]", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
        "\[Theta]varskeys", "\[LeftDoubleBracket]", "j", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "didx"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "elim\[Theta]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"update", " ", "assoc", " ", "\[Theta]vars"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Theta]varstmp", "=", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{"\[Theta]vars", ",", "elim\[Theta]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ansatztmp", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"ansatz", ",", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ContainsAny", "[", 
               RowBox[{
                RowBox[{"Level", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"-", "1"}]}], "]"}], ",", "elim\[Theta]"}], "]"}], 
              "&"}], ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", 
          "\[Theta]varstmp", ",", "\[Psi]\[Theta]k"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Relax", " ", "the", " ", "result"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"conf", "[", "\"\<maxfevbf\>\"", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Eold", ",", "\[Theta]varsold", ",", "Aklold"}], "}"}], 
            "=", 
            RowBox[{"{", 
             RowBox[{"Etmp", ",", "\[Theta]varstmp", ",", "Akltmp"}], "}"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Etmp", ",", "gradstep"}], "}"}], "=", 
            RowBox[{"NatGrad", "[", 
             RowBox[{"conf", ",", "hamiltonian", ",", 
              RowBox[{"TotalCirc", "[", "ansatztmp", "]"}], ",", 
              "\[Theta]varstmp", ",", "Akltmp", ",", "\[Psi]", ",", 
              "\[Psi]work", ",", "\[Psi]\[Theta]k"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fev", "++"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Etmp", "\[LessEqual]", "Ecur"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"econverge", "+=", "1"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"econverge", ">", 
                 RowBox[{"conf", "[", "\"\<iterconverge\>\"", "]"}]}], ",", 
                RowBox[{"Break", "[", "]"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"j", ">", "1"}], " ", "&&", " ", 
              RowBox[{"Eold", "<", "Etmp"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"energy", " ", "is", " ", "increasing"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Etmp", ",", "\[Theta]varstmp", ",", "Akltmp"}], 
                "}"}], "=", 
               RowBox[{"{", 
                RowBox[{"Eold", ",", "\[Theta]varsold", ",", "Aklold"}], 
                "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}]}]}], "]"}]}]}], " ", 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"end", " ", "of", " ", "relaxation"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Etmp", "\[LessEqual]", "maxcost"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndeleted", "+=", 
            RowBox[{"Length", "@", "elim\[Theta]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"{", 
               RowBox[{"sim\[Theta]", ",", "ansatz", ",", "\[Theta]vars", ",", 
                RowBox[{"DrawCircuit", "[", 
                 RowBox[{
                  RowBox[{"ansatz", "/.", "CustomGatesDraw"}], ",", 
                  RowBox[{"conf", "[", "\"\<nqmain\>\"", "]"}]}], "]"}]}], 
               "}"}], "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Ecur", ",", "ansatz", ",", "\[Theta]vars", ",", "Akl"}],
              "}"}], "=", 
            RowBox[{"{", 
             RowBox[{
             "Etmp", ",", "ansatztmp", ",", "\[Theta]varstmp", ",", 
              "Akltmp"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", "\[Theta]vars", 
          ",", "\[Psi]\[Theta]k"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "ndeleted"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.814625401717328*^9, 3.814625446891323*^9}, 
   3.8146256876669693`*^9, {3.81462582137939*^9, 3.814625854163455*^9}, {
   3.814625984705573*^9, 3.814625996423587*^9}, {3.814626082531973*^9, 
   3.814626152977729*^9}, {3.814626235507041*^9, 3.8146262663431673`*^9}, {
   3.814626299601633*^9, 3.814626325626844*^9}, {3.814626400094364*^9, 
   3.814626504525085*^9}, {3.814626567643441*^9, 3.814626569428136*^9}, {
   3.8146267695657263`*^9, 3.8146267867722883`*^9}, {3.814626909513071*^9, 
   3.8146269111800547`*^9}, {3.8146269432003803`*^9, 3.814627031807969*^9}, {
   3.8146271133571053`*^9, 3.814627138525979*^9}, {3.814627191421818*^9, 
   3.814627199488515*^9}, {3.816418183448379*^9, 3.816418203941787*^9}, {
   3.8166020396348963`*^9, 3.8166020448634653`*^9}, {3.8166021004805517`*^9, 
   3.8166021063290653`*^9}, 3.817240247292697*^9, 3.817242602536433*^9, {
   3.818156945630951*^9, 3.818156963859968*^9}, {3.8181569976143293`*^9, 
   3.818157047923284*^9}, {3.818157085122682*^9, 3.818157119534636*^9}, {
   3.818157155141369*^9, 3.818157170439097*^9}, {3.8181572034173594`*^9, 
   3.8181572091689243`*^9}, {3.818157252130282*^9, 3.818157253488187*^9}, {
   3.8181574559202023`*^9, 3.818157484358222*^9}, {3.818158067140606*^9, 
   3.81815806739879*^9}, {3.818158563373598*^9, 3.8181585885497007`*^9}, {
   3.818158622963929*^9, 3.818158649769579*^9}, {3.818158877489049*^9, 
   3.8181588818052387`*^9}, {3.81815907168884*^9, 3.81815907414386*^9}, {
   3.8181591579206257`*^9, 3.8181591814223137`*^9}, {3.8181599071859694`*^9, 
   3.818159944685104*^9}, {3.818161045236074*^9, 3.818161072395187*^9}, 
   3.818162052558401*^9, {3.8206109907180233`*^9, 3.8206110109465103`*^9}, {
   3.820611082156858*^9, 3.820611126257339*^9}, {3.820611156422447*^9, 
   3.8206112372863894`*^9}, 3.820860941681532*^9, {3.821312236924632*^9, 
   3.82131223857237*^9}, {3.8213122688343277`*^9, 3.821312546310802*^9}, {
   3.821312833954472*^9, 3.821312834301046*^9}, {3.8213129411614923`*^9, 
   3.8213129498580236`*^9}, {3.821313064316935*^9, 3.821313120810412*^9}, 
   3.821313237979547*^9, {3.8213132916814613`*^9, 3.8213133115240717`*^9}, {
   3.8213133539230757`*^9, 3.8213134017117558`*^9}, {3.821313450973591*^9, 
   3.821313478847687*^9}, 3.821313839374649*^9, {3.821313901888309*^9, 
   3.821313908780403*^9}, {3.821348051270648*^9, 3.8213481030555363`*^9}, {
   3.821348540124776*^9, 3.82134854168216*^9}, {3.8213493746145372`*^9, 
   3.821349435708458*^9}, {3.82134958021994*^9, 3.821349597383424*^9}, {
   3.821388565827778*^9, 3.8213885996785088`*^9}, {3.821468714854248*^9, 
   3.821468720793191*^9}, {3.821469104638229*^9, 3.821469105825389*^9}, {
   3.8214691374179783`*^9, 3.8214691559763937`*^9}, {3.821469293210689*^9, 
   3.82146931680345*^9}, {3.82147120841574*^9, 3.821471227971657*^9}, {
   3.822495824430335*^9, 3.822495853339047*^9}, {3.822501738419286*^9, 
   3.822501739212965*^9}, {3.822766909258829*^9, 3.822766912120673*^9}, 
   3.822770115355764*^9, {3.822778827870205*^9, 3.822778832567041*^9}, 
   3.822779296886806*^9, {3.8227798132615633`*^9, 3.8227798200974607`*^9}, {
   3.822779891995303*^9, 3.822779892838263*^9}, {3.822809288069591*^9, 
   3.822809301004508*^9}, {3.82302548775063*^9, 3.823025495879426*^9}, {
   3.823239414280648*^9, 3.823239438490094*^9}, {3.8236891299052677`*^9, 
   3.823689211674184*^9}, {3.823689241912602*^9, 3.823689362518811*^9}, {
   3.823689515205307*^9, 3.823689518129836*^9}, {3.8236956451064587`*^9, 
   3.823695645529294*^9}, {3.823722757916781*^9, 3.8237227605923223`*^9}, {
   3.8237556656655083`*^9, 3.823755668141013*^9}, {3.8237684335582438`*^9, 
   3.823768437866798*^9}, {3.823769799746559*^9, 3.823769806412963*^9}, {
   3.824299205721349*^9, 3.824299212699555*^9}, {3.8250159581353073`*^9, 
   3.82501596621891*^9}, {3.825016086603675*^9, 3.825016179222293*^9}, {
   3.825016242569632*^9, 3.825016243784006*^9}, 3.825016289385313*^9, {
   3.825016438479776*^9, 3.825016460227023*^9}, {3.8257852137931013`*^9, 
   3.825785300488895*^9}, {3.825785652800502*^9, 3.825785653907363*^9}, {
   3.82578829203911*^9, 3.825788327473733*^9}, {3.8262732416172237`*^9, 
   3.826273271559205*^9}, {3.8262735159743958`*^9, 3.826273618940392*^9}, {
   3.826273657743318*^9, 3.826273667889223*^9}, {3.826273758345233*^9, 
   3.8262737599528313`*^9}, {3.826274066757605*^9, 3.826274071006632*^9}, {
   3.826274161400309*^9, 3.8262741753335867`*^9}, {3.826274415954707*^9, 
   3.826274419662492*^9}, {3.826721617355906*^9, 3.8267216513864403`*^9}, {
   3.8267217532010717`*^9, 3.8267217738128433`*^9}, {3.826721947810789*^9, 
   3.826721966283895*^9}, {3.8267220336429663`*^9, 3.826722035899356*^9}, 
   3.8267223461706142`*^9, {3.826724898218008*^9, 3.826724903197337*^9}, {
   3.826724964746746*^9, 3.826724965410581*^9}, {3.826745855350292*^9, 
   3.826745879816429*^9}, {3.8267459157203903`*^9, 3.8267459263928843`*^9}, {
   3.850662125907984*^9, 3.850662163187035*^9}, {3.859539912315865*^9, 
   3.859539995553218*^9}, {3.8595400263699102`*^9, 3.8595401294512568`*^9}, {
   3.859547319700272*^9, 3.8595473345040073`*^9}, {3.859919395893609*^9, 
   3.859919396613947*^9}, {3.8646299058513002`*^9, 3.8646299157106256`*^9}, {
   3.864629951033297*^9, 3.864630004761462*^9}, {3.864630117684491*^9, 
   3.864630305414836*^9}, {3.864710223145467*^9, 3.8647102295983467`*^9}, {
   3.8647114537796707`*^9, 3.86471145717397*^9}, {3.864719914742524*^9, 
   3.864720003007978*^9}, {3.8647201153878717`*^9, 3.864720144681793*^9}},
 CellLabel->
  "In[647]:=",ExpressionUUID->"2a594bd0-0978-4fd6-b405-5ec85cf1f3b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Main module: variational algorithm to search ground state energy\
\>", "Subsection",
 CellChangeTimes->{{3.8211291780732937`*^9, 3.821129199186705*^9}, {
   3.821195903481749*^9, 3.821195911170946*^9}, {3.821212480633562*^9, 
   3.8212124813518047`*^9}, 3.821215055886223*^9, {3.821296015066798*^9, 
   3.821296037531743*^9}, {3.82619648719241*^9, 3.826196491027482*^9}, {
   3.8267415806678247`*^9, 
   3.826741598656948*^9}},ExpressionUUID->"1af26ec8-4c38-4db5-bca3-\
f6e12e176a33"],

Cell[CellGroupData[{

Cell["Helpers on the main module", "Subsubsection",
 CellChangeTimes->{{3.834002638156713*^9, 3.834002641497817*^9}, {
  3.842250942187319*^9, 
  3.842250948823566*^9}},ExpressionUUID->"3c80c594-5095-4734-ac81-\
0f7130826f4b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Wrap", "::", "usage"}], "=", 
  "\"\<Wrap[list,anzatz,angle,enerhy,sidx,hash___]. Wrap data into a list of \
association.\>\""}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"Wrap", ",", " ", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Wrap", "[", 
    RowBox[{
    "list_", ",", "anz_", ",", "ang_", ",", "en_", ",", "sidx_", ",", 
     "hash___"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{
        RowBox[{
        "list", "\[LeftDoubleBracket]", "\"\<ansatz\>\"", 
         "\[RightDoubleBracket]"}], ",", "anz"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{
        RowBox[{
        "list", "\[LeftDoubleBracket]", "\"\<\[Theta]vars\>\"", 
         "\[RightDoubleBracket]"}], ",", "ang"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{
        RowBox[{
        "list", "\[LeftDoubleBracket]", "\"\<E\>\"", 
         "\[RightDoubleBracket]"}], ",", "en"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{
        RowBox[{
        "list", "\[LeftDoubleBracket]", "\"\<idx\>\"", 
         "\[RightDoubleBracket]"}], ",", "sidx"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"{", "hash", "}"}]}], ">", "0"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{
          "list", "\[LeftDoubleBracket]", "\"\<hash\>\"", 
           "\[RightDoubleBracket]"}], ",", "hash"}], "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.818866287921228*^9, 3.8188663140557137`*^9}, {
   3.818866575974663*^9, 3.818866648239793*^9}, {3.8188670744982977`*^9, 
   3.818867152250988*^9}, {3.818867200589505*^9, 3.818867228315877*^9}, {
   3.818867261268505*^9, 3.818867310841958*^9}, {3.818867412061289*^9, 
   3.8188674352239122`*^9}, {3.8188701924683523`*^9, 3.818870194973802*^9}, {
   3.818870998207262*^9, 3.8188710337586517`*^9}, {3.818871103548115*^9, 
   3.818871158311137*^9}, {3.818871227439344*^9, 3.818871335822884*^9}, 
   3.818872287333638*^9, {3.8188723759070787`*^9, 3.8188724258011227`*^9}, {
   3.8188731424401827`*^9, 3.818873193180937*^9}, {3.818873348718049*^9, 
   3.8188733571051188`*^9}, {3.818873398346096*^9, 3.8188734505259323`*^9}, {
   3.818873501510907*^9, 3.81887350452388*^9}, {3.81887359397013*^9, 
   3.818873596455492*^9}, {3.8188736770847607`*^9, 3.8188737174598227`*^9}, {
   3.818873790431275*^9, 3.818873816235731*^9}, {3.8188741510670156`*^9, 
   3.8188741815042753`*^9}, 3.8188742399605227`*^9, {3.818874286267984*^9, 
   3.818874418553134*^9}, {3.8188746986185417`*^9, 3.818874708657123*^9}, {
   3.8188747770184813`*^9, 3.8188747915809593`*^9}, {3.8188749205223*^9, 
   3.818874922227586*^9}, {3.8188749752050056`*^9, 3.818874984745612*^9}, {
   3.81887502890228*^9, 3.818875108506709*^9}, {3.818875162766426*^9, 
   3.818875225020604*^9}, {3.818875573664316*^9, 3.81887560710938*^9}, 
   3.818875664465044*^9, {3.81887572239074*^9, 3.81887573016*^9}, 
   3.818876084111815*^9, 3.818876433356715*^9, {3.818877293916646*^9, 
   3.818877305970224*^9}, 3.81887736245986*^9, {3.818877402508409*^9, 
   3.818877407325633*^9}, 3.818879244266343*^9, 3.818879360430743*^9, {
   3.818880592870439*^9, 3.818880615343904*^9}, {3.818880659626103*^9, 
   3.818880660552343*^9}, {3.818880691239297*^9, 3.818880694424903*^9}, {
   3.818882106544149*^9, 3.818882121653351*^9}, {3.8189170516502237`*^9, 
   3.8189170815230227`*^9}, {3.818917133382832*^9, 3.818917136731306*^9}, {
   3.8189171728720837`*^9, 3.818917179146432*^9}, {3.8189172583607597`*^9, 
   3.8189172607788563`*^9}, {3.818917311712109*^9, 3.818917335045802*^9}, {
   3.818926079256941*^9, 3.818926089597844*^9}, 3.818926119835464*^9, 
   3.818926425523337*^9, {3.818926510697173*^9, 3.818926519936573*^9}, {
   3.818926683394518*^9, 3.8189266850290117`*^9}, {3.818955661902564*^9, 
   3.818955691530938*^9}, {3.818955874329213*^9, 3.818955882965692*^9}, {
   3.818955919336141*^9, 3.818955923732958*^9}, {3.8189561078218403`*^9, 
   3.8189561243454103`*^9}, {3.8193909679889917`*^9, 3.819391018267992*^9}, 
   3.819391116109713*^9, {3.819391559553643*^9, 3.819391569179887*^9}, {
   3.819391646844598*^9, 3.8193916798262672`*^9}, {3.819391739504209*^9, 
   3.819391890912654*^9}, {3.8193919596750727`*^9, 3.819392014097406*^9}, {
   3.8193924868019238`*^9, 3.819392559762495*^9}, {3.819392603600933*^9, 
   3.8193926575613527`*^9}, {3.819393440227944*^9, 3.819393462290761*^9}, {
   3.819393499139077*^9, 3.819393661368264*^9}, {3.819393712003207*^9, 
   3.819393744156272*^9}, {3.819393878413639*^9, 3.819393881924361*^9}, {
   3.819394461392626*^9, 3.819394462982039*^9}, 3.819394642297099*^9, {
   3.819394827050008*^9, 3.819394828106442*^9}, {3.819394916925037*^9, 
   3.8193949480408287`*^9}, {3.8193949872971*^9, 3.8193950239344788`*^9}, {
   3.819395091964692*^9, 3.819395102064604*^9}, {3.819395167801991*^9, 
   3.8193951690305357`*^9}, {3.819395219104999*^9, 3.8193952284400673`*^9}, 
   3.819395404948539*^9, {3.819401872095833*^9, 3.819401980129465*^9}, {
   3.81940202343583*^9, 3.819402025185506*^9}, {3.8194020645473824`*^9, 
   3.819402066879384*^9}, {3.819402210759691*^9, 3.819402235597225*^9}, {
   3.819553586851602*^9, 3.819553591227137*^9}, {3.8195536918041487`*^9, 
   3.819553696561182*^9}, {3.819553758617455*^9, 3.8195537777421083`*^9}, {
   3.819554121406694*^9, 3.819554125353599*^9}, {3.819554161732629*^9, 
   3.819554217878686*^9}, {3.8195542681378098`*^9, 3.8195542692702837`*^9}, {
   3.819554335539914*^9, 3.8195543359112463`*^9}, {3.8195544711348877`*^9, 
   3.819554507103991*^9}, {3.819554559031498*^9, 3.81955456226606*^9}, {
   3.8195545956723557`*^9, 3.8195546322983828`*^9}, {3.819554845434408*^9, 
   3.819554862238633*^9}, {3.819554916635543*^9, 3.81955491834554*^9}, {
   3.8195549841703653`*^9, 3.8195550011021643`*^9}, {3.819555257433923*^9, 
   3.819555303548311*^9}, {3.819555350676914*^9, 3.81955536901775*^9}, {
   3.819555671689234*^9, 3.819555694171774*^9}, {3.8195557574878674`*^9, 
   3.8195557743722057`*^9}, {3.81955586748739*^9, 3.819555875630522*^9}, {
   3.819560515694871*^9, 3.819560545389743*^9}, {3.81956073043884*^9, 
   3.819560747964654*^9}, 3.8195609547492228`*^9, {3.8195610326335907`*^9, 
   3.819561053143077*^9}, {3.8195674533778353`*^9, 3.819567455393042*^9}, {
   3.8195677929368277`*^9, 3.819567820356502*^9}, {3.819567880664818*^9, 
   3.819568062318151*^9}, {3.819568217022625*^9, 3.8195682208455*^9}, {
   3.8195682742967663`*^9, 3.8195682792115*^9}, {3.8195683220617228`*^9, 
   3.819568332589957*^9}, {3.819568420723235*^9, 3.819568421024331*^9}, {
   3.819568459512689*^9, 3.819568461807551*^9}, {3.8195685785799217`*^9, 
   3.819568591579054*^9}, {3.8195686817966137`*^9, 3.8195687157218723`*^9}, {
   3.819568879404698*^9, 3.819568898214569*^9}, {3.819569008015148*^9, 
   3.819569041157958*^9}, {3.819570274880694*^9, 3.819570324768648*^9}, {
   3.819570962072603*^9, 3.819570996539019*^9}, {3.819571232769334*^9, 
   3.819571233164475*^9}, {3.8195712910322104`*^9, 3.8195713498391333`*^9}, 
   3.819571391527132*^9, {3.819571502933503*^9, 3.819571504394182*^9}, {
   3.819571546276125*^9, 3.819571551144763*^9}, {3.819571597643058*^9, 
   3.81957169679986*^9}, {3.819571757990137*^9, 3.819571776355434*^9}, {
   3.8195718313825207`*^9, 3.819571859213915*^9}, {3.819572073497835*^9, 
   3.819572073730277*^9}, {3.81964948026033*^9, 3.819649480771555*^9}, {
   3.81964953357681*^9, 3.8196497289821577`*^9}, 3.819649767038073*^9, {
   3.819709850700037*^9, 3.819709944035659*^9}, {3.8197102819718227`*^9, 
   3.819710285803028*^9}, {3.819710318828063*^9, 3.8197103363409367`*^9}, {
   3.8197119803955183`*^9, 3.819712002908939*^9}, {3.819723171364749*^9, 
   3.819723206109026*^9}, {3.819723366083579*^9, 3.8197233896159983`*^9}, {
   3.819742091358584*^9, 3.81974209378832*^9}, {3.819742292070632*^9, 
   3.819742300682663*^9}, {3.819743258827222*^9, 3.819743296574046*^9}, {
   3.819743722777205*^9, 3.8197437297187243`*^9}, {3.819744086475174*^9, 
   3.8197440921487417`*^9}, 3.819746024990107*^9, {3.819746181684264*^9, 
   3.819746184764452*^9}, {3.819746264739743*^9, 3.8197462804052134`*^9}, {
   3.819746311078678*^9, 3.8197463775141563`*^9}, {3.819747051492834*^9, 
   3.8197470675176697`*^9}, {3.819797349979104*^9, 3.819797355862179*^9}, {
   3.819803292612711*^9, 3.819803293124357*^9}, {3.819803472956588*^9, 
   3.819803486982148*^9}, {3.819805211506311*^9, 3.819805214126045*^9}, {
   3.819810677477332*^9, 3.81981072303204*^9}, {3.819817524564794*^9, 
   3.819817525457752*^9}, {3.819824038007053*^9, 3.819824058022175*^9}, {
   3.819824161973277*^9, 3.819824255748413*^9}, {3.8198267647185307`*^9, 
   3.819826832111703*^9}, 3.819826889648903*^9, {3.819826943947857*^9, 
   3.819826983122044*^9}, {3.819827377128633*^9, 3.819827395926682*^9}, {
   3.81996143472357*^9, 3.8199615286639633`*^9}, {3.819969341331847*^9, 
   3.819969373217997*^9}, {3.819969941643612*^9, 3.8199699584936333`*^9}, {
   3.819970153097768*^9, 3.819970154955284*^9}, {3.819970261182241*^9, 
   3.819970300221805*^9}, {3.819970396153428*^9, 3.819970464006187*^9}, {
   3.819971630504047*^9, 3.8199716707746353`*^9}, {3.819971767888167*^9, 
   3.819971791590424*^9}, {3.819971841895686*^9, 3.8199718924462147`*^9}, {
   3.819971987826953*^9, 3.819971999436442*^9}, {3.819972088871257*^9, 
   3.8199721031743603`*^9}, {3.819972222631919*^9, 3.81997223889299*^9}, {
   3.819972313374263*^9, 3.819972313748651*^9}, {3.819972349362974*^9, 
   3.819972359848256*^9}, {3.819972432775403*^9, 3.8199724358485937`*^9}, {
   3.8199760105151577`*^9, 3.819976016281046*^9}, {3.819976054044271*^9, 
   3.819976054454946*^9}, {3.819976088844688*^9, 3.819976107136426*^9}, {
   3.819976577791712*^9, 3.8199765904016953`*^9}, {3.819976649305393*^9, 
   3.819976683883194*^9}, {3.819976792647922*^9, 3.819976833864482*^9}, {
   3.819976953075706*^9, 3.819977040651984*^9}, {3.819977127017582*^9, 
   3.819977135666451*^9}, {3.819977177167165*^9, 3.819977177669558*^9}, {
   3.819986921838306*^9, 3.819986934787175*^9}, {3.819986974781537*^9, 
   3.819986977650029*^9}, {3.819987954711483*^9, 3.819987961312277*^9}, {
   3.8199880073269043`*^9, 3.819988022377234*^9}, {3.819988054557279*^9, 
   3.819988061389592*^9}, {3.8199881499872503`*^9, 3.819988151420936*^9}, {
   3.819988387838752*^9, 3.819988407112506*^9}, {3.8199884801440277`*^9, 
   3.819988506872271*^9}, {3.819988556062029*^9, 3.8199885740096283`*^9}, {
   3.8199886281054287`*^9, 3.81998869627435*^9}, {3.819992489374123*^9, 
   3.819992575446435*^9}, {3.819992627063746*^9, 3.819992638569723*^9}, {
   3.81999268609724*^9, 3.819992688388595*^9}, 3.819992913263031*^9, {
   3.819992947428372*^9, 3.819992957186817*^9}, {3.8199929951447268`*^9, 
   3.8199929953245373`*^9}, {3.819993035040683*^9, 3.8199930588973837`*^9}, {
   3.819993090017098*^9, 3.819993165261135*^9}, {3.819993204179722*^9, 
   3.819993219566553*^9}, {3.819993253656888*^9, 3.819993275966042*^9}, {
   3.8199933189062357`*^9, 3.819993320163829*^9}, {3.819993364326722*^9, 
   3.819993386851536*^9}, 3.819993720746009*^9, 3.819993843997958*^9, 
   3.819993899081534*^9, {3.819994472005495*^9, 3.819994491815077*^9}, {
   3.819994524573369*^9, 3.8199945733787527`*^9}, {3.819994733571168*^9, 
   3.8199947347952423`*^9}, {3.819994767565198*^9, 3.81999477058569*^9}, {
   3.819994827628729*^9, 3.8199948530025187`*^9}, {3.819996782407942*^9, 
   3.819996794601184*^9}, {3.8199976998812647`*^9, 3.81999771922515*^9}, {
   3.819999225527914*^9, 3.81999923796824*^9}, {3.819999296952132*^9, 
   3.819999304139573*^9}, {3.819999363645115*^9, 3.819999383180387*^9}, {
   3.819999427882913*^9, 3.81999956249102*^9}, {3.819999601690683*^9, 
   3.819999668855338*^9}, {3.8199998232673883`*^9, 3.819999824379253*^9}, {
   3.820010168537346*^9, 3.820010170804882*^9}, {3.820010268988675*^9, 
   3.82001028960452*^9}, {3.8200104898507233`*^9, 3.8200105242260523`*^9}, 
   3.82001073785631*^9, {3.82001078649981*^9, 3.8200107915797977`*^9}, 
   3.8200112856128263`*^9, {3.820012367854807*^9, 3.820012384271949*^9}, {
   3.820012436119089*^9, 3.8200124718628483`*^9}, {3.82001250997339*^9, 
   3.820012631797308*^9}, {3.820012978834777*^9, 3.8200129975523148`*^9}, {
   3.820049166965352*^9, 3.8200491689376383`*^9}, {3.820049219895555*^9, 
   3.820049220179744*^9}, {3.820049262822587*^9, 3.820049277221941*^9}, {
   3.820049312574778*^9, 3.82004937836446*^9}, {3.8200494116508017`*^9, 
   3.8200494819556932`*^9}, 3.8200499578429613`*^9, {3.820059802213065*^9, 
   3.820059804272683*^9}, 3.820062220023485*^9, {3.82006591293987*^9, 
   3.820065913562911*^9}, {3.820066173259623*^9, 3.820066180632056*^9}, {
   3.820067111642008*^9, 3.8200671201834173`*^9}, {3.8200672250331497`*^9, 
   3.820067226069477*^9}, {3.820067469136869*^9, 3.820067469804323*^9}, {
   3.820071333775763*^9, 3.8200713895106707`*^9}, {3.8200719376261377`*^9, 
   3.8200719385297318`*^9}, {3.820072431852887*^9, 3.820072432079934*^9}, {
   3.820072712106257*^9, 3.820072833510849*^9}, 3.8200728751691723`*^9, {
   3.820072909376789*^9, 3.820073026851015*^9}, {3.820073298324997*^9, 
   3.82007332157653*^9}, {3.820073378476408*^9, 3.8200734182103243`*^9}, {
   3.820073513486022*^9, 3.820073516630824*^9}, {3.8200738344106894`*^9, 
   3.820073863262355*^9}, {3.820074266288629*^9, 3.82007431992045*^9}, {
   3.820074513211343*^9, 3.820074513384281*^9}, 3.8200748024002123`*^9, {
   3.8200873518047457`*^9, 3.820087416761249*^9}, {3.82008951499931*^9, 
   3.820089540418273*^9}, {3.8200895947017384`*^9, 3.820089614154523*^9}, {
   3.820089671692054*^9, 3.820089673892886*^9}, {3.820089719050879*^9, 
   3.8200897441459427`*^9}, {3.8200904581892357`*^9, 3.820090459044827*^9}, {
   3.820091315463111*^9, 3.820091322292919*^9}, 3.820091469545169*^9, 
   3.820093198424789*^9, {3.8200939535240498`*^9, 3.820093972010573*^9}, {
   3.820094030193304*^9, 3.820094054093375*^9}, 3.820094448447814*^9, {
   3.820094481689445*^9, 3.8200945441050053`*^9}, {3.820094870728079*^9, 
   3.820094877495183*^9}, {3.820097336490657*^9, 3.820097356191868*^9}, {
   3.820136520811891*^9, 3.8201365219485893`*^9}, {3.8206075301482153`*^9, 
   3.8206075464883957`*^9}, {3.820607581422956*^9, 3.820607601490286*^9}, {
   3.820607674849818*^9, 3.820607697283613*^9}, {3.820607745343998*^9, 
   3.8206079496519337`*^9}, {3.82060804112807*^9, 3.820608045466106*^9}, {
   3.820608092417728*^9, 3.820608093066251*^9}, {3.82060824829823*^9, 
   3.820608249446787*^9}, {3.820608349676696*^9, 3.820608379292495*^9}, {
   3.820608924781824*^9, 3.820608959477351*^9}, {3.82060902456024*^9, 
   3.820609039159127*^9}, {3.820609071226432*^9, 3.8206090776164703`*^9}, {
   3.820609283875512*^9, 3.8206093128955107`*^9}, {3.820609357623508*^9, 
   3.820609360179284*^9}, {3.820610642332692*^9, 3.8206107826885853`*^9}, {
   3.820610951499569*^9, 3.820610959018318*^9}, {3.820611377658018*^9, 
   3.820611421318903*^9}, {3.8206114810420237`*^9, 3.820611515421133*^9}, {
   3.8206115558282843`*^9, 3.82061162084688*^9}, {3.8206122991263103`*^9, 
   3.82061233440326*^9}, {3.820612365181838*^9, 3.820612365385119*^9}, {
   3.820612424500498*^9, 3.8206124363119917`*^9}, {3.820612522774241*^9, 
   3.820612565376505*^9}, {3.820659161005834*^9, 3.8206591939564962`*^9}, {
   3.820659732767171*^9, 3.8206597422694902`*^9}, 3.820660484284917*^9, {
   3.8206605745720367`*^9, 3.820660582621502*^9}, {3.820660758793024*^9, 
   3.820660762455966*^9}, {3.820660794987753*^9, 3.820660886927802*^9}, {
   3.82066352465137*^9, 3.820663527727417*^9}, {3.82066596489529*^9, 
   3.820666066586047*^9}, {3.82066610007231*^9, 3.82066610881735*^9}, {
   3.820833805280356*^9, 3.8208339650848627`*^9}, {3.821122010728652*^9, 
   3.8211220264705353`*^9}, 3.821124154366797*^9, {3.821124356517684*^9, 
   3.821124357300346*^9}, {3.8211275788907547`*^9, 3.82112763513624*^9}, {
   3.82112766582898*^9, 3.82112781057786*^9}, {3.82112820796926*^9, 
   3.821128279400498*^9}, {3.8211283209642467`*^9, 3.821128387326363*^9}, {
   3.821128425821052*^9, 3.821128457102881*^9}, 3.821128541803335*^9, {
   3.821128657526388*^9, 3.821128667881559*^9}, {3.8211287062094803`*^9, 
   3.8211287249022408`*^9}, {3.821129137145784*^9, 3.821129148342705*^9}, {
   3.821129229935437*^9, 3.8211292584976873`*^9}, {3.821129380601261*^9, 
   3.821129395243441*^9}, 3.821129430240035*^9, {3.821129486522436*^9, 
   3.8211295312215557`*^9}, {3.821129561299498*^9, 3.821129594860487*^9}, {
   3.821129657256343*^9, 3.82112976365768*^9}, {3.8211298365569963`*^9, 
   3.821129837309475*^9}, {3.821129969234624*^9, 3.821130052524543*^9}, {
   3.821130085117359*^9, 3.8211300971028013`*^9}, {3.82113013620393*^9, 
   3.8211301445177307`*^9}, {3.821130176326377*^9, 3.821130268453106*^9}, {
   3.8211303002809887`*^9, 3.8211303647682123`*^9}, 3.82113090008134*^9, {
   3.821130943121834*^9, 3.821131069347308*^9}, {3.82113144486274*^9, 
   3.821131488804543*^9}, {3.821131834665324*^9, 3.821131900996973*^9}, {
   3.821131951732009*^9, 3.821132038842537*^9}, {3.8211848701824083`*^9, 
   3.8211849542926493`*^9}, {3.821185000962985*^9, 3.821185078496471*^9}, {
   3.821187272744545*^9, 3.8211874969043713`*^9}, {3.82118754094534*^9, 
   3.821187707976972*^9}, {3.821187799759693*^9, 3.8211878084552097`*^9}, {
   3.8211878446692867`*^9, 3.821188068060307*^9}, {3.821188208401092*^9, 
   3.821188416552636*^9}, {3.82119433000629*^9, 3.8211943382578*^9}, {
   3.8211944811932783`*^9, 3.8211944815904903`*^9}, {3.821194756544829*^9, 
   3.8211947592688017`*^9}, {3.821194931031188*^9, 3.821194931769824*^9}, {
   3.821194965430608*^9, 3.821194965900391*^9}, {3.821195368835568*^9, 
   3.821195419290152*^9}, {3.821195516407692*^9, 3.821195521785398*^9}, {
   3.821196606966716*^9, 3.821196612016527*^9}, {3.821196705619318*^9, 
   3.821196710357307*^9}, {3.8211967674059057`*^9, 3.821196813466477*^9}, {
   3.821196847628788*^9, 3.821196868949353*^9}, {3.821197596726575*^9, 
   3.821197657829494*^9}, {3.8211977608812428`*^9, 3.82119781183997*^9}, {
   3.821197864936767*^9, 3.821197871718173*^9}, {3.821200612658639*^9, 
   3.82120061439258*^9}, {3.821200745085747*^9, 3.8212007599386587`*^9}, {
   3.821200868902589*^9, 3.8212008873916187`*^9}, {3.821201247257762*^9, 
   3.821201266641203*^9}, {3.82120203719709*^9, 3.8212020426675043`*^9}, {
   3.821209386632599*^9, 3.821209391824791*^9}, {3.821209585957405*^9, 
   3.821209601457108*^9}, {3.8212161646451*^9, 3.821216166587555*^9}, {
   3.8212161968835487`*^9, 3.821216257128007*^9}, {3.821216528015358*^9, 
   3.821216557115815*^9}, {3.8212165919581633`*^9, 3.821216596094174*^9}, {
   3.821216945166044*^9, 3.8212171678832283`*^9}, {3.821217261434848*^9, 
   3.821217283134863*^9}, {3.821217347334414*^9, 3.821217384288114*^9}, {
   3.821217470804976*^9, 3.821217561343589*^9}, {3.821217597950925*^9, 
   3.821217616098445*^9}, {3.821217655808989*^9, 3.821217686672483*^9}, {
   3.82121777407229*^9, 3.8212178582614727`*^9}, {3.821218036812937*^9, 
   3.821218049582981*^9}, {3.821218182412271*^9, 3.821218227953095*^9}, {
   3.8212198796073313`*^9, 3.8212199346226187`*^9}, {3.8212200626414213`*^9, 
   3.821220063304222*^9}, {3.8212201227815647`*^9, 3.8212201282868643`*^9}, {
   3.821221067736166*^9, 3.8212210799561853`*^9}, {3.8212211138165083`*^9, 
   3.82122113660783*^9}, {3.821221182473605*^9, 3.821221272055347*^9}, {
   3.821221304055291*^9, 3.821221325040956*^9}, {3.8212213655941133`*^9, 
   3.821221541938322*^9}, {3.82122159930582*^9, 3.821221863313319*^9}, {
   3.821221938065214*^9, 3.8212219941189613`*^9}, {3.821222134158554*^9, 
   3.821222154595945*^9}, {3.821222185195661*^9, 3.821222327696171*^9}, {
   3.82122236825688*^9, 3.821222441047573*^9}, {3.821223421023363*^9, 
   3.821223439663389*^9}, {3.821223542760787*^9, 3.821223554733227*^9}, {
   3.821223591012896*^9, 3.821223658328154*^9}, {3.821223714464036*^9, 
   3.821223715130138*^9}, {3.8212237950693827`*^9, 3.8212238432790956`*^9}, {
   3.821224231919643*^9, 3.821224354163538*^9}, {3.821224406077053*^9, 
   3.8212244097046137`*^9}, {3.821224564683652*^9, 3.821224600934463*^9}, {
   3.8212246346478977`*^9, 3.821224635021944*^9}, {3.821227420119029*^9, 
   3.8212274241193457`*^9}, {3.821227477760648*^9, 3.821227493568203*^9}, {
   3.821227554295033*^9, 3.821227562800791*^9}, 3.821227637232562*^9, {
   3.8212278010380983`*^9, 3.82122789320231*^9}, {3.821261236990369*^9, 
   3.8212612608162603`*^9}, {3.821261740376658*^9, 3.821262071889949*^9}, {
   3.8212621161020813`*^9, 3.821262228556889*^9}, {3.8212629745070257`*^9, 
   3.821262992896188*^9}, {3.821264143764081*^9, 3.821264156038476*^9}, 
   3.821264214893214*^9, {3.8212642804864492`*^9, 3.821264286309307*^9}, {
   3.821264321848085*^9, 3.821264357202257*^9}, {3.8212644478760347`*^9, 
   3.821264574048313*^9}, {3.821264613585269*^9, 3.821264661706429*^9}, {
   3.821265068672647*^9, 3.821265088644855*^9}, {3.821265149127448*^9, 
   3.8212651543083477`*^9}, {3.8212652332633743`*^9, 
   3.8212653184569283`*^9}, {3.821265414826612*^9, 3.821265439873767*^9}, {
   3.821265489847663*^9, 3.8212654932046757`*^9}, {3.821265810135874*^9, 
   3.821265878187722*^9}, {3.8212659146098003`*^9, 3.8212659155630407`*^9}, 
   3.8212660010281773`*^9, {3.821266054873212*^9, 3.821266060561119*^9}, {
   3.82126613101959*^9, 3.821266142996983*^9}, 3.82126642691606*^9, {
   3.8212679122722*^9, 3.821267986617318*^9}, {3.821268036997354*^9, 
   3.8212680761416187`*^9}, {3.821268185992482*^9, 3.821268187294711*^9}, {
   3.8212685371565228`*^9, 3.821268538361739*^9}, {3.821268658614972*^9, 
   3.821268661614833*^9}, {3.821268705481553*^9, 3.821268713594935*^9}, {
   3.821268764281197*^9, 3.821268779378072*^9}, {3.821268819712728*^9, 
   3.821268914210305*^9}, {3.821268947322609*^9, 3.821268949393333*^9}, 
   3.821269044078899*^9, 3.82126912348355*^9, {3.821269219747789*^9, 
   3.82126933937423*^9}, {3.821269419083293*^9, 3.8212694795759697`*^9}, {
   3.821269577754085*^9, 3.821269578326968*^9}, {3.821269609720419*^9, 
   3.821269614069309*^9}, {3.821269653148682*^9, 3.8212696774068604`*^9}, {
   3.821269816226457*^9, 3.821269818715887*^9}, {3.821269928509913*^9, 
   3.8212699339312143`*^9}, {3.821269964531761*^9, 3.821270060150895*^9}, {
   3.8212724050856028`*^9, 3.821272414651284*^9}, {3.821272448888019*^9, 
   3.821272549007023*^9}, {3.8212725817514553`*^9, 3.821272626210601*^9}, {
   3.821272676423147*^9, 3.821272732393672*^9}, {3.821272772301591*^9, 
   3.821272773279352*^9}, {3.821273187024054*^9, 3.821273229434766*^9}, {
   3.82127331490965*^9, 3.821273395633395*^9}, {3.8212734652921467`*^9, 
   3.821273471234672*^9}, {3.821273768562337*^9, 3.82127382750369*^9}, 
   3.821273861997954*^9, {3.821273895840191*^9, 3.82127391418955*^9}, {
   3.82127402645044*^9, 3.821274042742909*^9}, 3.8212741220686626`*^9, {
   3.82127416834162*^9, 3.821274177334524*^9}, 3.8212742520225782`*^9, {
   3.8212743541677*^9, 3.821274524182185*^9}, {3.8212745550272913`*^9, 
   3.821274644176609*^9}, {3.821274698151808*^9, 3.821274717359995*^9}, {
   3.82127474893106*^9, 3.82127478184665*^9}, {3.82127484205441*^9, 
   3.821274867449926*^9}, {3.821274940813719*^9, 3.821274964954795*^9}, {
   3.8212750654028997`*^9, 3.821275153944785*^9}, {3.821275229604425*^9, 
   3.821275262448886*^9}, {3.821275329035904*^9, 3.8212753355546*^9}, {
   3.821276181838584*^9, 3.82127620245711*^9}, {3.821276267694469*^9, 
   3.821276271662166*^9}, {3.8212763193652067`*^9, 3.821276349314687*^9}, 
   3.82127680964371*^9, {3.821282897135269*^9, 3.821282920320649*^9}, {
   3.821283026984234*^9, 3.821283033966434*^9}, {3.821283096009275*^9, 
   3.821283136432934*^9}, {3.821283416913643*^9, 3.8212834183772297`*^9}, 
   3.821283603953611*^9, {3.821283655792665*^9, 3.82128369834205*^9}, {
   3.8212837331836147`*^9, 3.8212837721511707`*^9}, {3.821283815599806*^9, 
   3.821283818680378*^9}, {3.821283874845172*^9, 3.821283876446282*^9}, {
   3.8212840949690742`*^9, 3.821284133118472*^9}, {3.821284185332635*^9, 
   3.82128419124864*^9}, {3.821284443552239*^9, 3.821284463652624*^9}, 
   3.821284579438877*^9, {3.821287456829337*^9, 3.8212874579482803`*^9}, {
   3.8212916035104723`*^9, 3.821291603517788*^9}, {3.82129287483219*^9, 
   3.821293015329802*^9}, {3.821293056699943*^9, 3.821293076828205*^9}, {
   3.821293110935425*^9, 3.8212931117670918`*^9}, {3.821293297489931*^9, 
   3.821293345016012*^9}, {3.821293559939165*^9, 3.821293630088441*^9}, {
   3.821293743768235*^9, 3.821293784457389*^9}, {3.821295989022957*^9, 
   3.821296005727099*^9}, {3.821296040753105*^9, 3.821296052825935*^9}, {
   3.821296816620264*^9, 3.821296833164948*^9}, {3.82129689163618*^9, 
   3.821296893250825*^9}, 3.821296942545229*^9, {3.8212970629538307`*^9, 
   3.821297063561677*^9}, {3.821297125484908*^9, 3.8212972250468597`*^9}, {
   3.821297257756974*^9, 3.8212972612546253`*^9}, {3.821297360048441*^9, 
   3.8212974204044333`*^9}, {3.821297998852425*^9, 3.821298006744246*^9}, {
   3.821298070673156*^9, 3.821298108066259*^9}, {3.821298139406314*^9, 
   3.821298149459693*^9}, {3.821298199254601*^9, 3.82129820489573*^9}, {
   3.82129829619151*^9, 3.821298527315621*^9}, {3.8212985620039787`*^9, 
   3.821298582728402*^9}, {3.821298631817883*^9, 3.821298707827221*^9}, {
   3.821298835674768*^9, 3.8212988617735653`*^9}, {3.821298903404996*^9, 
   3.82129899665864*^9}, {3.82129958077637*^9, 3.8212995831171703`*^9}, {
   3.821299911224635*^9, 3.8212999148472557`*^9}, {3.821299953486836*^9, 
   3.821300082676332*^9}, {3.821300866935461*^9, 3.8213008942742167`*^9}, {
   3.821300926763515*^9, 3.8213013876909246`*^9}, {3.821301428459004*^9, 
   3.821301454090321*^9}, {3.8213014933629932`*^9, 3.8213015282488947`*^9}, {
   3.821301575810773*^9, 3.821301704915208*^9}, {3.821301808790608*^9, 
   3.8213018562066813`*^9}, {3.8213018880076857`*^9, 3.821302023118408*^9}, {
   3.821302056601639*^9, 3.821302227690563*^9}, {3.8213022645622683`*^9, 
   3.821302297591414*^9}, 3.8213023917000732`*^9, {3.821302428165948*^9, 
   3.821302442838017*^9}, 3.82130249546624*^9, 3.821302561882245*^9, {
   3.821303063886011*^9, 3.8213030784132843`*^9}, {3.821303209022142*^9, 
   3.821303220239223*^9}, {3.8213034720230503`*^9, 3.821303496121009*^9}, {
   3.8213035269700727`*^9, 3.821303557652623*^9}, {3.821303663301279*^9, 
   3.821303931379837*^9}, {3.8213040071612463`*^9, 3.821304014455976*^9}, {
   3.821304128120364*^9, 3.821304130009131*^9}, {3.821304224911669*^9, 
   3.821304251077248*^9}, {3.8213042975371647`*^9, 3.8213043292959433`*^9}, {
   3.821304386980904*^9, 3.821304483118184*^9}, 3.821304615308427*^9, {
   3.821304732118332*^9, 3.8213047347123137`*^9}, {3.821304772567112*^9, 
   3.82130477462681*^9}, {3.821304811132599*^9, 3.821304843520625*^9}, {
   3.821305055603788*^9, 3.8213051230566177`*^9}, {3.821305206311763*^9, 
   3.8213052609350863`*^9}, {3.821305317225381*^9, 3.821305388932836*^9}, {
   3.8213054192135143`*^9, 3.821305421845995*^9}, {3.8213054792664623`*^9, 
   3.8213055068593407`*^9}, {3.821305739827751*^9, 3.821305748608198*^9}, {
   3.821306586412912*^9, 3.821306708323601*^9}, {3.8213082217348948`*^9, 
   3.821308338190336*^9}, {3.8213084038167887`*^9, 3.821308412378953*^9}, 
   3.8213084728019342`*^9, {3.821308571696631*^9, 3.821308584741302*^9}, {
   3.821308619144186*^9, 3.821308631798534*^9}, {3.821309574182665*^9, 
   3.8213095932103148`*^9}, {3.821309651267852*^9, 3.821309675186376*^9}, {
   3.821311921837966*^9, 3.821311994356707*^9}, {3.821312585688675*^9, 
   3.821312651647381*^9}, 3.821313529771957*^9, {3.8213136421308737`*^9, 
   3.8213136513470917`*^9}, {3.821313694051917*^9, 3.821313702248212*^9}, {
   3.821313895922311*^9, 3.8213138966196823`*^9}, 3.821313999139977*^9, {
   3.8213141423017282`*^9, 3.8213142440462513`*^9}, {3.821314300501019*^9, 
   3.8213143677282867`*^9}, {3.8213144663288193`*^9, 3.821314491754677*^9}, {
   3.821314699784984*^9, 3.821314714765152*^9}, {3.82131482338798*^9, 
   3.821314923331943*^9}, {3.8213149618260403`*^9, 3.82131496365723*^9}, {
   3.82134812417072*^9, 3.8213481698862457`*^9}, {3.821348304768733*^9, 
   3.821348346848481*^9}, {3.8213483772228127`*^9, 3.821348380026485*^9}, {
   3.821349307096912*^9, 3.821349339383326*^9}, {3.821349470977804*^9, 
   3.821349473112247*^9}, {3.821349516998012*^9, 3.821349519151144*^9}, {
   3.821349825278638*^9, 3.821349907550544*^9}, {3.821349999591516*^9, 
   3.8213500073133287`*^9}, {3.821350045219281*^9, 3.821350077199432*^9}, {
   3.821350685157487*^9, 3.821350688181204*^9}, {3.821350746976807*^9, 
   3.821350811316869*^9}, {3.8213510992595453`*^9, 3.821351116570788*^9}, 
   3.82135123445889*^9, {3.821351314756735*^9, 3.821351323859559*^9}, {
   3.821351399025517*^9, 3.821351404440699*^9}, {3.821351449275771*^9, 
   3.821351457460388*^9}, {3.8213518609402323`*^9, 3.821351914690716*^9}, {
   3.821351975644431*^9, 3.821352005268046*^9}, {3.821352040444201*^9, 
   3.821352092215302*^9}, {3.82135215002495*^9, 3.821352198041027*^9}, 
   3.821352424478066*^9, {3.821352512601671*^9, 3.821352564140283*^9}, {
   3.821352661577017*^9, 3.8213527052161427`*^9}, {3.821352808457418*^9, 
   3.8213528090526743`*^9}, {3.821352888067348*^9, 3.821352891076695*^9}, {
   3.82135294608025*^9, 3.82135300981994*^9}, {3.821353084621985*^9, 
   3.821353102093987*^9}, 3.8213531702603903`*^9, {3.82135326681555*^9, 
   3.821353268207623*^9}, {3.8213533874624157`*^9, 3.821353465046639*^9}, {
   3.8213552838729*^9, 3.821355369345817*^9}, {3.821355425302647*^9, 
   3.82135550395056*^9}, {3.821355578012484*^9, 3.8213556207661743`*^9}, {
   3.821355677627329*^9, 3.821355766360051*^9}, {3.8213558572150173`*^9, 
   3.821355953061573*^9}, {3.821356002551182*^9, 3.821356012077899*^9}, {
   3.821356163637109*^9, 3.821356179621828*^9}, {3.8213562596594763`*^9, 
   3.821356265817161*^9}, 3.821356310255755*^9, {3.821357128919455*^9, 
   3.821357192127597*^9}, {3.821357370577284*^9, 3.8213573738123837`*^9}, {
   3.8213574645737762`*^9, 3.821357475129385*^9}, {3.821357579789654*^9, 
   3.821357587181787*^9}, {3.821357631337631*^9, 3.821357688337285*^9}, {
   3.821357874586816*^9, 3.821357877479006*^9}, 3.8213579336175423`*^9, {
   3.82135825759336*^9, 3.8213582878359613`*^9}, {3.821358557014818*^9, 
   3.821358582590629*^9}, {3.821358801003833*^9, 3.821358807200369*^9}, {
   3.8213591710498247`*^9, 3.8213593030913153`*^9}, {3.8213593486547728`*^9, 
   3.821359361851672*^9}, {3.821360284392695*^9, 3.821360346492249*^9}, {
   3.821360496274392*^9, 3.82136054550391*^9}, {3.8213606116314*^9, 
   3.8213606808460627`*^9}, {3.821360735154413*^9, 3.821360842606464*^9}, {
   3.8213608809264603`*^9, 3.8213608955049057`*^9}, {3.821361230100338*^9, 
   3.821361251756864*^9}, {3.821361394702981*^9, 3.821361403641611*^9}, {
   3.821361541711258*^9, 3.8213615419683332`*^9}, 3.82138771271845*^9, {
   3.8213879117218323`*^9, 3.821387963684429*^9}, {3.821388144301093*^9, 
   3.821388151067185*^9}, {3.821388455472539*^9, 3.8213885281311827`*^9}, {
   3.821393468021667*^9, 3.821393551180838*^9}, {3.8214281588948812`*^9, 
   3.82142816716772*^9}, {3.821428219497097*^9, 3.8214282280716267`*^9}, 
   3.821428258524569*^9, {3.821442304621564*^9, 3.8214423185687*^9}, {
   3.821442693180031*^9, 3.821442728187347*^9}, {3.8214427632262487`*^9, 
   3.821442785034444*^9}, {3.8214428274141817`*^9, 3.821442829157868*^9}, {
   3.821442924957192*^9, 3.82144294768073*^9}, 3.8214429826952467`*^9, 
   3.82144304138881*^9, 3.821443094576693*^9, {3.8214438956847887`*^9, 
   3.821443904607499*^9}, {3.821443977412806*^9, 3.821444061841948*^9}, 
   3.821444106203004*^9, {3.8214442386208153`*^9, 3.821444302195853*^9}, {
   3.821444406468622*^9, 3.8214444457395678`*^9}, {3.8214444794881973`*^9, 
   3.821444621626652*^9}, {3.8214447528221827`*^9, 3.8214447568942833`*^9}, {
   3.821465371242161*^9, 3.821465372585243*^9}, {3.821467884889452*^9, 
   3.821467887895997*^9}, {3.821471994180271*^9, 3.821472095823008*^9}, {
   3.821543712225903*^9, 3.821543742353993*^9}, {3.8215440950179033`*^9, 
   3.821544102500771*^9}, {3.82182132762143*^9, 3.821821329753318*^9}, {
   3.821822574661985*^9, 3.8218226135232773`*^9}, {3.821867441050082*^9, 
   3.82186748811136*^9}, {3.821867543007115*^9, 3.821867544344965*^9}, 
   3.82199081433885*^9, {3.821990854571039*^9, 3.8219909876176453`*^9}, {
   3.8219911200360327`*^9, 3.8219911709504013`*^9}, {3.821991212721281*^9, 
   3.821991244110292*^9}, {3.822494993225131*^9, 3.8224950930028067`*^9}, {
   3.822495234816004*^9, 3.8224952520328712`*^9}, {3.822495615841545*^9, 
   3.822495618385828*^9}, {3.822495659105051*^9, 3.822495680784758*^9}, {
   3.822501697462603*^9, 3.8225017076615*^9}, {3.8225039352801657`*^9, 
   3.822503951643959*^9}, {3.822503985393251*^9, 3.8225040417684*^9}, {
   3.822504175062481*^9, 3.8225041873897753`*^9}, {3.8225044390331078`*^9, 
   3.8225044490780573`*^9}, {3.822505771655344*^9, 3.822505781673216*^9}, {
   3.8225058707107983`*^9, 3.8225058769209642`*^9}, {3.822505909596119*^9, 
   3.8225059794115458`*^9}, {3.8225068310603437`*^9, 3.822506852699492*^9}, {
   3.822507598812133*^9, 3.822507613104855*^9}, {3.822507649122655*^9, 
   3.822507660711089*^9}, 3.8225084660761833`*^9, {3.822512722835878*^9, 
   3.822512782458479*^9}, {3.822515190222703*^9, 3.822515213229698*^9}, {
   3.822515404232964*^9, 3.822515407440556*^9}, {3.822515467599269*^9, 
   3.822515481132218*^9}, {3.822515539402232*^9, 3.822515555425499*^9}, {
   3.822515606565649*^9, 3.822515606873128*^9}, {3.822515683677041*^9, 
   3.822515690424334*^9}, {3.822516080478683*^9, 3.822516178384655*^9}, {
   3.822516211735436*^9, 3.822516225537395*^9}, {3.8225162598180037`*^9, 
   3.822516263387796*^9}, {3.822516452520186*^9, 3.822516520204048*^9}, {
   3.82258615898289*^9, 3.822586190842078*^9}, {3.822587044102384*^9, 
   3.822587064796838*^9}, {3.8225874140323772`*^9, 3.8225874157492867`*^9}, {
   3.822588047110244*^9, 3.822588052559721*^9}, {3.822588589006619*^9, 
   3.822588590580694*^9}, {3.822588628061152*^9, 3.8225886293837214`*^9}, {
   3.822589668461637*^9, 3.822589688045102*^9}, {3.822592007630946*^9, 
   3.822592031012388*^9}, {3.822592072853959*^9, 3.822592113572423*^9}, {
   3.822592388668066*^9, 3.822592389854203*^9}, {3.8225924219496613`*^9, 
   3.822592449924629*^9}, {3.822592534186542*^9, 3.8225925618613997`*^9}, {
   3.8225925982153883`*^9, 3.822592640418906*^9}, {3.822592718303212*^9, 
   3.82259273442292*^9}, {3.822593353105991*^9, 3.822593476978498*^9}, {
   3.8225935095327053`*^9, 3.822593652270907*^9}, {3.82276525327619*^9, 
   3.822765255293849*^9}, {3.822765392953226*^9, 3.8227654392720537`*^9}, {
   3.822765478983107*^9, 3.822765566691134*^9}, {3.822765634130836*^9, 
   3.822765635538004*^9}, {3.822765690763732*^9, 3.822765942232153*^9}, {
   3.822765991861195*^9, 3.8227660480450783`*^9}, {3.822766096943234*^9, 
   3.822766098920226*^9}, {3.8227661641123047`*^9, 3.8227662305822783`*^9}, {
   3.822766288550149*^9, 3.8227662888719788`*^9}, {3.8227663899957047`*^9, 
   3.822766504886735*^9}, {3.822766597983417*^9, 3.822766598351125*^9}, {
   3.822766628826849*^9, 3.822766637027532*^9}, {3.8227667237421837`*^9, 
   3.822766742408332*^9}, {3.822767042854466*^9, 3.82276711844909*^9}, {
   3.8227671490925093`*^9, 3.8227671659508*^9}, {3.82276722067552*^9, 
   3.822767244972528*^9}, 3.8227672762319937`*^9, {3.822767331925885*^9, 
   3.822767342641914*^9}, {3.82276755416739*^9, 3.822767554628374*^9}, {
   3.8227678567278357`*^9, 3.822767884465043*^9}, {3.822767975950966*^9, 
   3.822768199950789*^9}, {3.822768236541779*^9, 3.822768244748053*^9}, {
   3.82276836273488*^9, 3.8227684449537973`*^9}, {3.822768477344377*^9, 
   3.8227685021865473`*^9}, {3.822768569152307*^9, 3.8227686574780693`*^9}, {
   3.8227687099823637`*^9, 3.822768714251721*^9}, {3.8227687543849773`*^9, 
   3.822768765290518*^9}, {3.822768965915378*^9, 3.822769103583025*^9}, {
   3.822769178709004*^9, 3.8227692817877913`*^9}, {3.822769389502707*^9, 
   3.8227693910444813`*^9}, {3.8227694250471067`*^9, 
   3.8227694574464397`*^9}, {3.822769615534672*^9, 3.822769642971756*^9}, {
   3.822769678043614*^9, 3.822769680182529*^9}, {3.8227697325734367`*^9, 
   3.8227697643887987`*^9}, {3.822769798625085*^9, 3.8227698011922493`*^9}, {
   3.822769864353509*^9, 3.822769872730103*^9}, {3.822769924676528*^9, 
   3.822769925686647*^9}, {3.822770220125217*^9, 3.822770227295835*^9}, {
   3.82277039369071*^9, 3.822770396011196*^9}, {3.8227705438541927`*^9, 
   3.8227705506596727`*^9}, {3.82277063129852*^9, 3.822770634645866*^9}, {
   3.822770734215023*^9, 3.822770735880397*^9}, {3.8227708004876432`*^9, 
   3.822770810731697*^9}, {3.8227708728357267`*^9, 3.8227708738360043`*^9}, {
   3.822770911551949*^9, 3.822770912305571*^9}, {3.822770943710021*^9, 
   3.822770944351471*^9}, {3.8227710770771933`*^9, 3.822771078443231*^9}, {
   3.822771220210421*^9, 3.822771222320072*^9}, {3.822771372092721*^9, 
   3.822771373034087*^9}, {3.822772324980081*^9, 3.8227723620768023`*^9}, {
   3.82277259217983*^9, 3.822772623603525*^9}, {3.822773465685968*^9, 
   3.82277346806444*^9}, {3.822773544378991*^9, 3.822773566650971*^9}, {
   3.822773647547339*^9, 3.822773651188512*^9}, {3.822773728726441*^9, 
   3.8227737494626083`*^9}, {3.822773784073443*^9, 3.8227738841949778`*^9}, {
   3.82277404609307*^9, 3.822774308284463*^9}, {3.8227743775776043`*^9, 
   3.822774435278317*^9}, {3.822774512621724*^9, 3.822774513891156*^9}, {
   3.822774770114532*^9, 3.8227747703941383`*^9}, {3.822775898202375*^9, 
   3.822775899474823*^9}, {3.822776293180382*^9, 3.822776294158725*^9}, {
   3.822776371264763*^9, 3.822776399217691*^9}, {3.822776546732705*^9, 
   3.822776564217957*^9}, {3.82277663552491*^9, 3.822776661414197*^9}, {
   3.822776725647094*^9, 3.822776726898096*^9}, {3.822777411473275*^9, 
   3.822777414378894*^9}, {3.8227774532577877`*^9, 3.822777457096243*^9}, {
   3.822780653982757*^9, 3.822780752658444*^9}, {3.8227808037370367`*^9, 
   3.822780834383005*^9}, {3.822781032961485*^9, 3.8227810487452803`*^9}, {
   3.8227810865331697`*^9, 3.8227811132056828`*^9}, {3.822781170320176*^9, 
   3.8227811782517157`*^9}, {3.822786380523683*^9, 3.822786380796595*^9}, {
   3.822807292326948*^9, 3.822807371915476*^9}, {3.822807528659994*^9, 
   3.822807529612527*^9}, {3.822810935714233*^9, 3.822811020859233*^9}, {
   3.822811115299499*^9, 3.822811136567137*^9}, {3.822811292877494*^9, 
   3.822811403225095*^9}, {3.822811447903882*^9, 3.8228114487596397`*^9}, {
   3.8228115784231443`*^9, 3.822811593892089*^9}, {3.822811647037387*^9, 
   3.82281187269582*^9}, {3.822811911302072*^9, 3.8228119724637527`*^9}, {
   3.822812035462675*^9, 3.822812327751745*^9}, {3.822812660971586*^9, 
   3.822813018503661*^9}, {3.822813068407493*^9, 3.82281312202595*^9}, {
   3.82281322245079*^9, 3.8228133234193563`*^9}, {3.822813549986919*^9, 
   3.822813551804182*^9}, {3.8228136896234913`*^9, 3.822813696228263*^9}, {
   3.822813978918117*^9, 3.822813995065452*^9}, {3.822818244623843*^9, 
   3.822818246243166*^9}, {3.822824833363448*^9, 3.822824836626668*^9}, {
   3.822825067909801*^9, 3.822825068813911*^9}, {3.822825119543256*^9, 
   3.822825126889475*^9}, {3.822826378113462*^9, 3.822826438189413*^9}, {
   3.822826604997801*^9, 3.822826635881621*^9}, {3.822826897327634*^9, 
   3.822826912351396*^9}, {3.822827075438588*^9, 3.8228270773488894`*^9}, {
   3.822828107546652*^9, 3.822828348305471*^9}, {3.822828430719534*^9, 
   3.822828451439538*^9}, {3.822828702623497*^9, 3.8228287572377777`*^9}, {
   3.822828873723413*^9, 3.8228289778340282`*^9}, {3.822829053307859*^9, 
   3.822829061532229*^9}, {3.822829475923417*^9, 3.822829498730929*^9}, {
   3.822829847786668*^9, 3.8228299388528748`*^9}, {3.8228305052879963`*^9, 
   3.8228305082409983`*^9}, {3.822830654722733*^9, 3.822830696041337*^9}, {
   3.822830892649048*^9, 3.822830896536841*^9}, {3.822831010234757*^9, 
   3.822831035406107*^9}, {3.822831510102559*^9, 3.8228315105205717`*^9}, {
   3.8228319436931953`*^9, 3.822831952833459*^9}, {3.822832127321341*^9, 
   3.822832170178246*^9}, {3.822832200329175*^9, 3.822832228924795*^9}, {
   3.822832618094421*^9, 3.8228326818884*^9}, {3.822832719070854*^9, 
   3.82283278148923*^9}, {3.822832855415099*^9, 3.822832907008849*^9}, {
   3.822832975354504*^9, 3.822833108404776*^9}, {3.822833153860446*^9, 
   3.8228333328666477`*^9}, {3.822833389416542*^9, 3.822833389555606*^9}, {
   3.8228335392548437`*^9, 3.822833568475313*^9}, {3.8228336751849613`*^9, 
   3.822833675631822*^9}, {3.8228337445100927`*^9, 3.8228337446529617`*^9}, {
   3.8228337885216017`*^9, 3.822833940430197*^9}, {3.8228340824961033`*^9, 
   3.822834084447257*^9}, {3.822834279480749*^9, 3.822834281059432*^9}, {
   3.8228344837975073`*^9, 3.8228345320451202`*^9}, {3.822834618976022*^9, 
   3.822834639980318*^9}, {3.822834899273677*^9, 3.82283490929919*^9}, {
   3.8228350047484503`*^9, 3.8228350468688517`*^9}, {3.822835081148922*^9, 
   3.822835086856118*^9}, {3.822835117576354*^9, 3.8228351528587303`*^9}, {
   3.8228353614453382`*^9, 3.8228354307814074`*^9}, {3.8228357167238913`*^9, 
   3.822835739607747*^9}, {3.822836270246211*^9, 3.822836276044056*^9}, {
   3.8228366306218557`*^9, 3.822836673418763*^9}, {3.822837932053529*^9, 
   3.822837957798931*^9}, {3.822838195370408*^9, 3.8228381958749943`*^9}, {
   3.822838233212042*^9, 3.8228382798874273`*^9}, {3.82283832596813*^9, 
   3.8228384422869053`*^9}, {3.8228384766063147`*^9, 3.822838480468131*^9}, {
   3.8228389023712273`*^9, 3.8228389950290127`*^9}, {3.8228392214044037`*^9, 
   3.822839225079582*^9}, {3.8228394608348303`*^9, 3.8228395037029676`*^9}, {
   3.822839534559169*^9, 3.822839617453252*^9}, {3.822839698682331*^9, 
   3.822839724068959*^9}, 3.822850146074215*^9, {3.822851603713711*^9, 
   3.822851604781577*^9}, {3.82285163506266*^9, 3.822851637615608*^9}, {
   3.822858248204705*^9, 3.822858256081233*^9}, {3.8228583211661797`*^9, 
   3.8228583252021933`*^9}, 3.822858886791008*^9, {3.822859734159089*^9, 
   3.822859750926794*^9}, {3.822860077876883*^9, 3.822860079043867*^9}, {
   3.822860223695606*^9, 3.822860229953556*^9}, {3.822861735456339*^9, 
   3.8228617695612707`*^9}, {3.8234201142328863`*^9, 3.823420116534828*^9}, {
   3.8234202959007063`*^9, 3.823420419255557*^9}, 3.8234215780034513`*^9, 
   3.823439359210102*^9, 3.8234394256015587`*^9, {3.823439571011128*^9, 
   3.823439603146224*^9}, {3.8234397679096937`*^9, 3.823439768701622*^9}, {
   3.823445711988881*^9, 3.82344571220826*^9}, 3.823528602098598*^9, {
   3.823529190517065*^9, 3.8235291908447866`*^9}, {3.823532524148479*^9, 
   3.823532617946772*^9}, {3.823532739198613*^9, 3.823532786694042*^9}, {
   3.8235328329185133`*^9, 3.823532841032249*^9}, 3.823534490532179*^9, {
   3.8235345420656757`*^9, 3.823534542391657*^9}, {3.823534806279792*^9, 
   3.823534855104854*^9}, {3.823534980588543*^9, 3.8235349927926064`*^9}, {
   3.823535067098454*^9, 3.8235350896994743`*^9}, {3.823535142015245*^9, 
   3.823535210550267*^9}, {3.823535693614765*^9, 3.8235357309302063`*^9}, 
   3.82353591960604*^9, {3.8235367601068983`*^9, 3.823536903666932*^9}, {
   3.823549947241047*^9, 3.823550021747134*^9}, {3.823550058485005*^9, 
   3.8235500713815813`*^9}, {3.8235501469810047`*^9, 
   3.8235501868204203`*^9}, {3.82355021917388*^9, 3.823550335743696*^9}, {
   3.823550380202187*^9, 3.823550388476039*^9}, {3.823550503993421*^9, 
   3.8235506472002487`*^9}, {3.82355094339145*^9, 3.8235509490611134`*^9}, {
   3.823551044524177*^9, 3.823551084140901*^9}, {3.823551121047875*^9, 
   3.823551128038656*^9}, {3.823551158498344*^9, 3.823551160362502*^9}, {
   3.823551194751533*^9, 3.823551405062641*^9}, {3.823551493188328*^9, 
   3.823551495909911*^9}, {3.8235515286699533`*^9, 3.823551681048366*^9}, {
   3.823551745577896*^9, 3.823551750540395*^9}, {3.8235518046681643`*^9, 
   3.82355187730337*^9}, {3.823552018763588*^9, 3.823552041263732*^9}, {
   3.823552089139554*^9, 3.8235521001460533`*^9}, {3.82355214176514*^9, 
   3.823552156659446*^9}, {3.823552250236888*^9, 3.823552266748666*^9}, {
   3.823552414589753*^9, 3.8235524398298883`*^9}, {3.8235525427326937`*^9, 
   3.8235526131660833`*^9}, {3.823552667555132*^9, 3.82355266901045*^9}, {
   3.823583313840302*^9, 3.8235833170226717`*^9}, {3.823583795124588*^9, 
   3.8235837998742533`*^9}, {3.823584955460669*^9, 3.823584956387795*^9}, {
   3.823585030646481*^9, 3.823585043592183*^9}, {3.82358516658811*^9, 
   3.823585168367907*^9}, {3.8235856677280607`*^9, 3.823585668444004*^9}, {
   3.823585702203719*^9, 3.823585794500784*^9}, {3.823586130571974*^9, 
   3.8235861345335913`*^9}, {3.8235861697365522`*^9, 3.823586316474668*^9}, {
   3.823586977000691*^9, 3.823587143427211*^9}, 3.8235871775804787`*^9, {
   3.823588193757373*^9, 3.823588377355896*^9}, {3.823588688060123*^9, 
   3.823588988344674*^9}, {3.823589025638957*^9, 3.823589057099394*^9}, {
   3.823589094631966*^9, 3.823589181808312*^9}, {3.8235892329753647`*^9, 
   3.823589277074695*^9}, {3.823589312466261*^9, 3.823589313488977*^9}, 
   3.823590086553472*^9, {3.823590989410645*^9, 3.8235912012893047`*^9}, {
   3.8235912713011293`*^9, 3.823591278251439*^9}, {3.823591416081067*^9, 
   3.823591472110351*^9}, {3.8235919674000807`*^9, 3.823592016243621*^9}, {
   3.823592088963039*^9, 3.8235921890365458`*^9}, {3.82359375568327*^9, 
   3.823594086948016*^9}, 3.823594262121002*^9, {3.823594530255805*^9, 
   3.823594533830085*^9}, {3.8235945754163*^9, 3.823594609735675*^9}, 
   3.823594662067377*^9, {3.823595322452907*^9, 3.8235953307636013`*^9}, {
   3.823595625851141*^9, 3.823595731377769*^9}, {3.823597518771435*^9, 
   3.8235975258230457`*^9}, {3.823597744206455*^9, 3.823597762570114*^9}, {
   3.823599628719244*^9, 3.823599783860278*^9}, {3.82359982645783*^9, 
   3.823599843157984*^9}, {3.823599885273264*^9, 3.823599888456986*^9}, {
   3.823601042952463*^9, 3.82360109260222*^9}, {3.823601127683498*^9, 
   3.823601128346681*^9}, {3.823601414610077*^9, 3.823601419061632*^9}, {
   3.823601497758299*^9, 3.8236014986109324`*^9}, 3.823604625200027*^9, 
   3.823604716366366*^9, {3.823604812483136*^9, 3.82360481906561*^9}, 
   3.823604853163741*^9, {3.823604990999295*^9, 3.823605025033395*^9}, {
   3.823605313250412*^9, 3.823605363912342*^9}, 3.823606079404675*^9, {
   3.823609264123804*^9, 3.823609373291404*^9}, {3.823610453431542*^9, 
   3.823610520429449*^9}, {3.8236111824019403`*^9, 3.8236112269252863`*^9}, {
   3.82361192469341*^9, 3.8236119250035543`*^9}, {3.823613849541223*^9, 
   3.8236138526859694`*^9}, {3.823613882957337*^9, 3.82361389924866*^9}, {
   3.8236139358092947`*^9, 3.82361399126153*^9}, {3.8236142201058483`*^9, 
   3.8236142219686604`*^9}, {3.823614415821213*^9, 3.823614419856247*^9}, {
   3.8236144535000963`*^9, 3.823614495808261*^9}, {3.8236146126213903`*^9, 
   3.823614623631727*^9}, {3.823616558748362*^9, 3.823616564333705*^9}, {
   3.823616613205838*^9, 3.823616613503994*^9}, {3.823621391154076*^9, 
   3.823621397879694*^9}, {3.82363307047762*^9, 3.823633099546299*^9}, {
   3.823633178590507*^9, 3.8236331822813253`*^9}, {3.823633226462573*^9, 
   3.823633227721933*^9}, {3.8236343816840143`*^9, 3.823634381844029*^9}, {
   3.8236414558123713`*^9, 3.823641479112693*^9}, {3.823670304495624*^9, 
   3.823670321274777*^9}, {3.8236703750484333`*^9, 3.823670378335526*^9}, {
   3.823684265294132*^9, 3.823684318309147*^9}, {3.8236907462047977`*^9, 
   3.823690765023693*^9}, {3.823695011472039*^9, 3.823695044502091*^9}, {
   3.823697246781299*^9, 3.8236972648541594`*^9}, {3.823697304468512*^9, 
   3.8236973551884727`*^9}, {3.823697495508532*^9, 3.8236975143772793`*^9}, {
   3.82371077612574*^9, 3.823710779031505*^9}, {3.823710816969275*^9, 
   3.823710843755125*^9}, {3.823711162437264*^9, 3.8237112249400806`*^9}, {
   3.8237112583187*^9, 3.8237112624347677`*^9}, {3.82371132132176*^9, 
   3.8237114816192102`*^9}, {3.823711721830717*^9, 3.823711749229286*^9}, {
   3.823711800624652*^9, 3.823711834066428*^9}, {3.823711937445529*^9, 
   3.8237119580463543`*^9}, {3.823712052837397*^9, 3.823712081049726*^9}, {
   3.823713575695407*^9, 3.823713577351568*^9}, {3.8237141967582283`*^9, 
   3.823714239793366*^9}, {3.823716209086113*^9, 3.8237162428518248`*^9}, {
   3.823716766563403*^9, 3.823716773840096*^9}, {3.823716809616623*^9, 
   3.8237168315193253`*^9}, {3.823717453016507*^9, 3.823717453621161*^9}, {
   3.8237174863788443`*^9, 3.823717489430715*^9}, {3.8237186913741007`*^9, 
   3.823718697426566*^9}, {3.8237230920443563`*^9, 3.823723105257889*^9}, {
   3.823725093655446*^9, 3.8237251079551973`*^9}, {3.823725333412766*^9, 
   3.823725341694599*^9}, {3.823751948506546*^9, 3.823751951671986*^9}, {
   3.823752779074217*^9, 3.8237528071378727`*^9}, {3.82375283911469*^9, 
   3.823752864136467*^9}, {3.823753404879815*^9, 3.8237534074533463`*^9}, 
   3.823754335899004*^9, {3.823756031917647*^9, 3.823756038125533*^9}, {
   3.823756945021174*^9, 3.8237569458018713`*^9}, {3.82375704973342*^9, 
   3.823757050592787*^9}, {3.823768495754774*^9, 3.823768504422738*^9}, {
   3.823770567899536*^9, 3.823770668324643*^9}, {3.8237709989798403`*^9, 
   3.823771000212308*^9}, {3.823771341246592*^9, 3.823771347732224*^9}, {
   3.8237714071871843`*^9, 3.823771415265832*^9}, {3.823779515901339*^9, 
   3.823779801118269*^9}, {3.8237806249935102`*^9, 3.823780644442745*^9}, {
   3.823788013380501*^9, 3.8237880340513773`*^9}, {3.823940299964137*^9, 
   3.82394030009993*^9}, {3.823943013758355*^9, 3.8239430489228287`*^9}, {
   3.823943141468729*^9, 3.823943148953133*^9}, {3.8239432453301086`*^9, 
   3.823943284828331*^9}, 3.823943520202198*^9, {3.8239451044003468`*^9, 
   3.823945107899839*^9}, {3.823953610163478*^9, 3.8239536163478947`*^9}, {
   3.8239539068149567`*^9, 3.8239539099165077`*^9}, {3.8239546966011972`*^9, 
   3.82395471246767*^9}, {3.8240455370156803`*^9, 3.8240455464411917`*^9}, {
   3.8240455793292427`*^9, 3.824045581726969*^9}, 3.824045621233227*^9, {
   3.824045674793413*^9, 3.82404571904592*^9}, {3.8240457650120573`*^9, 
   3.824045777589467*^9}, {3.824045885525251*^9, 3.824045907596431*^9}, {
   3.824046056140748*^9, 3.8240460791967297`*^9}, {3.8240464124232197`*^9, 
   3.82404644271762*^9}, {3.824052759736142*^9, 3.824052760488967*^9}, {
   3.824052821102157*^9, 3.824052832225107*^9}, {3.824056746689221*^9, 
   3.8240567473349257`*^9}, {3.824056886936778*^9, 3.824056887066123*^9}, {
   3.824056939808653*^9, 3.8240569956151648`*^9}, {3.82406028566057*^9, 
   3.824060318180421*^9}, {3.824060429351767*^9, 3.824060430882636*^9}, {
   3.824060616341539*^9, 3.824060625510305*^9}, {3.824064064015003*^9, 
   3.824064065601905*^9}, {3.8240641511933002`*^9, 3.824064162014756*^9}, {
   3.824064201539193*^9, 3.82406425216083*^9}, 3.8240643249580107`*^9, {
   3.8240647894261703`*^9, 3.8240649040255537`*^9}, {3.824065035403655*^9, 
   3.824065140094378*^9}, {3.824065175655686*^9, 3.824065209038598*^9}, {
   3.824115458225988*^9, 3.824115507935285*^9}, {3.824124959230843*^9, 
   3.8241249673172817`*^9}, {3.8241276731701183`*^9, 3.824127697382465*^9}, {
   3.824129822414916*^9, 3.824129830944118*^9}, {3.824129893302397*^9, 
   3.824129914483831*^9}, {3.82413044394466*^9, 3.824130452417828*^9}, 
   3.824131530961121*^9, {3.824134345283375*^9, 3.824134388683681*^9}, {
   3.82413490953441*^9, 3.824135158362446*^9}, {3.8241351917700043`*^9, 
   3.824135237535748*^9}, {3.824135273513978*^9, 3.824135321577793*^9}, {
   3.82413819751128*^9, 3.824138205515108*^9}, {3.824138237955942*^9, 
   3.824138241242322*^9}, {3.824139575163011*^9, 3.824139609113576*^9}, {
   3.8241417865138702`*^9, 3.824142147913919*^9}, 3.824142848529324*^9, {
   3.824188166658251*^9, 3.824188166971436*^9}, {3.824188612592845*^9, 
   3.824188617904533*^9}, {3.824193642276539*^9, 3.824193642766398*^9}, {
   3.824195621161024*^9, 3.8241956212857323`*^9}, {3.824196652159816*^9, 
   3.824196744942978*^9}, {3.8241977272346697`*^9, 3.824197752481512*^9}, {
   3.824198501450794*^9, 3.824198568390031*^9}, {3.824200863055756*^9, 
   3.824200872214259*^9}, {3.824210108544971*^9, 3.824210126101013*^9}, 
   3.824212263528141*^9, {3.8242142984526567`*^9, 3.824214318266594*^9}, {
   3.8242202667719584`*^9, 3.824220268065528*^9}, {3.8242205083477297`*^9, 
   3.824220522208424*^9}, {3.824223900400037*^9, 3.824223900972487*^9}, {
   3.824294966128542*^9, 3.824295060307137*^9}, {3.824295096461597*^9, 
   3.824295101805642*^9}, {3.824295153252967*^9, 3.8242951587275753`*^9}, {
   3.824295207692618*^9, 3.824295236618284*^9}, {3.824296061712043*^9, 
   3.824296091066305*^9}, {3.824296328159781*^9, 3.824296336986953*^9}, {
   3.8242963755841618`*^9, 3.824296384145405*^9}, {3.8242985693838663`*^9, 
   3.824298574184946*^9}, {3.824298848405962*^9, 3.824298867168269*^9}, {
   3.824299242639201*^9, 3.824299243459223*^9}, {3.824299453365321*^9, 
   3.8242994655608892`*^9}, {3.8242995042933397`*^9, 
   3.8242995110406427`*^9}, {3.8242997606260033`*^9, 3.824299764220682*^9}, {
   3.8243005573528643`*^9, 3.82430055881691*^9}, {3.824300611111121*^9, 
   3.8243006128446836`*^9}, {3.8243006950803127`*^9, 
   3.8243007329161654`*^9}, {3.824300935748876*^9, 3.824300978553939*^9}, {
   3.824301157157516*^9, 3.824301159081505*^9}, {3.824301220531694*^9, 
   3.8243012258766813`*^9}, {3.824302070628528*^9, 3.824302081461019*^9}, {
   3.824302365326556*^9, 3.824302464646496*^9}, {3.824302543982318*^9, 
   3.824302555306704*^9}, {3.8243027797171926`*^9, 3.824302783559651*^9}, {
   3.8243036244157248`*^9, 3.824303640360798*^9}, {3.824303705337516*^9, 
   3.824303744933778*^9}, {3.824303836096053*^9, 3.824303885286385*^9}, {
   3.8243039232558413`*^9, 3.824303992873065*^9}, 3.8243046014624443`*^9, {
   3.824304721423376*^9, 3.8243047255186443`*^9}, {3.824304761451281*^9, 
   3.82430479234863*^9}, {3.824305559485857*^9, 3.8243055666149*^9}, {
   3.824306197288363*^9, 3.8243062468901663`*^9}, {3.824307064637556*^9, 
   3.824307066870605*^9}, {3.824307371132061*^9, 3.82430737504605*^9}, {
   3.824307407346196*^9, 3.824307415582924*^9}, {3.8243076182727833`*^9, 
   3.8243076184472713`*^9}, {3.82430774369795*^9, 3.8243077446490593`*^9}, {
   3.824308085025352*^9, 3.824308090725337*^9}, {3.824308199422291*^9, 
   3.824308206140506*^9}, {3.824308252785657*^9, 3.8243082935669937`*^9}, {
   3.824308324482592*^9, 3.824308410682747*^9}, {3.8243084496502953`*^9, 
   3.824308488910963*^9}, {3.8243093942811413`*^9, 3.824309430982087*^9}, {
   3.8243107923867207`*^9, 3.8243108445735292`*^9}, {3.824311024166565*^9, 
   3.824311027453088*^9}, {3.8243184501323423`*^9, 3.824318464487668*^9}, {
   3.8243202162284822`*^9, 3.8243202911329947`*^9}, {3.824321859990234*^9, 
   3.824321862062951*^9}, {3.824321917716749*^9, 3.824321950334517*^9}, {
   3.824321988843864*^9, 3.82432222452626*^9}, {3.824322329498057*^9, 
   3.824322330211993*^9}, {3.824322614074294*^9, 3.824322631974923*^9}, {
   3.824323890558671*^9, 3.824323891136404*^9}, {3.824537418492444*^9, 
   3.824537424122225*^9}, {3.824538130925724*^9, 3.824538142393158*^9}, {
   3.824538295437866*^9, 3.824538299246235*^9}, {3.824538484960519*^9, 
   3.824538527757381*^9}, 3.82453855786154*^9, {3.824539278213999*^9, 
   3.8245392903795357`*^9}, {3.824540075990387*^9, 3.824540076833686*^9}, {
   3.8245447938595867`*^9, 3.824544794903626*^9}, {3.824544962410778*^9, 
   3.824545005551125*^9}, {3.8245450589251204`*^9, 3.824545076376213*^9}, {
   3.824548329157998*^9, 3.824548332446637*^9}, {3.82454915815876*^9, 
   3.824549167377708*^9}, {3.8245492198720703`*^9, 3.824549220563349*^9}, {
   3.824755305476252*^9, 3.824755306765834*^9}, {3.82485053687591*^9, 
   3.824850564779814*^9}, {3.824883120918393*^9, 3.8248831405625*^9}, {
   3.824883246261015*^9, 3.8248833115745087`*^9}, {3.8248833622595053`*^9, 
   3.824883473262661*^9}, {3.824883677202252*^9, 3.8248836814067297`*^9}, {
   3.824883862802598*^9, 3.824883869441951*^9}, {3.825014610297204*^9, 
   3.8250146110752974`*^9}, {3.8250165996349382`*^9, 3.825016600928647*^9}, {
   3.825058150430339*^9, 3.825058153579541*^9}, {3.8250630183201523`*^9, 
   3.825063058617509*^9}, 3.825104545560051*^9, {3.82510563664517*^9, 
   3.825105655523931*^9}, {3.825105704992066*^9, 3.8251057613434362`*^9}, {
   3.825106295956503*^9, 3.8251062982168694`*^9}, {3.825106738580282*^9, 
   3.8251067443225517`*^9}, {3.8251067766094418`*^9, 3.825106808256688*^9}, {
   3.825106860443375*^9, 3.825106878117125*^9}, {3.825106922627831*^9, 
   3.8251069276237288`*^9}, {3.82526760676342*^9, 3.8252676381881104`*^9}, {
   3.825268222776764*^9, 3.825268236131613*^9}, {3.8254957790766773`*^9, 
   3.825495791022871*^9}, {3.825495824222884*^9, 3.825495826860299*^9}, {
   3.825495858474276*^9, 3.825495859922833*^9}, {3.825498459321604*^9, 
   3.825498472200067*^9}, {3.825508410180365*^9, 3.825508412471156*^9}, {
   3.825510535785088*^9, 3.825510541736676*^9}, {3.8255110258935127`*^9, 
   3.825511031049593*^9}, {3.8255111796119833`*^9, 3.825511184914736*^9}, {
   3.825511873474053*^9, 3.825511874715992*^9}, 3.825511911160968*^9, {
   3.825512019043532*^9, 3.825512029076371*^9}, {3.825512066218796*^9, 
   3.825512320383342*^9}, {3.825512994360845*^9, 3.825513016641941*^9}, {
   3.825513099322051*^9, 3.82551320588933*^9}, {3.8255132374060087`*^9, 
   3.8255132705249033`*^9}, {3.825513305573246*^9, 3.82551337346861*^9}, {
   3.82551388475298*^9, 3.825513891560669*^9}, {3.825514413022797*^9, 
   3.825514428461008*^9}, {3.8255181205650673`*^9, 3.825518122316593*^9}, {
   3.8255182455727663`*^9, 3.825518248354433*^9}, {3.825534223641121*^9, 
   3.825534237994011*^9}, {3.825534599634287*^9, 3.825534700502471*^9}, {
   3.825534742211144*^9, 3.825534764676961*^9}, {3.825534946276765*^9, 
   3.825534981417391*^9}, {3.825535048088523*^9, 3.82553505038449*^9}, {
   3.825660849483787*^9, 3.825660864110058*^9}, {3.825664698419793*^9, 
   3.825664723565132*^9}, {3.825665049669495*^9, 3.82566505377386*^9}, {
   3.825665393241602*^9, 3.8256655022016172`*^9}, {3.8256680448530807`*^9, 
   3.825668103089615*^9}, {3.825672081418087*^9, 3.825672088093466*^9}, 
   3.825673266449448*^9, {3.825675553202299*^9, 3.825675555203444*^9}, {
   3.825675601351818*^9, 3.825675684967312*^9}, {3.825675729569035*^9, 
   3.825675761334628*^9}, {3.825675974498933*^9, 3.825675982675151*^9}, {
   3.825676023333053*^9, 3.825676030887165*^9}, {3.8256761381984577`*^9, 
   3.825676193958191*^9}, {3.825785321064992*^9, 3.8257853222568502`*^9}, {
   3.825785360406653*^9, 3.825785392440948*^9}, {3.8257854888904657`*^9, 
   3.825785544623884*^9}, {3.825785575988226*^9, 3.825785637414837*^9}, {
   3.825785975166486*^9, 3.825785984346795*^9}, {3.825787528283985*^9, 
   3.825787659713517*^9}, {3.825787842281169*^9, 3.8257878681666594`*^9}, {
   3.825788346081984*^9, 3.825788371099234*^9}, {3.825791531086545*^9, 
   3.825791573672353*^9}, {3.82609426681771*^9, 3.826094301245672*^9}, {
   3.8260943388328133`*^9, 3.826094389856464*^9}, 3.826120322169571*^9, {
   3.8261207046360683`*^9, 3.8261207615476723`*^9}, {3.826120888806754*^9, 
   3.826120889126109*^9}, {3.826138110252082*^9, 3.8261381136511993`*^9}, {
   3.826138231845673*^9, 3.826138232678771*^9}, {3.826138262737748*^9, 
   3.82613830698333*^9}, {3.8261385515443068`*^9, 3.826138552318265*^9}, {
   3.826139766372301*^9, 3.826139769926347*^9}, {3.826140448893526*^9, 
   3.8261404520097933`*^9}, {3.826144910501575*^9, 3.826144912675462*^9}, {
   3.826145205520015*^9, 3.826145213235814*^9}, {3.826198720956499*^9, 
   3.8261987749690104`*^9}, {3.826198874868515*^9, 3.826198876043291*^9}, {
   3.826199173007904*^9, 3.826199175377626*^9}, {3.826199218302203*^9, 
   3.8261992204719963`*^9}, {3.8262702423674173`*^9, 3.826270242648131*^9}, {
   3.826270468282893*^9, 3.826270473673602*^9}, {3.82627691820885*^9, 
   3.826276958617146*^9}, {3.8262773191321917`*^9, 3.826277383484249*^9}, {
   3.826277432107605*^9, 3.826277437786437*^9}, {3.826277475344172*^9, 
   3.826277485457539*^9}, {3.826298328914434*^9, 3.826298409068282*^9}, {
   3.826298530553568*^9, 3.826298531692553*^9}, {3.826299052951599*^9, 
   3.826299065179369*^9}, {3.826299229301776*^9, 3.826299230544084*^9}, {
   3.826302431576777*^9, 3.826302454738573*^9}, {3.826302501195551*^9, 
   3.826302553803144*^9}, {3.826302609693803*^9, 3.826302616352551*^9}, {
   3.82669881853535*^9, 3.826698824871673*^9}, {3.826698870378009*^9, 
   3.826698921686386*^9}, {3.826698978096369*^9, 3.826698979255539*^9}, {
   3.826699382633584*^9, 3.826699454624948*^9}, {3.826699752670434*^9, 
   3.826699755070755*^9}, {3.826701600273657*^9, 3.826701692990178*^9}, {
   3.826711499616312*^9, 3.8267114998103037`*^9}, {3.826723542544141*^9, 
   3.826723604106338*^9}, {3.826724056838066*^9, 3.826724097339995*^9}, {
   3.8267402594275007`*^9, 3.8267402718458767`*^9}, {3.8267416079670963`*^9, 
   3.826741626060364*^9}, {3.826742112385083*^9, 3.826742128197468*^9}, {
   3.826743556679257*^9, 3.826743623841836*^9}, {3.826743756076137*^9, 
   3.826743814687344*^9}, {3.826743894171132*^9, 3.826743928699864*^9}, {
   3.826745503475848*^9, 3.826745554121994*^9}, {3.8267460256902237`*^9, 
   3.826746072339713*^9}, 3.82674622277421*^9, {3.826746265465904*^9, 
   3.826746297350039*^9}, 3.826746443980891*^9, {3.8267469607209597`*^9, 
   3.826746963341021*^9}, {3.826777491789135*^9, 3.826777497863015*^9}, {
   3.826777689743737*^9, 3.826777694463305*^9}, {3.826777726077855*^9, 
   3.826777778138949*^9}, 3.826778220794985*^9, {3.826788824558866*^9, 
   3.8267888458977127`*^9}, {3.826788942921905*^9, 3.826788960939682*^9}, {
   3.8267891914320087`*^9, 3.826789219722056*^9}, {3.826789271734152*^9, 
   3.826789272427622*^9}, {3.8267901898011303`*^9, 3.826790190433629*^9}, {
   3.831529685580707*^9, 3.831529692248479*^9}, {3.831718875875195*^9, 
   3.83171888729807*^9}, {3.831719187526713*^9, 3.831719216823043*^9}, {
   3.831719980062619*^9, 3.8317201583587627`*^9}, {3.831720193113049*^9, 
   3.83172021607758*^9}, {3.831739537758512*^9, 3.83173959904624*^9}, {
   3.831739678174284*^9, 3.831739678652192*^9}, {3.831739846604487*^9, 
   3.8317398621026154`*^9}, 3.831791723777203*^9, {3.831798712733508*^9, 
   3.831798714018696*^9}, {3.831798798403708*^9, 3.831798804201972*^9}, {
   3.831804653930434*^9, 3.831804705097946*^9}, {3.831807605858328*^9, 
   3.8318076448385687`*^9}, 3.8318076940328627`*^9, {3.831913526033209*^9, 
   3.831913529474889*^9}, {3.831980801237941*^9, 3.831980839336377*^9}, {
   3.8319811833563957`*^9, 3.831981185428753*^9}, {3.8320573353664293`*^9, 
   3.832057338106555*^9}, {3.832057412666327*^9, 3.832057475911785*^9}, {
   3.832057683626811*^9, 3.832057683833787*^9}, {3.833280094325014*^9, 
   3.833280182683653*^9}, {3.8332825426794643`*^9, 3.833282561953844*^9}, {
   3.8332841352770348`*^9, 3.833284357367276*^9}, {3.8332844102555304`*^9, 
   3.833284484617537*^9}, {3.833285688264647*^9, 3.8332857097312*^9}, {
   3.8332857627855043`*^9, 3.833285778984912*^9}, {3.833285869537068*^9, 
   3.833285927465303*^9}, {3.833286002743374*^9, 3.833286005683317*^9}, {
   3.8332881392040033`*^9, 3.8332881816305943`*^9}, {3.8332882495948763`*^9, 
   3.833288293933681*^9}, {3.8332883928514433`*^9, 3.833288399518552*^9}, {
   3.833288450116057*^9, 3.833288604187621*^9}, {3.8333557404730673`*^9, 
   3.833355751383128*^9}, {3.833355998664579*^9, 3.8333560152932253`*^9}, {
   3.833356856060226*^9, 3.8333568740078497`*^9}, {3.833358799100299*^9, 
   3.833358846721134*^9}, {3.83335891414176*^9, 3.8333589172787743`*^9}, 
   3.8333599854235983`*^9, {3.8333609709268017`*^9, 3.8333610107652884`*^9}, {
   3.8333673705664463`*^9, 3.833367394586445*^9}, {3.834001480000996*^9, 
   3.834001532824792*^9}, {3.834001634650696*^9, 3.834001671873719*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"fb4cf242-f62e-4f00-b0ef-c767b2721190"],

Cell[BoxData["\<\"Wrap[list,anzatz,angle,enerhy,sidx,hash___]. Wrap data into \
a list of association.\"\>"], "Output",
 CellChangeTimes->{
  3.8340016732161503`*^9, 3.834002489701644*^9, 3.834090268823056*^9, {
   3.834127494783682*^9, 3.834127515674788*^9}, 3.834129210082954*^9, 
   3.834130111194252*^9, 3.834131901330511*^9, 3.8341400759644537`*^9, 
   3.8341401771347027`*^9, 3.835352312522233*^9, 3.835471614283773*^9, 
   3.835473351762244*^9, 3.8354733822724113`*^9, 3.8354734547463007`*^9, 
   3.835473978225209*^9, 3.835887010158531*^9, 3.836557699783819*^9, 
   3.836621769134274*^9, 3.836638507689231*^9, {3.836671214606803*^9, 
   3.8366712371781473`*^9}, 3.836671353232098*^9, 3.836671468960375*^9, 
   3.8366715851896048`*^9, 3.836672574902258*^9, 3.836672793010892*^9, 
   3.8367374447655087`*^9, 3.836815882298465*^9, 3.836815927645104*^9, 
   3.836815962951391*^9, 3.836816372251883*^9, 3.836816409212368*^9, 
   3.8368166973519*^9, 3.836816754223666*^9, 3.8368171348047123`*^9, {
   3.836817231436558*^9, 3.836817250533721*^9}, 3.8368173755958853`*^9, 
   3.836817414552155*^9, 3.83681751941133*^9, 3.836817627127924*^9, 
   3.8368472690339537`*^9, 3.836847386072484*^9, 3.836847452042448*^9, 
   3.836847731868682*^9, 3.8368479928581047`*^9, 3.836887142502674*^9, 
   3.836888978216201*^9, 3.83688904233906*^9, 3.83688911438203*^9, 
   3.8368891715705433`*^9, 3.8368910678288593`*^9, 3.83689111771677*^9, 
   3.836891174839284*^9, 3.836928486507875*^9, 3.836969167841138*^9, 
   3.836970063786124*^9, 3.8369705926425867`*^9, 3.836970674994419*^9, 
   3.836970751566684*^9, 3.837002672576364*^9, 3.837146515904578*^9, 
   3.8371465640808363`*^9, 3.83714668054599*^9, 3.837147386940077*^9, 
   3.84225093032642*^9, 3.843540816049721*^9, {3.850484427213521*^9, 
   3.85048443656428*^9}, 3.850484476763888*^9, 3.850485414012108*^9, 
   3.8504856040106792`*^9, 3.850578360733481*^9, {3.850579204176004*^9, 
   3.8505792134150343`*^9}, 3.850661898583336*^9, 3.8506623003981133`*^9, 
   3.850712614695943*^9, 3.850806719799026*^9, 3.850808773729693*^9, 
   3.850813964391301*^9, 3.8508147999931087`*^9, 3.850816893533907*^9, 
   3.85081738832314*^9, 3.8508176733891706`*^9, 3.8508183576215467`*^9, 
   3.850818457194858*^9, {3.850827823377797*^9, 3.850827836044828*^9}, 
   3.8508278670879393`*^9, 3.850845404703966*^9, {3.85087966123778*^9, 
   3.850879681891984*^9}, 3.850990880406713*^9, 3.85201373189052*^9, 
   3.852013834099345*^9, 3.852013948605733*^9, 3.852618728644537*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"de3d048e-7e8d-4972-8d32-ac2ccbcfff04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AdjustSpeed", "::", "usage"}], "=", 
  "\"\<AdjustSpeed[conf,defconf,slowdown,ncycle]. Adjust some \
hyperparameters.\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"AdjustSpeed", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdjustSpeed", "[", 
    RowBox[{"conf_", ",", "defconf_", ",", "slowdown_", ",", "ncycle_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"abort", "=", "False"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"first", ",", " ", 
       RowBox[{"try", " ", "to", " ", 
        RowBox[{"speedup", ":", " ", 
         RowBox[{"more", " ", "gates"}]}]}], ",", " ", 
       RowBox[{"more", " ", "disturbed", " ", "system"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"conf", "[", "\"\<gatespercycle\>\"", "]"}], 
         "\[GreaterEqual]", 
         RowBox[{"4", 
          RowBox[{"defconf", "[", "\"\<gatespercycle\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"slowdown", "=", " ", "False"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"(*", 
          RowBox[{"reset", " ", "first", " ", "before", " ", "speedingup"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"conf", "[", 
             RowBox[{"ToString", "[", "key", "]"}], "]"}], "=", 
            RowBox[{"defconf", "[", "key", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"key", ",", 
             RowBox[{"Keys", "@", "conf"}]}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"conf", "[", "\"\<gatespercycle\>\"", "]"}], "\[LessEqual]", 
         
         RowBox[{"0.3", 
          RowBox[{"defconf", "[", "\"\<gatespercycle\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<I give up lowering the energy \>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"abort", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"slowdown", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "the", " ", "computation", " ", "is", " ", "going", " ", "slower"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"conf", "[", "\"\<gatespercycle\>\"", "]"}], "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"conf", "[", "\"\<gatespercycle\>\"", "]"}], "*", 
              "1.2"}], "]"}], ",", 
            RowBox[{"4", " ", 
             RowBox[{"defconf", "[", "\"\<gatespercycle\>\"", "]"}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<\[Alpha]tikhonov\>\"", "]"}], "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"conf", "[", "\"\<\[Alpha]tikhonov\>\"", "]"}], "*", 
             "0.8"}], ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "4"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}], "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}], "*", "1.2"}], 
            ",", "6"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<\[Theta]initrange\>\"", "]"}], "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"conf", "[", "\"\<\[Theta]initrange\>\"", "]"}], "*", 
             "1.2"}], ",", "\[Pi]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<greediness\>\"", "]"}], "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"conf", "[", "\"\<greediness\>\"", "]"}], "+", "2"}], 
            ",", 
            RowBox[{"2", "*", 
             RowBox[{"defconf", "[", "\"\<greediness\>\"", "]"}]}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<I'm slowing down. Number of gates is increased to \>\"", ",", 
           RowBox[{"conf", "[", "\"\<gatespercycle\>\"", "]"}], ",", 
           "\"\< @cycle \>\"", ",", "ncycle"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "the", " ", "computation", " ", "is", " ", "going", " ", "faster"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"conf", "[", "\"\<gatespercycle\>\"", "]"}], "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"conf", "[", "\"\<gatespercycle\>\"", "]"}], "*", 
              "0.8"}], "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<\[Alpha]tikhonov\>\"", "]"}], "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"conf", "[", "\"\<\[Alpha]tikhonov\>\"", "]"}], "*", 
             "1.2"}], ",", "1.0"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}], "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}], "*", "0.8"}], 
            ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "3"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"conf", "[", "\"\<greediness\>\"", "]"}], "=", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"conf", "[", "\"\<greediness\>\"", "]"}], "+", "2"}], 
            ",", 
            RowBox[{"2", "*", 
             RowBox[{"defconf", "[", "\"\<greediness\>\"", "]"}]}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<I'm speeding up. Number of gates is decreased to \>\"", ",", 
           RowBox[{"conf", "[", "\"\<gatespercycle\>\"", "]"}], ",", 
           "\"\< @cycle \>\"", ",", "ncycle"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "abort"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.83400184389423*^9, 3.834001878965909*^9}, {
  3.834001920594445*^9, 3.83400200130425*^9}, {3.834002049549749*^9, 
  3.834002079359251*^9}, {3.834002303197135*^9, 3.8340023534078903`*^9}, {
  3.834002545518257*^9, 3.834002566751112*^9}, {3.834002601332962*^9, 
  3.834002633633953*^9}, {3.8363069965362883`*^9, 3.8363070445667133`*^9}, {
  3.8431493967464037`*^9, 3.843149423800894*^9}, {3.843149613080942*^9, 
  3.843149624523381*^9}, {3.8431498281770763`*^9, 3.843149853290925*^9}, {
  3.843149944574665*^9, 3.843150002950015*^9}, {3.843150138943969*^9, 
  3.843150139659257*^9}, {3.843150505498158*^9, 3.843150518261166*^9}, {
  3.850806056977171*^9, 3.850806130780899*^9}, {3.850827688554262*^9, 
  3.850827693179914*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"52d52a5a-36a2-4d12-b724-bacffad68daf"],

Cell[BoxData["\<\"AdjustSpeed[conf,defconf,slowdown,ncycle]. Adjust some \
hyperparameters.\"\>"], "Output",
 CellChangeTimes->{
  3.834002634553699*^9, 3.8340902688412037`*^9, {3.8341274947968616`*^9, 
   3.834127515707847*^9}, 3.8341292100951366`*^9, 3.834130111212201*^9, 
   3.834131901344322*^9, 3.8341400759731827`*^9, 3.834140177137912*^9, 
   3.835352312533636*^9, 3.835471614300036*^9, 3.835473351773294*^9, 
   3.835473382285439*^9, 3.83547345476259*^9, 3.8354739782347927`*^9, 
   3.835887010168413*^9, 3.836307048006029*^9, 3.8365576997954693`*^9, 
   3.836621769149375*^9, 3.836638507701054*^9, {3.836671214614036*^9, 
   3.836671237190783*^9}, 3.836671353252275*^9, 3.83667146898125*^9, 
   3.836671585201118*^9, 3.836672574910503*^9, 3.8366727930203333`*^9, 
   3.836737444774646*^9, 3.836815882306593*^9, 3.836815927653708*^9, 
   3.836815962961059*^9, 3.836816372260667*^9, 3.836816409223154*^9, 
   3.8368166973589363`*^9, 3.8368167542308407`*^9, 3.836817134813424*^9, {
   3.836817231447081*^9, 3.8368172505439453`*^9}, 3.8368173756031523`*^9, 
   3.836817414559454*^9, 3.836817519421876*^9, 3.836817627135562*^9, 
   3.836847269051697*^9, 3.8368473860827093`*^9, 3.836847452051281*^9, 
   3.836847731880807*^9, 3.8368479928679457`*^9, 3.83688714251613*^9, 
   3.836888978225417*^9, 3.836889042349613*^9, 3.836889114390792*^9, 
   3.836889171579596*^9, 3.83689106783847*^9, 3.8368911177263737`*^9, 
   3.8368911748481817`*^9, 3.836928486511847*^9, 3.836969167851359*^9, 
   3.836970063802434*^9, 3.836970592645494*^9, 3.8369706749975977`*^9, 
   3.836970751570064*^9, 3.837002672599311*^9, 3.837146515925622*^9, 
   3.837146564099182*^9, 3.837146680557002*^9, 3.837147386942603*^9, 
   3.8422509303660583`*^9, 3.8435408160642157`*^9, {3.8504844272349653`*^9, 
   3.850484436593096*^9}, 3.850484476791938*^9, 3.850485414034369*^9, 
   3.850485604042613*^9, 3.8505783607552147`*^9, {3.8505792041992283`*^9, 
   3.8505792134393873`*^9}, 3.850661898607492*^9, 3.8506623004235163`*^9, 
   3.85071261471716*^9, 3.850806168243515*^9, 3.850806719813818*^9, 
   3.8508087737450733`*^9, 3.850813964412669*^9, 3.8508148000158787`*^9, 
   3.8508168935743227`*^9, 3.850817388340385*^9, 3.850817673402302*^9, 
   3.850818357635398*^9, 3.850818457218029*^9, 3.850827695017392*^9, {
   3.8508278234009438`*^9, 3.850827836067527*^9}, 3.8508278671151447`*^9, 
   3.850845404729624*^9, {3.8508796612547197`*^9, 3.8508796819108057`*^9}, 
   3.850990880427899*^9, 3.852013731910624*^9, 3.85201383413069*^9, 
   3.852013948632535*^9, 3.852618728671425*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"097b7cef-78de-4a74-97da-2a66629d6f71"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AdjustAngles", "::", "usage"}], "=", 
  "\"\<AdjustAngles[\[Theta]vars]. Adjust \[Theta]vars so that angles within \
the range [-4\[Pi],4\[Pi]]. Note that this process will alter the cost, since \
different duration alters the passive noise.\>\""}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"AdjustAngles", ",", "HoldFirst"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AdjustAngles", "[", "\[Theta]vars_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]vars", "[", "k", "]"}], "<", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Theta]vars", "[", "k", "]"}], "=", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"\[Theta]vars", "[", "k", "]"}], ",", 
            RowBox[{
             RowBox[{"-", "4"}], "\[Pi]"}]}], "]"}]}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Theta]vars", "[", "k", "]"}], "=", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"\[Theta]vars", "[", "k", "]"}], ",", 
            RowBox[{"4", "\[Pi]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}],
        ";"}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Keys", "@", "\[Theta]vars"}]}], "}"}]}], "]"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8394053908767033`*^9, 3.839405456653802*^9}, {
  3.839407536696048*^9, 3.839407573173818*^9}, {3.8394076494569683`*^9, 
  3.8394077477505503`*^9}, {3.83940839238931*^9, 3.839408427443285*^9}, {
  3.839409065357811*^9, 3.8394090776506357`*^9}, {3.839475958577764*^9, 
  3.839475995390764*^9}, {3.841289995100748*^9, 3.841290073794557*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"667b0664-8ae0-495a-9fe1-b3a69cbd6565"],

Cell[BoxData["\<\"AdjustAngles[\[Theta]vars]. Adjust \[Theta]vars so that \
angles within the range [-4\[Pi],4\[Pi]]. Note that this process will alter \
the cost, since different duration alters the passive noise.\"\>"], "Output",
 CellChangeTimes->{
  3.839415654731421*^9, 3.839471738409844*^9, 3.839473561762384*^9, 
   3.839473704960534*^9, 3.839473765011948*^9, {3.839475142401821*^9, 
   3.839475161871681*^9}, 3.839475195693281*^9, 3.839475264346726*^9, 
   3.8394753165313997`*^9, 3.8394754259673758`*^9, 3.8394755570651197`*^9, 
   3.8394757093212767`*^9, 3.8394758794608173`*^9, 3.8394759977185698`*^9, 
   3.8394768672681437`*^9, 3.839476977082211*^9, 3.839478022144898*^9, 
   3.839478615214609*^9, 3.8394787103238497`*^9, 3.839491888214291*^9, 
   3.839492020768218*^9, 3.839492059332055*^9, 3.839492128228716*^9, 
   3.839492281553525*^9, 3.839493066330817*^9, 3.839493275962627*^9, 
   3.839501280187689*^9, 3.839501424482339*^9, 3.839501506413011*^9, 
   3.8395016977658*^9, 3.839501780480501*^9, 3.839561945711278*^9, 
   3.839564125709408*^9, 3.839564603918901*^9, 3.839566147301993*^9, {
   3.839573438685005*^9, 3.839573465142219*^9}, {3.839573887844993*^9, 
   3.839573909145113*^9}, 3.839574522487772*^9, 3.839593465368915*^9, 
   3.8395949821392508`*^9, 3.83959509564532*^9, 3.8399261611295357`*^9, 
   3.839995263904643*^9, 3.839995818280551*^9, 3.839995865374888*^9, 
   3.839999942891502*^9, 3.84000026434367*^9, 3.840001288544692*^9, 
   3.8400103010901527`*^9, 3.8400105072922907`*^9, 3.8400108178477163`*^9, 
   3.840010853698017*^9, 3.840011114864575*^9, 3.840011798145467*^9, 
   3.840011873861813*^9, 3.840012484326779*^9, 3.84001253488645*^9, 
   3.84001257638734*^9, {3.840012958681295*^9, 3.8400129676485043`*^9}, 
   3.840013406318882*^9, 3.840013521366601*^9, 3.840013582030921*^9, 
   3.840017073099249*^9, {3.840023521772106*^9, 3.840023529171626*^9}, {
   3.8400242125691633`*^9, 3.8400242185338*^9}, 3.8400246677012157`*^9, 
   3.8400247207686462`*^9, 3.84002477431046*^9, 3.8400249225847797`*^9, 
   3.840025172947186*^9, 3.8400253423315353`*^9, 3.840025581827236*^9, 
   3.8400258273501*^9, {3.8400259504264717`*^9, 3.840025976487059*^9}, 
   3.840026243395509*^9, {3.840027834982624*^9, 3.840027852725217*^9}, 
   3.840027905906907*^9, 3.840027989106276*^9, {3.841290048272271*^9, 
   3.8412900742536497`*^9}, 3.842250930409463*^9, 3.843540816081465*^9, {
   3.8504844272563353`*^9, 3.850484436611026*^9}, 3.850484476822097*^9, 
   3.850485414046026*^9, 3.850485604060236*^9, 3.850578360769574*^9, {
   3.850579204269636*^9, 3.850579213461322*^9}, 3.850661898628141*^9, 
   3.850662300479336*^9, 3.850712614735347*^9, 3.850806719824196*^9, 
   3.8508087737603893`*^9, 3.850813964431704*^9, 3.8508148000345078`*^9, 
   3.8508168936154413`*^9, 3.8508173883540773`*^9, 3.850817673457163*^9, 
   3.850818357660651*^9, 3.850818457239547*^9, {3.850827823417924*^9, 
   3.850827836086529*^9}, 3.850827867135927*^9, 3.850845404742902*^9, {
   3.850879661266018*^9, 3.850879681929494*^9}, 3.850990880456602*^9, 
   3.8520137319355907`*^9, 3.852013834249661*^9, 3.8520139486613293`*^9, 
   3.8526187286978283`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"a59fa63b-c4be-4984-a17f-3ac67fc23256"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main module: VQEGS", "Subsubsection",
 CellChangeTimes->{{3.8340026516472282`*^9, 
  3.834002659333259*^9}},ExpressionUUID->"aacefaa9-229c-4852-9ee9-\
156e44414a68"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"VQEGS", "::", "usage"}], "=", 
  "\"\<VQEGS[nqubit_,hamiltonian_,conf_] calculate ground-state \
energy\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"VQEGS", ",", "HoldRest"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VQEGS", "[", 
   RowBox[{"nqubit_", ",", "hamiltonian_", ",", "conf_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ftb", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"True", "\[Rule]", "1"}], ",", 
         RowBox[{"False", "\[Rule]", "0"}]}], "|>"}]}], ",", "\[Psi]", ",", 
      "\[Psi]work", ",", 
      RowBox[{"\[Psi]\[Theta]k", "=", 
       RowBox[{"{", "}"}]}], ",", "TotalCirc", ",", 
      RowBox[{"fev", "=", "0"}], ",", "cycleres", ",", 
      RowBox[{"Elist", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"ansatz", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"\[Theta]vars", "=", 
       RowBox[{"<|", "|>"}]}], ",", "Ecur", ",", "IsDone", ",", 
      RowBox[{"ncycle", "=", "0"}], ",", 
      RowBox[{"greedy", "=", "True"}], ",", "finmsg", ",", "greedtrial", ",", 
      "greedres", ",", "g", ",", "gatespercycle", ",", "ghash", ",", 
      "gansatz", ",", "g\[Theta]vars", ",", "ng\[Theta]vars", ",", "tidx", 
      ",", "gansatzid", ",", "Eold", ",", "gE", ",", "gElist", ",", "r", ",", 
      "ibestg", ",", 
      RowBox[{"elimmerge", "=", "0"}], ",", 
      RowBox[{"elimbfsmall", "=", "0"}], ",", 
      RowBox[{"elimmetov", "=", "0"}], ",", 
      RowBox[{"elimbf", "=", "0"}], ",", 
      RowBox[{"gmerged", "=", "0"}], ",", 
      RowBox[{"wmsg", "=", "\"\<\>\""}], ",", "dE", ",", 
      RowBox[{"dkeys", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ansatz\>\"", ",", "\"\<\[Theta]vars\>\"", ",", "\"\<E\>\"", ",", 
         "\"\<idx\>\""}], "}"}]}], ",", 
      RowBox[{"hkeys", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<ansatz\>\"", ",", "\"\<\[Theta]vars\>\"", ",", "\"\<E\>\"", ",", 
         "\"\<idx\>\"", ",", "\"\<hash\>\""}], "}"}]}], ",", 
      RowBox[{"\[Alpha]incr", "=", 
       RowBox[{"Min", "[", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"conf", "[", "\"\<\[Alpha]tikhonov\>\"", "]"}], "]"}], ",", 
         "0.1"}], "]"}]}], ",", 
      RowBox[{"aborted", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"idx", "=", "1"}], ",", "eincr", ",", 
      RowBox[{"compsucc", "=", "0"}], ",", 
      RowBox[{"globalconverge", "=", "0"}], ",", "g\[Theta]varsold", ",", 
      "gdE", ",", "gEold", ",", "\[Theta]varsold", ",", "elist", ",", 
      RowBox[{"slowdown", "=", 
       RowBox[{"conf", "[", "\"\<slowfirst\>\"", "]"}]}], ",", 
      RowBox[{"defconf", "=", "conf"}], ",", "maxcost", ",", "params", ",", 
      "refinenumber", ",", "erif", ",", 
      RowBox[{"gradstep", "=", 
       RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}]}], ",", 
      RowBox[{"Akl", "=", "0"}], ",", 
      RowBox[{"status", "=", "\"\<start\>\""}]}], "}"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    
    RowBox[{"(*", " ", 
     RowBox[{"local", " ", "functions"}], " ", "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      RowBox[{"TotalCirc", "[", "a_", "]"}], ":=", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"conf", "[", "\"\<ansatzinit\>\"", "]"}], ",", "a"}], "]"}], 
       "/.", "CustomGatesDefinitions"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Initializations", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"put", " ", "initial", " ", "state"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Psi]", ",", "\[Psi]work"}], "}"}], "=", 
      RowBox[{"CreateQuregs", "[", 
       RowBox[{
        RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", "2"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"InitZeroState", "@", "\[Psi]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"**", "  ", "Adaptive"}], "  ", "***)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"conf", "[", "\"\<fixansatz\>\"", "]"}]}], "===", "0"}], ",",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "add", " ", "swap", " ", "fabric", " ", "if", " ", "necessary"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"conf", "[", "\"\<swapfabricdepth\>\"", "]"}], ">", "0"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ansatz", ",", "\[Theta]vars", ",", "idx"}], "}"}], "=", 
           RowBox[{"SwapFabric", "[", 
            RowBox[{"nqubit", ",", 
             RowBox[{"conf", "[", "\"\<swapfabricdepth\>\"", "]"}], ",", 
             "\[Pi]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ApplyCircuit", "[", 
         RowBox[{
          RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", 
          RowBox[{
           RowBox[{"TotalCirc", "[", "ansatz", "]"}], "/.", 
           "\[Theta]vars"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Ecur", "=", 
         RowBox[{"CalcExpecPauliSum", "[", 
          RowBox[{"\[Psi]", ",", "hamiltonian", ",", "\[Psi]work"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"fev", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"Elist", ",", "Ecur"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cycleres", "=", 
         RowBox[{"Association", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[Rule]", 
             RowBox[{"{", "}"}]}], "&"}], "/@", "dkeys"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Wrap", "[", 
         RowBox[{
         "cycleres", ",", "ansatz", ",", "\[Theta]vars", ",", "Ecur", ",", 
          "idx"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"finmsg", "=", 
            RowBox[{"Catch", "[", " ", 
             RowBox[{"(*", " ", 
              RowBox[{"Ready", " ", "for", " ", "interruption"}], " ", "*)"}],
              "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{"True", ",", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"++", "ncycle"}], ";", "\[IndentingNewLine]", 
                RowBox[{"greedtrial", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"ncycle", "===", "1"}], ",", 
                   RowBox[{"conf", "[", "\"\<greedinessinit\>\"", "]"}], ",", 
                   
                   RowBox[{"conf", "[", "\"\<greediness\>\"", "]"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"gatespercycle", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"ncycle", " ", "===", " ", "1"}], ",", 
                   RowBox[{"conf", "[", "\"\<ngatesinit\>\"", "]"}], ",", 
                   RowBox[{"conf", "[", "\"\<gatespercycle\>\"", "]"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"clear", " ", "old", " ", "buffer"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"gElist", "=", 
                 RowBox[{"<|", "|>"}]}], ";", " ", "\[IndentingNewLine]", 
                RowBox[{"greedres", "=", 
                 RowBox[{"Association", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{"{", "}"}]}], "&"}], "/@", "hkeys"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"Eold", "=", 
                 RowBox[{
                  RowBox[{"cycleres", "[", "\"\<E\>\"", "]"}], 
                  "\[LeftDoubleBracket]", 
                  RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Eold", "\[NotEqual]", " ", "Ecur"}], ",", " ", 
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<ERROR: Eold != Ecur\>\"", ",", " ", "Eold", ",", 
                    "\"\<,\>\"", ",", "Ecur"}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"start", " ", "GREEDY"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"g", "=", "1"}], ",", 
                  RowBox[{"g", "\[LessEqual]", "greedtrial"}], ",", " ", 
                  RowBox[{"g", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"tidx", "=", "idx"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"gansatz", "=", 
                    RowBox[{"ExtendAnsatz", "[", 
                    RowBox[{
                    "tidx", ",", "conf", ",", "ansatz", ",", 
                    "gatespercycle"}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"ghash", "=", 
                    RowBox[{"Hash", "[", "gansatz", "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"greedres", "[", "\"\<hash\>\"", "]"}], ",", 
                    "ghash"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "wmsg", "=", 
                    "\"\<I have tried this ansatz before. \>\""}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Continue", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   
                   RowBox[{"g\[Theta]vars", "=", "\[Theta]vars"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"g\[Theta]vars", "[", 
                    SubscriptBox["\[Theta]", "t"], "]"}], "=", 
                    RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"conf", "[", "\"\<\[Theta]initrange\>\"", "]"}]}],
                     ",", 
                    RowBox[{"conf", "[", "\"\<\[Theta]initrange\>\"", "]"}]}],
                     "}"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", "idx", ",", 
                    RowBox[{"tidx", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
                   "\[IndentingNewLine]", 
                   RowBox[{"gmerged", "=", 
                    RowBox[{"MergeGates", "[", 
                    RowBox[{"gansatz", ",", "g\[Theta]vars"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
                    RowBox[{
                    RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", 
                    "g\[Theta]vars", ",", "\[Psi]\[Theta]k"}], "]"}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "Relax", " ", "the", " ", "newly", " ", "obtained", " ", 
                    RowBox[{"parameters", "."}]}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"gE", "=", "Eold"}], ";", 
                   RowBox[{"g\[Theta]varsold", "=", "g\[Theta]vars"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"status", "=", "\"\<relaxansatz\>\""}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"gElist", "[", "g", "]"}], "=", 
                    RowBox[{"RelaxAnsatz", "[", 
                    RowBox[{"conf", ",", "hamiltonian", ",", "fev", ",", 
                    RowBox[{"TotalCirc", "[", "gansatz", "]"}], ",", 
                    "g\[Theta]vars", ",", "Akl", ",", "\[Psi]", ",", 
                    "\[Psi]work", ",", "\[Psi]\[Theta]k", ",", "gE", ",", 
                    "gradstep", ",", 
                    RowBox[{
                    RowBox[{"conf", "[", "\"\<greedflat\>\"", "]"}], "*", 
                    "Ecur"}], ",", 
                    RowBox[{"conf", "[", "\"\<maxgreediter\>\"", "]"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    "wrap", " ", "and", " ", "record", " ", "the", " ", 
                    "results"}], " ", "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"Wrap", "[", 
                    RowBox[{
                    "greedres", ",", "gansatz", ",", "g\[Theta]vars", ",", 
                    "gE", ",", "tidx", ",", "ghash"}], "]"}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"release", " ", "greedy"}], "-", "memory"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
                    RowBox[{
                    RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", 
                    "\[Theta]vars", ",", "\[Psi]\[Theta]k"}], "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"END", " ", "OF", " ", "GREEDY", " ", "TRIAL"}], 
                 "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Pick", " ", "the", " ", "best", " ", "line", " ", "to", " ",
                   "continue", " ", "optimization"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"ibestg", "=", 
                 RowBox[{"First", "@", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"greedres", "[", "\"\<E\>\"", "]"}], ",", 
                    RowBox[{"Min", "@", 
                    RowBox[{
                    "greedres", "\[LeftDoubleBracket]", "\"\<E\>\"", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "ansatz", ",", "\[Theta]vars", ",", "Ecur", ",", "idx"}], 
                  "}"}], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"greedres", "[", "#", "]"}], 
                    "\[LeftDoubleBracket]", "ibestg", 
                    "\[RightDoubleBracket]"}], "&"}], "/@", "dkeys"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
                 RowBox[{
                  RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", 
                  "\[Theta]vars", ",", "\[Psi]\[Theta]k"}], "]"}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"**", " ", "Improves"}], " ", "****)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Ecur", "<", 
                   RowBox[{
                    RowBox[{"cycleres", "[", "\"\<E\>\"", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ",", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{"improves", ":", " ", "pathetic"}], " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cycleres", "[", "\"\<E\>\"", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], " ", "-", 
                    "Ecur"}], "]"}], "\[LessEqual]", 
                    RowBox[{"conf", "[", "\"\<perfectingflat\>\"", "]"}]}], 
                    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<@cycle\>\"", "<>", 
                    RowBox[{"ToString", "[", "ncycle", "]"}], "<>", 
                    "\"\<, pathetic result.\>\""}], "]"}], ";", 
                    "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
                    RowBox[{"wmsg", "=", "\"\<I might be converging. \>\""}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"globalconverge", "+=", "1"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"AdjustSpeed", "[", 
                    RowBox[{
                    "conf", ",", "defconf", ",", "slowdown", ",", "ncycle"}], 
                    "]"}], ",", 
                    RowBox[{"Throw", "[", "\"\<I'm giving up.\>\"", "]"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"wmsg", "=", 
                    RowBox[{"wmsg", "<>", "\"\<Abort cycle \>\"", "<>", 
                    RowBox[{"ToString", "[", "ncycle", "]"}], "<>", 
                    "\"\<. Pathetic result. \>\""}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "ansatz", ",", "\[Theta]vars", ",", "Ecur", ",", "idx"}], 
                    "}"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"cycleres", "[", "#", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "&"}], "/@",
                     "dkeys"}]}], ";"}], "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"improves", ":", " ", "good"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"globalconverge", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"wmsg", "=", 
                    RowBox[{"\"\<Cycle \>\"", "<>", 
                    RowBox[{"ToString", "[", "ncycle", "]"}], "<>", 
                    "\"\< is completed with significant improvement. \
\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", "record", " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Elist", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"Elist", ",", 
                    RowBox[{"gElist", "[", "ibestg", "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"pruning", ":", " ", 
                    RowBox[{
                    "keep", " ", "at", " ", "least", " ", "90", "%", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "or", " ", "most", " ", "of", " ", "it", " ", "for", " ", 
                    "the", " ", "first", " ", "cycle"}], ")"}], " ", "of", 
                    " ", "improvement"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"maxcost", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ncycle", ">", "1"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Ecur", "-", 
                    RowBox[{
                    RowBox[{"cycleres", "[", "\"\<E\>\"", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ")"}], 
                    "*", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"conf", "[", "\"\<pruningerror\>\"", "]"}], ",", 
                    "0.1"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"cycleres", "[", "\"\<E\>\"", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Ecur", "+", 
                    RowBox[{"conf", "[", "\"\<\[Epsilon]fin\>\"", "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"wmsg", "=", 
                    RowBox[{
                    "wmsg", "<>", "\"\<Pruning and perfecting cycle \>\"", "<>", 
                    RowBox[{"ToString", "[", "ncycle", "]"}], "<>", 
                    "\"\<, with maxcost:\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"maxcost", ",", "FortranForm"}], "]"}], "<>", 
                    "\"\<; current cost=\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Ecur", ",", "FortranForm"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AdjustAngles", "[", "\[Theta]vars", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "elimmerge", ",", "elimbfsmall", ",", "elimmetov", ",", 
                    " ", "elimbf"}], "}"}], "+=", 
                    RowBox[{"PruneGates", "[", 
                    RowBox[{
                    "conf", ",", "hamiltonian", ",", "fev", ",", "Akl", ",", 
                    "Ecur", ",", "gradstep", ",", "ansatz", ",", 
                    "\[Theta]vars", ",", "TotalCirc", ",", "\[Psi]", ",", 
                    "\[Psi]work", ",", "\[Psi]\[Theta]k", ",", "maxcost", ",",
                     "True", ",", "status"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"Elist", ",", "Ecur"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"perfecting", " ", "this", " ", "cycle"}], " ", 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"AdjustAngles", "[", "\[Theta]vars", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"status", "=", "\"\<relaxansatz\>\""}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"elist", "=", 
                    RowBox[{"RelaxAnsatz", "[", 
                    RowBox[{"conf", ",", "hamiltonian", ",", "fev", ",", 
                    RowBox[{"TotalCirc", "[", "ansatz", "]"}], ",", 
                    "\[Theta]vars", ",", "Akl", ",", "\[Psi]", ",", 
                    "\[Psi]work", ",", "\[Psi]\[Theta]k", ",", "Ecur", ",", 
                    "gradstep", ",", 
                    RowBox[{"conf", "[", "\"\<\[Epsilon]fin\>\"", "]"}]}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Elist", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"Elist", ",", "elist"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Wrap", "[", 
                    RowBox[{
                    "cycleres", ",", "ansatz", ",", "\[Theta]vars", ",", 
                    "Ecur", ",", "idx"}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"**", " ", "Equals"}], "/", "Worse"}], " ", 
                   "****)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"globalconverge", "+=", "1"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"wmsg", "=", 
                    RowBox[{"\"\<Abort cycle \>\"", "<>", 
                    RowBox[{"ToString", "[", "ncycle", "]"}], "<>", 
                    "\"\<. Worse or equal result. \>\""}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"aborted", ",", "ncycle"}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "ansatz", ",", "\[Theta]vars", ",", "Ecur", ",", "idx"}], 
                    "}"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"cycleres", "[", "#", "]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "&"}], "/@",
                     "dkeys"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"AdjustSpeed", "[", 
                    RowBox[{
                    "conf", ",", "defconf", ",", "slowdown", ",", "ncycle"}], 
                    "]"}], ",", 
                    RowBox[{"Throw", "[", "\"\<I'm giving up.\>\"", "]"}]}], 
                    "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"\"\<@cycle\>\"", "<>", 
                   RowBox[{"ToString", "[", "ncycle", "]"}], "<>", 
                   "\"\<, fev:\>\"", "<>", 
                   RowBox[{"ToString", "[", "fev", "]"}], "<>", 
                   "\"\<, <E>: \>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"Ecur", ",", "FortranForm"}], "]"}]}], ",", 
                  RowBox[{"\"\< nansatz: \>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"Length", "@", "ansatz"}], "]"}]}], ",", 
                  RowBox[{
                  "\"\< merged-small\[Theta]-metric-bf-gmerged: \>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "elimmerge", ",", "elimbfsmall", ",", "elimmetov", ",", 
                    "elimbf", ",", "gmerged"}], "}"}], "]"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Getting", " ", "converged", " ", "or", " ", "stuck"}], " ", 
                 "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"globalconverge", "\[GreaterEqual]", " ", 
                   RowBox[{"conf", "[", "\"\<globalconverge\>\"", "]"}]}], 
                  ",", " ", 
                  RowBox[{
                  "Throw", "[", 
                   "\"\<Computation is either converging or stuck. \>\"", 
                   "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"wmsg", "=", "finmsg"}], ";", "\[IndentingNewLine]", 
           RowBox[{"wmsg", "=", 
            RowBox[{
            "wmsg", "<>", 
             "\"\< Final pruning ... we are almost there\>\""}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "maxcost", " ", "is", " ", "simply", " ", "the", " ", "final", 
             " ", "target"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"AdjustAngles", "[", "\[Theta]vars", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "elimmerge", ",", "elimbfsmall", ",", "elimmetov", ",", " ", 
              "elimbf"}], "}"}], "+=", 
            RowBox[{"PruneGates", "[", 
             RowBox[{
             "conf", ",", "hamiltonian", ",", "fev", ",", "Akl", ",", "Ecur", 
              ",", "gradstep", ",", "ansatz", ",", "\[Theta]vars", ",", 
              "TotalCirc", ",", "\[Psi]", ",", "\[Psi]work", ",", 
              "\[Psi]\[Theta]k", ",", "Ecur", ",", "True", ",", "status"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"wmsg", "=", "\"\<Perfecting... \>\""}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AdjustAngles", "[", "\[Theta]vars", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"Elist", ",", "Ecur"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "try", " ", "to", " ", "lower", " ", "the", " ", "energy"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"status", "=", "\"\<relax ansatz\>\""}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"elist", "=", 
            RowBox[{"RelaxAnsatz", "[", 
             RowBox[{"conf", ",", "hamiltonian", ",", "fev", ",", 
              RowBox[{"TotalCirc", "[", "ansatz", "]"}], ",", "\[Theta]vars", 
              ",", "Akl", ",", "\[Psi]", ",", "\[Psi]work", ",", 
              "\[Psi]\[Theta]k", ",", "Ecur", ",", "gradstep", ",", 
              RowBox[{"Ecur", "-", 
               RowBox[{"Ecur", "*", "0.01"}]}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Elist", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"Elist", ",", "elist"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Wrap", "[", 
            RowBox[{
            "cycleres", ",", "ansatz", ",", "\[Theta]vars", ",", "Ecur", ",", 
             "idx"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"DestroyAllQuregs", "[", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"Column", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<ncycle:\>\"", " ", "<>", 
              RowBox[{"ToString", "@", "ncycle"}], "<>", "\"\<, fev:\>\"", "<>", 
              RowBox[{"ToString", "@", "fev"}], "<>", 
              "\"\<, globalconvergence: \>\"", "<>", 
              RowBox[{"ToString", "[", "globalconverge", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Eliminations -- merged: \>\"", "<>", 
              RowBox[{"ToString", "[", "elimmerge", "]"}], "<>", 
              "\"\<, bruteforce small\[Theta]:\>\"", "<>", 
              RowBox[{"ToString", "[", "elimbfsmall", "]"}], "<>", 
              "\[IndentingNewLine]", "\"\<, metric: \>\"", "<>", 
              RowBox[{"ToString", "[", "elimmetov", "]"}], "<>", 
              "\"\<, brute-force: \>\"", "<>", 
              RowBox[{"ToString", "[", "elimbf", "]"}], "<>", 
              "\"\<, greed-merged: \>\"", "<>", 
              RowBox[{"ToString", "[", "gmerged", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "\"\<gatespercycle, greediness, \[Alpha]tikhonov, gradstep: \
\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"{", 
                RowBox[{"gatespercycle", ",", 
                 RowBox[{"conf", "[", "\"\<greediness\>\"", "]"}], ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"conf", "[", "\"\<\[Alpha]tikhonov\>\"", "]"}], 
                   ",", "FortranForm"}], "]"}], ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"gradstep", ",", "FortranForm"}], "]"}]}], "}"}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<ngates:\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Length", "@", "ansatz"}], "]"}], "<>", 
              "\"\<, cost=\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Ecur", ",", "FortranForm"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Status:\>\"", "<>", "status"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<Greedy section: \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"gE", ",", "FortranForm"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"greedres", "[", "\"\<E\>\"", "]"}], ",", "wmsg", 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{"DrawCircuit", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"TotalCirc", "[", "ansatz", "]"}], "/.", 
                "CustomGatesDraw"}], ",", "nqubit"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "Elist", ",", "ansatz", ",", "\[Theta]vars", ",", "finmsg", ",", 
          "ncycle", ",", "fev", ",", "aborted", ",", "cycleres", ",", 
          RowBox[{"{", 
           RowBox[{
           "elimmerge", ",", "elimbfsmall", ",", "elimmetov", ",", "elimbf"}],
            "}"}]}], "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"**", " ", "FIXED"}], " ", "ANSATZ"}], " ", "***)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ansatz", "=", 
            RowBox[{"conf", "[", "\"\<fixansatz\>\"", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{"conf", "[", "\"\<fixansatzparams\>\"", "]"}]}], ">", 
              "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "specifically", " ", "initialize", " ", "the", " ", 
               "parameters"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"\[Theta]vars", "=", 
              RowBox[{"Association", "[", 
               RowBox[{"conf", "[", "\"\<fixansatzparams\>\"", "]"}], "]"}]}],
              "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"randomly", " ", "initialized", " ", "parameters"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"params", "=", 
               RowBox[{"Sort", "@", 
                RowBox[{"DeleteDuplicates", "@", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Level", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], ",", 
                    RowBox[{
                    SubscriptBox["\[Theta]", "j_"], "\[Rule]", 
                    SubscriptBox["\[Theta]", "j"]}]}], "]"}], "&"}], "/@", 
                   "ansatz"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]vars", "=", 
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", 
                   RowBox[{"RandomReal", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"conf", "[", "\"\<\[Theta]initrange\>\"", "]"}]}],
                     ",", 
                    RowBox[{"conf", "[", "\"\<\[Theta]initrange\>\"", "]"}]}],
                     "}"}], "]"}]}], "&"}], "/@", "params"}], "|>"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"conf", "[", "\"\<methode\>\"", "]"}], "===", 
              "\"\<NG\>\""}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "these", " ", "will", " ", "be", " ", "quantum", " ", 
               "registers"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"AdjustQuregs\[Psi]\[Theta]k", "[", 
              RowBox[{
               RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", 
               "\[Theta]vars", ",", "\[Psi]\[Theta]k"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"otherwise", " ", "just", " ", "a", " ", "list"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"\[Psi]\[Theta]k", "=", 
              RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"erif", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Elist", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"elist", "=", 
                RowBox[{"RelaxAnsatz", "[", 
                 RowBox[{"conf", ",", "hamiltonian", ",", "fev", ",", 
                  RowBox[{"TotalCirc", "[", "ansatz", "]"}], ",", 
                  "\[Theta]vars", ",", "Akl", ",", "\[Psi]", ",", 
                  "\[Psi]work", ",", "\[Psi]\[Theta]k", ",", "Ecur", ",", 
                  "gradstep", ",", 
                  RowBox[{"conf", "[", "\"\<\[Epsilon]fin\>\"", "]"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}], "=", 
                RowBox[{"0.1", "*", 
                 RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"conf", "[", "\"\<\[Epsilon]fin\>\"", "]"}], "=", 
                RowBox[{"0.1", "*", 
                 RowBox[{"conf", "[", "\"\<\[Epsilon]fin\>\"", "]"}]}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"conf", "[", "\"\<iterconverge\>\"", "]"}], "=", 
                RowBox[{"2", "*", 
                 RowBox[{"conf", "[", "\"\<iterconverge\>\"", "]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"erif", ",", "Ecur"}], "]"}], ";", 
               "\[IndentingNewLine]", "elist"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"conf", "[", "\"\<refine\>\"", "]"}], "}"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"finmsg", "=", 
            RowBox[{"\"\<Fixed ansatz minimization is done with \>\"", "<>", 
             RowBox[{"ToString", "[", "fev", "]"}], "<>", 
             "\"\< with final energy \>\"", "<>", 
             RowBox[{"ToString", "@", "erif"}]}]}], ";"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"Column", "@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<gradstep, \[Epsilon]fin: \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"conf", "[", "\"\<gradstep\>\"", "]"}], ",", 
                   "FortranForm"}], "]"}], ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"conf", "[", "\"\<\[Epsilon]fin\>\"", "]"}], ",", 
                   "FortranForm"}], "]"}]}], "}"}], "]"}]}], ",", 
             RowBox[{"\"\<Eval:\>\"", "<>", 
              RowBox[{"ToString", "[", "fev", "]"}]}], ",", 
             RowBox[{"NumberForm", "[", 
              RowBox[{"Ecur", ",", "10"}], "]"}]}], "}"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Ecur", ",", "\[Theta]vars", ",", 
          RowBox[{"Flatten", "@", "Elist"}], ",", "finmsg"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.818866287921228*^9, 3.8188663140557137`*^9}, {
   3.818866575974663*^9, 3.818866648239793*^9}, {3.8188670744982977`*^9, 
   3.818867152250988*^9}, {3.818867200589505*^9, 3.818867228315877*^9}, {
   3.818867261268505*^9, 3.818867310841958*^9}, {3.818867412061289*^9, 
   3.8188674352239122`*^9}, {3.8188701924683523`*^9, 3.818870194973802*^9}, {
   3.818870998207262*^9, 3.8188710337586517`*^9}, {3.818871103548115*^9, 
   3.818871158311137*^9}, {3.818871227439344*^9, 3.818871335822884*^9}, 
   3.818872287333638*^9, {3.8188723759070787`*^9, 3.8188724258011227`*^9}, {
   3.8188731424401827`*^9, 3.818873193180937*^9}, {3.818873348718049*^9, 
   3.8188733571051188`*^9}, {3.818873398346096*^9, 3.8188734505259323`*^9}, {
   3.818873501510907*^9, 3.81887350452388*^9}, {3.81887359397013*^9, 
   3.818873596455492*^9}, {3.8188736770847607`*^9, 3.8188737174598227`*^9}, {
   3.818873790431275*^9, 3.818873816235731*^9}, {3.8188741510670156`*^9, 
   3.8188741815042753`*^9}, 3.8188742399605227`*^9, {3.818874286267984*^9, 
   3.818874418553134*^9}, {3.8188746986185417`*^9, 3.818874708657123*^9}, {
   3.8188747770184813`*^9, 3.8188747915809593`*^9}, {3.8188749205223*^9, 
   3.818874922227586*^9}, {3.8188749752050056`*^9, 3.818874984745612*^9}, {
   3.81887502890228*^9, 3.818875108506709*^9}, {3.818875162766426*^9, 
   3.818875225020604*^9}, {3.818875573664316*^9, 3.81887560710938*^9}, 
   3.818875664465044*^9, {3.81887572239074*^9, 3.81887573016*^9}, 
   3.818876084111815*^9, 3.818876433356715*^9, {3.818877293916646*^9, 
   3.818877305970224*^9}, 3.81887736245986*^9, {3.818877402508409*^9, 
   3.818877407325633*^9}, 3.818879244266343*^9, 3.818879360430743*^9, {
   3.818880592870439*^9, 3.818880615343904*^9}, {3.818880659626103*^9, 
   3.818880660552343*^9}, {3.818880691239297*^9, 3.818880694424903*^9}, {
   3.818882106544149*^9, 3.818882121653351*^9}, {3.8189170516502237`*^9, 
   3.8189170815230227`*^9}, {3.818917133382832*^9, 3.818917136731306*^9}, {
   3.8189171728720837`*^9, 3.818917179146432*^9}, {3.8189172583607597`*^9, 
   3.8189172607788563`*^9}, {3.818917311712109*^9, 3.818917335045802*^9}, {
   3.818926079256941*^9, 3.818926089597844*^9}, 3.818926119835464*^9, 
   3.818926425523337*^9, {3.818926510697173*^9, 3.818926519936573*^9}, {
   3.818926683394518*^9, 3.8189266850290117`*^9}, {3.818955661902564*^9, 
   3.818955691530938*^9}, {3.818955874329213*^9, 3.818955882965692*^9}, {
   3.818955919336141*^9, 3.818955923732958*^9}, {3.8189561078218403`*^9, 
   3.8189561243454103`*^9}, {3.8193909679889917`*^9, 3.819391018267992*^9}, 
   3.819391116109713*^9, {3.819391559553643*^9, 3.819391569179887*^9}, {
   3.819391646844598*^9, 3.8193916798262672`*^9}, {3.819391739504209*^9, 
   3.819391890912654*^9}, {3.8193919596750727`*^9, 3.819392014097406*^9}, {
   3.8193924868019238`*^9, 3.819392559762495*^9}, {3.819392603600933*^9, 
   3.8193926575613527`*^9}, {3.819393440227944*^9, 3.819393462290761*^9}, {
   3.819393499139077*^9, 3.819393661368264*^9}, {3.819393712003207*^9, 
   3.819393744156272*^9}, {3.819393878413639*^9, 3.819393881924361*^9}, {
   3.819394461392626*^9, 3.819394462982039*^9}, 3.819394642297099*^9, {
   3.819394827050008*^9, 3.819394828106442*^9}, {3.819394916925037*^9, 
   3.8193949480408287`*^9}, {3.8193949872971*^9, 3.8193950239344788`*^9}, {
   3.819395091964692*^9, 3.819395102064604*^9}, {3.819395167801991*^9, 
   3.8193951690305357`*^9}, {3.819395219104999*^9, 3.8193952284400673`*^9}, 
   3.819395404948539*^9, {3.819401872095833*^9, 3.819401980129465*^9}, {
   3.81940202343583*^9, 3.819402025185506*^9}, {3.8194020645473824`*^9, 
   3.819402066879384*^9}, {3.819402210759691*^9, 3.819402235597225*^9}, {
   3.819553586851602*^9, 3.819553591227137*^9}, {3.8195536918041487`*^9, 
   3.819553696561182*^9}, {3.819553758617455*^9, 3.8195537777421083`*^9}, {
   3.819554121406694*^9, 3.819554125353599*^9}, {3.819554161732629*^9, 
   3.819554217878686*^9}, {3.8195542681378098`*^9, 3.8195542692702837`*^9}, {
   3.819554335539914*^9, 3.8195543359112463`*^9}, {3.8195544711348877`*^9, 
   3.819554507103991*^9}, {3.819554559031498*^9, 3.81955456226606*^9}, {
   3.8195545956723557`*^9, 3.8195546322983828`*^9}, {3.819554845434408*^9, 
   3.819554862238633*^9}, {3.819554916635543*^9, 3.81955491834554*^9}, {
   3.8195549841703653`*^9, 3.8195550011021643`*^9}, {3.819555257433923*^9, 
   3.819555303548311*^9}, {3.819555350676914*^9, 3.81955536901775*^9}, {
   3.819555671689234*^9, 3.819555694171774*^9}, {3.8195557574878674`*^9, 
   3.8195557743722057`*^9}, {3.81955586748739*^9, 3.819555875630522*^9}, {
   3.819560515694871*^9, 3.819560545389743*^9}, {3.81956073043884*^9, 
   3.819560747964654*^9}, 3.8195609547492228`*^9, {3.8195610326335907`*^9, 
   3.819561053143077*^9}, {3.8195674533778353`*^9, 3.819567455393042*^9}, {
   3.8195677929368277`*^9, 3.819567820356502*^9}, {3.819567880664818*^9, 
   3.819568062318151*^9}, {3.819568217022625*^9, 3.8195682208455*^9}, {
   3.8195682742967663`*^9, 3.8195682792115*^9}, {3.8195683220617228`*^9, 
   3.819568332589957*^9}, {3.819568420723235*^9, 3.819568421024331*^9}, {
   3.819568459512689*^9, 3.819568461807551*^9}, {3.8195685785799217`*^9, 
   3.819568591579054*^9}, {3.8195686817966137`*^9, 3.8195687157218723`*^9}, {
   3.819568879404698*^9, 3.819568898214569*^9}, {3.819569008015148*^9, 
   3.819569041157958*^9}, {3.819570274880694*^9, 3.819570324768648*^9}, {
   3.819570962072603*^9, 3.819570996539019*^9}, {3.819571232769334*^9, 
   3.819571233164475*^9}, {3.8195712910322104`*^9, 3.8195713498391333`*^9}, 
   3.819571391527132*^9, {3.819571502933503*^9, 3.819571504394182*^9}, {
   3.819571546276125*^9, 3.819571551144763*^9}, {3.819571597643058*^9, 
   3.81957169679986*^9}, {3.819571757990137*^9, 3.819571776355434*^9}, {
   3.8195718313825207`*^9, 3.819571859213915*^9}, {3.819572073497835*^9, 
   3.819572073730277*^9}, {3.81964948026033*^9, 3.819649480771555*^9}, {
   3.81964953357681*^9, 3.8196497289821577`*^9}, 3.819649767038073*^9, {
   3.819709850700037*^9, 3.819709944035659*^9}, {3.8197102819718227`*^9, 
   3.819710285803028*^9}, {3.819710318828063*^9, 3.8197103363409367`*^9}, {
   3.8197119803955183`*^9, 3.819712002908939*^9}, {3.819723171364749*^9, 
   3.819723206109026*^9}, {3.819723366083579*^9, 3.8197233896159983`*^9}, {
   3.819742091358584*^9, 3.81974209378832*^9}, {3.819742292070632*^9, 
   3.819742300682663*^9}, {3.819743258827222*^9, 3.819743296574046*^9}, {
   3.819743722777205*^9, 3.8197437297187243`*^9}, {3.819744086475174*^9, 
   3.8197440921487417`*^9}, 3.819746024990107*^9, {3.819746181684264*^9, 
   3.819746184764452*^9}, {3.819746264739743*^9, 3.8197462804052134`*^9}, {
   3.819746311078678*^9, 3.8197463775141563`*^9}, {3.819747051492834*^9, 
   3.8197470675176697`*^9}, {3.819797349979104*^9, 3.819797355862179*^9}, {
   3.819803292612711*^9, 3.819803293124357*^9}, {3.819803472956588*^9, 
   3.819803486982148*^9}, {3.819805211506311*^9, 3.819805214126045*^9}, {
   3.819810677477332*^9, 3.81981072303204*^9}, {3.819817524564794*^9, 
   3.819817525457752*^9}, {3.819824038007053*^9, 3.819824058022175*^9}, {
   3.819824161973277*^9, 3.819824255748413*^9}, {3.8198267647185307`*^9, 
   3.819826832111703*^9}, 3.819826889648903*^9, {3.819826943947857*^9, 
   3.819826983122044*^9}, {3.819827377128633*^9, 3.819827395926682*^9}, {
   3.81996143472357*^9, 3.8199615286639633`*^9}, {3.819969341331847*^9, 
   3.819969373217997*^9}, {3.819969941643612*^9, 3.8199699584936333`*^9}, {
   3.819970153097768*^9, 3.819970154955284*^9}, {3.819970261182241*^9, 
   3.819970300221805*^9}, {3.819970396153428*^9, 3.819970464006187*^9}, {
   3.819971630504047*^9, 3.8199716707746353`*^9}, {3.819971767888167*^9, 
   3.819971791590424*^9}, {3.819971841895686*^9, 3.8199718924462147`*^9}, {
   3.819971987826953*^9, 3.819971999436442*^9}, {3.819972088871257*^9, 
   3.8199721031743603`*^9}, {3.819972222631919*^9, 3.81997223889299*^9}, {
   3.819972313374263*^9, 3.819972313748651*^9}, {3.819972349362974*^9, 
   3.819972359848256*^9}, {3.819972432775403*^9, 3.8199724358485937`*^9}, {
   3.8199760105151577`*^9, 3.819976016281046*^9}, {3.819976054044271*^9, 
   3.819976054454946*^9}, {3.819976088844688*^9, 3.819976107136426*^9}, {
   3.819976577791712*^9, 3.8199765904016953`*^9}, {3.819976649305393*^9, 
   3.819976683883194*^9}, {3.819976792647922*^9, 3.819976833864482*^9}, {
   3.819976953075706*^9, 3.819977040651984*^9}, {3.819977127017582*^9, 
   3.819977135666451*^9}, {3.819977177167165*^9, 3.819977177669558*^9}, {
   3.819986921838306*^9, 3.819986934787175*^9}, {3.819986974781537*^9, 
   3.819986977650029*^9}, {3.819987954711483*^9, 3.819987961312277*^9}, {
   3.8199880073269043`*^9, 3.819988022377234*^9}, {3.819988054557279*^9, 
   3.819988061389592*^9}, {3.8199881499872503`*^9, 3.819988151420936*^9}, {
   3.819988387838752*^9, 3.819988407112506*^9}, {3.8199884801440277`*^9, 
   3.819988506872271*^9}, {3.819988556062029*^9, 3.8199885740096283`*^9}, {
   3.8199886281054287`*^9, 3.81998869627435*^9}, {3.819992489374123*^9, 
   3.819992575446435*^9}, {3.819992627063746*^9, 3.819992638569723*^9}, {
   3.81999268609724*^9, 3.819992688388595*^9}, 3.819992913263031*^9, {
   3.819992947428372*^9, 3.819992957186817*^9}, {3.8199929951447268`*^9, 
   3.8199929953245373`*^9}, {3.819993035040683*^9, 3.8199930588973837`*^9}, {
   3.819993090017098*^9, 3.819993165261135*^9}, {3.819993204179722*^9, 
   3.819993219566553*^9}, {3.819993253656888*^9, 3.819993275966042*^9}, {
   3.8199933189062357`*^9, 3.819993320163829*^9}, {3.819993364326722*^9, 
   3.819993386851536*^9}, 3.819993720746009*^9, 3.819993843997958*^9, 
   3.819993899081534*^9, {3.819994472005495*^9, 3.819994491815077*^9}, {
   3.819994524573369*^9, 3.8199945733787527`*^9}, {3.819994733571168*^9, 
   3.8199947347952423`*^9}, {3.819994767565198*^9, 3.81999477058569*^9}, {
   3.819994827628729*^9, 3.8199948530025187`*^9}, {3.819996782407942*^9, 
   3.819996794601184*^9}, {3.8199976998812647`*^9, 3.81999771922515*^9}, {
   3.819999225527914*^9, 3.81999923796824*^9}, {3.819999296952132*^9, 
   3.819999304139573*^9}, {3.819999363645115*^9, 3.819999383180387*^9}, {
   3.819999427882913*^9, 3.81999956249102*^9}, {3.819999601690683*^9, 
   3.819999668855338*^9}, {3.8199998232673883`*^9, 3.819999824379253*^9}, {
   3.820010168537346*^9, 3.820010170804882*^9}, {3.820010268988675*^9, 
   3.82001028960452*^9}, {3.8200104898507233`*^9, 3.8200105242260523`*^9}, 
   3.82001073785631*^9, {3.82001078649981*^9, 3.8200107915797977`*^9}, 
   3.8200112856128263`*^9, {3.820012367854807*^9, 3.820012384271949*^9}, {
   3.820012436119089*^9, 3.8200124718628483`*^9}, {3.82001250997339*^9, 
   3.820012631797308*^9}, {3.820012978834777*^9, 3.8200129975523148`*^9}, {
   3.820049166965352*^9, 3.8200491689376383`*^9}, {3.820049219895555*^9, 
   3.820049220179744*^9}, {3.820049262822587*^9, 3.820049277221941*^9}, {
   3.820049312574778*^9, 3.82004937836446*^9}, {3.8200494116508017`*^9, 
   3.8200494819556932`*^9}, 3.8200499578429613`*^9, {3.820059802213065*^9, 
   3.820059804272683*^9}, 3.820062220023485*^9, {3.82006591293987*^9, 
   3.820065913562911*^9}, {3.820066173259623*^9, 3.820066180632056*^9}, {
   3.820067111642008*^9, 3.8200671201834173`*^9}, {3.8200672250331497`*^9, 
   3.820067226069477*^9}, {3.820067469136869*^9, 3.820067469804323*^9}, {
   3.820071333775763*^9, 3.8200713895106707`*^9}, {3.8200719376261377`*^9, 
   3.8200719385297318`*^9}, {3.820072431852887*^9, 3.820072432079934*^9}, {
   3.820072712106257*^9, 3.820072833510849*^9}, 3.8200728751691723`*^9, {
   3.820072909376789*^9, 3.820073026851015*^9}, {3.820073298324997*^9, 
   3.82007332157653*^9}, {3.820073378476408*^9, 3.8200734182103243`*^9}, {
   3.820073513486022*^9, 3.820073516630824*^9}, {3.8200738344106894`*^9, 
   3.820073863262355*^9}, {3.820074266288629*^9, 3.82007431992045*^9}, {
   3.820074513211343*^9, 3.820074513384281*^9}, 3.8200748024002123`*^9, {
   3.8200873518047457`*^9, 3.820087416761249*^9}, {3.82008951499931*^9, 
   3.820089540418273*^9}, {3.8200895947017384`*^9, 3.820089614154523*^9}, {
   3.820089671692054*^9, 3.820089673892886*^9}, {3.820089719050879*^9, 
   3.8200897441459427`*^9}, {3.8200904581892357`*^9, 3.820090459044827*^9}, {
   3.820091315463111*^9, 3.820091322292919*^9}, 3.820091469545169*^9, 
   3.820093198424789*^9, {3.8200939535240498`*^9, 3.820093972010573*^9}, {
   3.820094030193304*^9, 3.820094054093375*^9}, 3.820094448447814*^9, {
   3.820094481689445*^9, 3.8200945441050053`*^9}, {3.820094870728079*^9, 
   3.820094877495183*^9}, {3.820097336490657*^9, 3.820097356191868*^9}, {
   3.820136520811891*^9, 3.8201365219485893`*^9}, {3.8206075301482153`*^9, 
   3.8206075464883957`*^9}, {3.820607581422956*^9, 3.820607601490286*^9}, {
   3.820607674849818*^9, 3.820607697283613*^9}, {3.820607745343998*^9, 
   3.8206079496519337`*^9}, {3.82060804112807*^9, 3.820608045466106*^9}, {
   3.820608092417728*^9, 3.820608093066251*^9}, {3.82060824829823*^9, 
   3.820608249446787*^9}, {3.820608349676696*^9, 3.820608379292495*^9}, {
   3.820608924781824*^9, 3.820608959477351*^9}, {3.82060902456024*^9, 
   3.820609039159127*^9}, {3.820609071226432*^9, 3.8206090776164703`*^9}, {
   3.820609283875512*^9, 3.8206093128955107`*^9}, {3.820609357623508*^9, 
   3.820609360179284*^9}, {3.820610642332692*^9, 3.8206107826885853`*^9}, {
   3.820610951499569*^9, 3.820610959018318*^9}, {3.820611377658018*^9, 
   3.820611421318903*^9}, {3.8206114810420237`*^9, 3.820611515421133*^9}, {
   3.8206115558282843`*^9, 3.82061162084688*^9}, {3.8206122991263103`*^9, 
   3.82061233440326*^9}, {3.820612365181838*^9, 3.820612365385119*^9}, {
   3.820612424500498*^9, 3.8206124363119917`*^9}, {3.820612522774241*^9, 
   3.820612565376505*^9}, {3.820659161005834*^9, 3.8206591939564962`*^9}, {
   3.820659732767171*^9, 3.8206597422694902`*^9}, 3.820660484284917*^9, {
   3.8206605745720367`*^9, 3.820660582621502*^9}, {3.820660758793024*^9, 
   3.820660762455966*^9}, {3.820660794987753*^9, 3.820660886927802*^9}, {
   3.82066352465137*^9, 3.820663527727417*^9}, {3.82066596489529*^9, 
   3.820666066586047*^9}, {3.82066610007231*^9, 3.82066610881735*^9}, {
   3.820833805280356*^9, 3.8208339650848627`*^9}, {3.821122010728652*^9, 
   3.8211220264705353`*^9}, 3.821124154366797*^9, {3.821124356517684*^9, 
   3.821124357300346*^9}, {3.8211275788907547`*^9, 3.82112763513624*^9}, {
   3.82112766582898*^9, 3.82112781057786*^9}, {3.82112820796926*^9, 
   3.821128279400498*^9}, {3.8211283209642467`*^9, 3.821128387326363*^9}, {
   3.821128425821052*^9, 3.821128457102881*^9}, 3.821128541803335*^9, {
   3.821128657526388*^9, 3.821128667881559*^9}, {3.8211287062094803`*^9, 
   3.8211287249022408`*^9}, {3.821129137145784*^9, 3.821129148342705*^9}, {
   3.821129229935437*^9, 3.8211292584976873`*^9}, {3.821129380601261*^9, 
   3.821129395243441*^9}, 3.821129430240035*^9, {3.821129486522436*^9, 
   3.8211295312215557`*^9}, {3.821129561299498*^9, 3.821129594860487*^9}, {
   3.821129657256343*^9, 3.82112976365768*^9}, {3.8211298365569963`*^9, 
   3.821129837309475*^9}, {3.821129969234624*^9, 3.821130052524543*^9}, {
   3.821130085117359*^9, 3.8211300971028013`*^9}, {3.82113013620393*^9, 
   3.8211301445177307`*^9}, {3.821130176326377*^9, 3.821130268453106*^9}, {
   3.8211303002809887`*^9, 3.8211303647682123`*^9}, 3.82113090008134*^9, {
   3.821130943121834*^9, 3.821131069347308*^9}, {3.82113144486274*^9, 
   3.821131488804543*^9}, {3.821131834665324*^9, 3.821131900996973*^9}, {
   3.821131951732009*^9, 3.821132038842537*^9}, {3.8211848701824083`*^9, 
   3.8211849542926493`*^9}, {3.821185000962985*^9, 3.821185078496471*^9}, {
   3.821187272744545*^9, 3.8211874969043713`*^9}, {3.82118754094534*^9, 
   3.821187707976972*^9}, {3.821187799759693*^9, 3.8211878084552097`*^9}, {
   3.8211878446692867`*^9, 3.821188068060307*^9}, {3.821188208401092*^9, 
   3.821188416552636*^9}, {3.82119433000629*^9, 3.8211943382578*^9}, {
   3.8211944811932783`*^9, 3.8211944815904903`*^9}, {3.821194756544829*^9, 
   3.8211947592688017`*^9}, {3.821194931031188*^9, 3.821194931769824*^9}, {
   3.821194965430608*^9, 3.821194965900391*^9}, {3.821195368835568*^9, 
   3.821195419290152*^9}, {3.821195516407692*^9, 3.821195521785398*^9}, {
   3.821196606966716*^9, 3.821196612016527*^9}, {3.821196705619318*^9, 
   3.821196710357307*^9}, {3.8211967674059057`*^9, 3.821196813466477*^9}, {
   3.821196847628788*^9, 3.821196868949353*^9}, {3.821197596726575*^9, 
   3.821197657829494*^9}, {3.8211977608812428`*^9, 3.82119781183997*^9}, {
   3.821197864936767*^9, 3.821197871718173*^9}, {3.821200612658639*^9, 
   3.82120061439258*^9}, {3.821200745085747*^9, 3.8212007599386587`*^9}, {
   3.821200868902589*^9, 3.8212008873916187`*^9}, {3.821201247257762*^9, 
   3.821201266641203*^9}, {3.82120203719709*^9, 3.8212020426675043`*^9}, {
   3.821209386632599*^9, 3.821209391824791*^9}, {3.821209585957405*^9, 
   3.821209601457108*^9}, {3.8212161646451*^9, 3.821216166587555*^9}, {
   3.8212161968835487`*^9, 3.821216257128007*^9}, {3.821216528015358*^9, 
   3.821216557115815*^9}, {3.8212165919581633`*^9, 3.821216596094174*^9}, {
   3.821216945166044*^9, 3.8212171678832283`*^9}, {3.821217261434848*^9, 
   3.821217283134863*^9}, {3.821217347334414*^9, 3.821217384288114*^9}, {
   3.821217470804976*^9, 3.821217561343589*^9}, {3.821217597950925*^9, 
   3.821217616098445*^9}, {3.821217655808989*^9, 3.821217686672483*^9}, {
   3.82121777407229*^9, 3.8212178582614727`*^9}, {3.821218036812937*^9, 
   3.821218049582981*^9}, {3.821218182412271*^9, 3.821218227953095*^9}, {
   3.8212198796073313`*^9, 3.8212199346226187`*^9}, {3.8212200626414213`*^9, 
   3.821220063304222*^9}, {3.8212201227815647`*^9, 3.8212201282868643`*^9}, {
   3.821221067736166*^9, 3.8212210799561853`*^9}, {3.8212211138165083`*^9, 
   3.82122113660783*^9}, {3.821221182473605*^9, 3.821221272055347*^9}, {
   3.821221304055291*^9, 3.821221325040956*^9}, {3.8212213655941133`*^9, 
   3.821221541938322*^9}, {3.82122159930582*^9, 3.821221863313319*^9}, {
   3.821221938065214*^9, 3.8212219941189613`*^9}, {3.821222134158554*^9, 
   3.821222154595945*^9}, {3.821222185195661*^9, 3.821222327696171*^9}, {
   3.82122236825688*^9, 3.821222441047573*^9}, {3.821223421023363*^9, 
   3.821223439663389*^9}, {3.821223542760787*^9, 3.821223554733227*^9}, {
   3.821223591012896*^9, 3.821223658328154*^9}, {3.821223714464036*^9, 
   3.821223715130138*^9}, {3.8212237950693827`*^9, 3.8212238432790956`*^9}, {
   3.821224231919643*^9, 3.821224354163538*^9}, {3.821224406077053*^9, 
   3.8212244097046137`*^9}, {3.821224564683652*^9, 3.821224600934463*^9}, {
   3.8212246346478977`*^9, 3.821224635021944*^9}, {3.821227420119029*^9, 
   3.8212274241193457`*^9}, {3.821227477760648*^9, 3.821227493568203*^9}, {
   3.821227554295033*^9, 3.821227562800791*^9}, 3.821227637232562*^9, {
   3.8212278010380983`*^9, 3.82122789320231*^9}, {3.821261236990369*^9, 
   3.8212612608162603`*^9}, {3.821261740376658*^9, 3.821262071889949*^9}, {
   3.8212621161020813`*^9, 3.821262228556889*^9}, {3.8212629745070257`*^9, 
   3.821262992896188*^9}, {3.821264143764081*^9, 3.821264156038476*^9}, 
   3.821264214893214*^9, {3.8212642804864492`*^9, 3.821264286309307*^9}, {
   3.821264321848085*^9, 3.821264357202257*^9}, {3.8212644478760347`*^9, 
   3.821264574048313*^9}, {3.821264613585269*^9, 3.821264661706429*^9}, {
   3.821265068672647*^9, 3.821265088644855*^9}, {3.821265149127448*^9, 
   3.8212651543083477`*^9}, {3.8212652332633743`*^9, 
   3.8212653184569283`*^9}, {3.821265414826612*^9, 3.821265439873767*^9}, {
   3.821265489847663*^9, 3.8212654932046757`*^9}, {3.821265810135874*^9, 
   3.821265878187722*^9}, {3.8212659146098003`*^9, 3.8212659155630407`*^9}, 
   3.8212660010281773`*^9, {3.821266054873212*^9, 3.821266060561119*^9}, {
   3.82126613101959*^9, 3.821266142996983*^9}, 3.82126642691606*^9, {
   3.8212679122722*^9, 3.821267986617318*^9}, {3.821268036997354*^9, 
   3.8212680761416187`*^9}, {3.821268185992482*^9, 3.821268187294711*^9}, {
   3.8212685371565228`*^9, 3.821268538361739*^9}, {3.821268658614972*^9, 
   3.821268661614833*^9}, {3.821268705481553*^9, 3.821268713594935*^9}, {
   3.821268764281197*^9, 3.821268779378072*^9}, {3.821268819712728*^9, 
   3.821268914210305*^9}, {3.821268947322609*^9, 3.821268949393333*^9}, 
   3.821269044078899*^9, 3.82126912348355*^9, {3.821269219747789*^9, 
   3.82126933937423*^9}, {3.821269419083293*^9, 3.8212694795759697`*^9}, {
   3.821269577754085*^9, 3.821269578326968*^9}, {3.821269609720419*^9, 
   3.821269614069309*^9}, {3.821269653148682*^9, 3.8212696774068604`*^9}, {
   3.821269816226457*^9, 3.821269818715887*^9}, {3.821269928509913*^9, 
   3.8212699339312143`*^9}, {3.821269964531761*^9, 3.821270060150895*^9}, {
   3.8212724050856028`*^9, 3.821272414651284*^9}, {3.821272448888019*^9, 
   3.821272549007023*^9}, {3.8212725817514553`*^9, 3.821272626210601*^9}, {
   3.821272676423147*^9, 3.821272732393672*^9}, {3.821272772301591*^9, 
   3.821272773279352*^9}, {3.821273187024054*^9, 3.821273229434766*^9}, {
   3.82127331490965*^9, 3.821273395633395*^9}, {3.8212734652921467`*^9, 
   3.821273471234672*^9}, {3.821273768562337*^9, 3.82127382750369*^9}, 
   3.821273861997954*^9, {3.821273895840191*^9, 3.82127391418955*^9}, {
   3.82127402645044*^9, 3.821274042742909*^9}, 3.8212741220686626`*^9, {
   3.82127416834162*^9, 3.821274177334524*^9}, 3.8212742520225782`*^9, {
   3.8212743541677*^9, 3.821274524182185*^9}, {3.8212745550272913`*^9, 
   3.821274644176609*^9}, {3.821274698151808*^9, 3.821274717359995*^9}, {
   3.82127474893106*^9, 3.82127478184665*^9}, {3.82127484205441*^9, 
   3.821274867449926*^9}, {3.821274940813719*^9, 3.821274964954795*^9}, {
   3.8212750654028997`*^9, 3.821275153944785*^9}, {3.821275229604425*^9, 
   3.821275262448886*^9}, {3.821275329035904*^9, 3.8212753355546*^9}, {
   3.821276181838584*^9, 3.82127620245711*^9}, {3.821276267694469*^9, 
   3.821276271662166*^9}, {3.8212763193652067`*^9, 3.821276349314687*^9}, 
   3.82127680964371*^9, {3.821282897135269*^9, 3.821282920320649*^9}, {
   3.821283026984234*^9, 3.821283033966434*^9}, {3.821283096009275*^9, 
   3.821283136432934*^9}, {3.821283416913643*^9, 3.8212834183772297`*^9}, 
   3.821283603953611*^9, {3.821283655792665*^9, 3.82128369834205*^9}, {
   3.8212837331836147`*^9, 3.8212837721511707`*^9}, {3.821283815599806*^9, 
   3.821283818680378*^9}, {3.821283874845172*^9, 3.821283876446282*^9}, {
   3.8212840949690742`*^9, 3.821284133118472*^9}, {3.821284185332635*^9, 
   3.82128419124864*^9}, {3.821284443552239*^9, 3.821284463652624*^9}, 
   3.821284579438877*^9, {3.821287456829337*^9, 3.8212874579482803`*^9}, {
   3.8212916035104723`*^9, 3.821291603517788*^9}, {3.82129287483219*^9, 
   3.821293015329802*^9}, {3.821293056699943*^9, 3.821293076828205*^9}, {
   3.821293110935425*^9, 3.8212931117670918`*^9}, {3.821293297489931*^9, 
   3.821293345016012*^9}, {3.821293559939165*^9, 3.821293630088441*^9}, {
   3.821293743768235*^9, 3.821293784457389*^9}, {3.821295989022957*^9, 
   3.821296005727099*^9}, {3.821296040753105*^9, 3.821296052825935*^9}, {
   3.821296816620264*^9, 3.821296833164948*^9}, {3.82129689163618*^9, 
   3.821296893250825*^9}, 3.821296942545229*^9, {3.8212970629538307`*^9, 
   3.821297063561677*^9}, {3.821297125484908*^9, 3.8212972250468597`*^9}, {
   3.821297257756974*^9, 3.8212972612546253`*^9}, {3.821297360048441*^9, 
   3.8212974204044333`*^9}, {3.821297998852425*^9, 3.821298006744246*^9}, {
   3.821298070673156*^9, 3.821298108066259*^9}, {3.821298139406314*^9, 
   3.821298149459693*^9}, {3.821298199254601*^9, 3.82129820489573*^9}, {
   3.82129829619151*^9, 3.821298527315621*^9}, {3.8212985620039787`*^9, 
   3.821298582728402*^9}, {3.821298631817883*^9, 3.821298707827221*^9}, {
   3.821298835674768*^9, 3.8212988617735653`*^9}, {3.821298903404996*^9, 
   3.82129899665864*^9}, {3.82129958077637*^9, 3.8212995831171703`*^9}, {
   3.821299911224635*^9, 3.8212999148472557`*^9}, {3.821299953486836*^9, 
   3.821300082676332*^9}, {3.821300866935461*^9, 3.8213008942742167`*^9}, {
   3.821300926763515*^9, 3.8213013876909246`*^9}, {3.821301428459004*^9, 
   3.821301454090321*^9}, {3.8213014933629932`*^9, 3.8213015282488947`*^9}, {
   3.821301575810773*^9, 3.821301704915208*^9}, {3.821301808790608*^9, 
   3.8213018562066813`*^9}, {3.8213018880076857`*^9, 3.821302023118408*^9}, {
   3.821302056601639*^9, 3.821302227690563*^9}, {3.8213022645622683`*^9, 
   3.821302297591414*^9}, 3.8213023917000732`*^9, {3.821302428165948*^9, 
   3.821302442838017*^9}, 3.82130249546624*^9, 3.821302561882245*^9, {
   3.821303063886011*^9, 3.8213030784132843`*^9}, {3.821303209022142*^9, 
   3.821303220239223*^9}, {3.8213034720230503`*^9, 3.821303496121009*^9}, {
   3.8213035269700727`*^9, 3.821303557652623*^9}, {3.821303663301279*^9, 
   3.821303931379837*^9}, {3.8213040071612463`*^9, 3.821304014455976*^9}, {
   3.821304128120364*^9, 3.821304130009131*^9}, {3.821304224911669*^9, 
   3.821304251077248*^9}, {3.8213042975371647`*^9, 3.8213043292959433`*^9}, {
   3.821304386980904*^9, 3.821304483118184*^9}, 3.821304615308427*^9, {
   3.821304732118332*^9, 3.8213047347123137`*^9}, {3.821304772567112*^9, 
   3.82130477462681*^9}, {3.821304811132599*^9, 3.821304843520625*^9}, {
   3.821305055603788*^9, 3.8213051230566177`*^9}, {3.821305206311763*^9, 
   3.8213052609350863`*^9}, {3.821305317225381*^9, 3.821305388932836*^9}, {
   3.8213054192135143`*^9, 3.821305421845995*^9}, {3.8213054792664623`*^9, 
   3.8213055068593407`*^9}, {3.821305739827751*^9, 3.821305748608198*^9}, {
   3.821306586412912*^9, 3.821306708323601*^9}, {3.8213082217348948`*^9, 
   3.821308338190336*^9}, {3.8213084038167887`*^9, 3.821308412378953*^9}, 
   3.8213084728019342`*^9, {3.821308571696631*^9, 3.821308584741302*^9}, {
   3.821308619144186*^9, 3.821308631798534*^9}, {3.821309574182665*^9, 
   3.8213095932103148`*^9}, {3.821309651267852*^9, 3.821309675186376*^9}, {
   3.821311921837966*^9, 3.821311994356707*^9}, {3.821312585688675*^9, 
   3.821312651647381*^9}, 3.821313529771957*^9, {3.8213136421308737`*^9, 
   3.8213136513470917`*^9}, {3.821313694051917*^9, 3.821313702248212*^9}, {
   3.821313895922311*^9, 3.8213138966196823`*^9}, 3.821313999139977*^9, {
   3.8213141423017282`*^9, 3.8213142440462513`*^9}, {3.821314300501019*^9, 
   3.8213143677282867`*^9}, {3.8213144663288193`*^9, 3.821314491754677*^9}, {
   3.821314699784984*^9, 3.821314714765152*^9}, {3.82131482338798*^9, 
   3.821314923331943*^9}, {3.8213149618260403`*^9, 3.82131496365723*^9}, {
   3.82134812417072*^9, 3.8213481698862457`*^9}, {3.821348304768733*^9, 
   3.821348346848481*^9}, {3.8213483772228127`*^9, 3.821348380026485*^9}, {
   3.821349307096912*^9, 3.821349339383326*^9}, {3.821349470977804*^9, 
   3.821349473112247*^9}, {3.821349516998012*^9, 3.821349519151144*^9}, {
   3.821349825278638*^9, 3.821349907550544*^9}, {3.821349999591516*^9, 
   3.8213500073133287`*^9}, {3.821350045219281*^9, 3.821350077199432*^9}, {
   3.821350685157487*^9, 3.821350688181204*^9}, {3.821350746976807*^9, 
   3.821350811316869*^9}, {3.8213510992595453`*^9, 3.821351116570788*^9}, 
   3.82135123445889*^9, {3.821351314756735*^9, 3.821351323859559*^9}, {
   3.821351399025517*^9, 3.821351404440699*^9}, {3.821351449275771*^9, 
   3.821351457460388*^9}, {3.8213518609402323`*^9, 3.821351914690716*^9}, {
   3.821351975644431*^9, 3.821352005268046*^9}, {3.821352040444201*^9, 
   3.821352092215302*^9}, {3.82135215002495*^9, 3.821352198041027*^9}, 
   3.821352424478066*^9, {3.821352512601671*^9, 3.821352564140283*^9}, {
   3.821352661577017*^9, 3.8213527052161427`*^9}, {3.821352808457418*^9, 
   3.8213528090526743`*^9}, {3.821352888067348*^9, 3.821352891076695*^9}, {
   3.82135294608025*^9, 3.82135300981994*^9}, {3.821353084621985*^9, 
   3.821353102093987*^9}, 3.8213531702603903`*^9, {3.82135326681555*^9, 
   3.821353268207623*^9}, {3.8213533874624157`*^9, 3.821353465046639*^9}, {
   3.8213552838729*^9, 3.821355369345817*^9}, {3.821355425302647*^9, 
   3.82135550395056*^9}, {3.821355578012484*^9, 3.8213556207661743`*^9}, {
   3.821355677627329*^9, 3.821355766360051*^9}, {3.8213558572150173`*^9, 
   3.821355953061573*^9}, {3.821356002551182*^9, 3.821356012077899*^9}, {
   3.821356163637109*^9, 3.821356179621828*^9}, {3.8213562596594763`*^9, 
   3.821356265817161*^9}, 3.821356310255755*^9, {3.821357128919455*^9, 
   3.821357192127597*^9}, {3.821357370577284*^9, 3.8213573738123837`*^9}, {
   3.8213574645737762`*^9, 3.821357475129385*^9}, {3.821357579789654*^9, 
   3.821357587181787*^9}, {3.821357631337631*^9, 3.821357688337285*^9}, {
   3.821357874586816*^9, 3.821357877479006*^9}, 3.8213579336175423`*^9, {
   3.82135825759336*^9, 3.8213582878359613`*^9}, {3.821358557014818*^9, 
   3.821358582590629*^9}, {3.821358801003833*^9, 3.821358807200369*^9}, {
   3.8213591710498247`*^9, 3.8213593030913153`*^9}, {3.8213593486547728`*^9, 
   3.821359361851672*^9}, {3.821360284392695*^9, 3.821360346492249*^9}, {
   3.821360496274392*^9, 3.82136054550391*^9}, {3.8213606116314*^9, 
   3.8213606808460627`*^9}, {3.821360735154413*^9, 3.821360842606464*^9}, {
   3.8213608809264603`*^9, 3.8213608955049057`*^9}, {3.821361230100338*^9, 
   3.821361251756864*^9}, {3.821361394702981*^9, 3.821361403641611*^9}, {
   3.821361541711258*^9, 3.8213615419683332`*^9}, 3.82138771271845*^9, {
   3.8213879117218323`*^9, 3.821387963684429*^9}, {3.821388144301093*^9, 
   3.821388151067185*^9}, {3.821388455472539*^9, 3.8213885281311827`*^9}, {
   3.821393468021667*^9, 3.821393551180838*^9}, {3.8214281588948812`*^9, 
   3.82142816716772*^9}, {3.821428219497097*^9, 3.8214282280716267`*^9}, 
   3.821428258524569*^9, {3.821442304621564*^9, 3.8214423185687*^9}, {
   3.821442693180031*^9, 3.821442728187347*^9}, {3.8214427632262487`*^9, 
   3.821442785034444*^9}, {3.8214428274141817`*^9, 3.821442829157868*^9}, {
   3.821442924957192*^9, 3.82144294768073*^9}, 3.8214429826952467`*^9, 
   3.82144304138881*^9, 3.821443094576693*^9, {3.8214438956847887`*^9, 
   3.821443904607499*^9}, {3.821443977412806*^9, 3.821444061841948*^9}, 
   3.821444106203004*^9, {3.8214442386208153`*^9, 3.821444302195853*^9}, {
   3.821444406468622*^9, 3.8214444457395678`*^9}, {3.8214444794881973`*^9, 
   3.821444621626652*^9}, {3.8214447528221827`*^9, 3.8214447568942833`*^9}, {
   3.821465371242161*^9, 3.821465372585243*^9}, {3.821467884889452*^9, 
   3.821467887895997*^9}, {3.821471994180271*^9, 3.821472095823008*^9}, {
   3.821543712225903*^9, 3.821543742353993*^9}, {3.8215440950179033`*^9, 
   3.821544102500771*^9}, {3.82182132762143*^9, 3.821821329753318*^9}, {
   3.821822574661985*^9, 3.8218226135232773`*^9}, {3.821867441050082*^9, 
   3.82186748811136*^9}, {3.821867543007115*^9, 3.821867544344965*^9}, 
   3.82199081433885*^9, {3.821990854571039*^9, 3.8219909876176453`*^9}, {
   3.8219911200360327`*^9, 3.8219911709504013`*^9}, {3.821991212721281*^9, 
   3.821991244110292*^9}, {3.822494993225131*^9, 3.8224950930028067`*^9}, {
   3.822495234816004*^9, 3.8224952520328712`*^9}, {3.822495615841545*^9, 
   3.822495618385828*^9}, {3.822495659105051*^9, 3.822495680784758*^9}, {
   3.822501697462603*^9, 3.8225017076615*^9}, {3.8225039352801657`*^9, 
   3.822503951643959*^9}, {3.822503985393251*^9, 3.8225040417684*^9}, {
   3.822504175062481*^9, 3.8225041873897753`*^9}, {3.8225044390331078`*^9, 
   3.8225044490780573`*^9}, {3.822505771655344*^9, 3.822505781673216*^9}, {
   3.8225058707107983`*^9, 3.8225058769209642`*^9}, {3.822505909596119*^9, 
   3.8225059794115458`*^9}, {3.8225068310603437`*^9, 3.822506852699492*^9}, {
   3.822507598812133*^9, 3.822507613104855*^9}, {3.822507649122655*^9, 
   3.822507660711089*^9}, 3.8225084660761833`*^9, {3.822512722835878*^9, 
   3.822512782458479*^9}, {3.822515190222703*^9, 3.822515213229698*^9}, {
   3.822515404232964*^9, 3.822515407440556*^9}, {3.822515467599269*^9, 
   3.822515481132218*^9}, {3.822515539402232*^9, 3.822515555425499*^9}, {
   3.822515606565649*^9, 3.822515606873128*^9}, {3.822515683677041*^9, 
   3.822515690424334*^9}, {3.822516080478683*^9, 3.822516178384655*^9}, {
   3.822516211735436*^9, 3.822516225537395*^9}, {3.8225162598180037`*^9, 
   3.822516263387796*^9}, {3.822516452520186*^9, 3.822516520204048*^9}, {
   3.82258615898289*^9, 3.822586190842078*^9}, {3.822587044102384*^9, 
   3.822587064796838*^9}, {3.8225874140323772`*^9, 3.8225874157492867`*^9}, {
   3.822588047110244*^9, 3.822588052559721*^9}, {3.822588589006619*^9, 
   3.822588590580694*^9}, {3.822588628061152*^9, 3.8225886293837214`*^9}, {
   3.822589668461637*^9, 3.822589688045102*^9}, {3.822592007630946*^9, 
   3.822592031012388*^9}, {3.822592072853959*^9, 3.822592113572423*^9}, {
   3.822592388668066*^9, 3.822592389854203*^9}, {3.8225924219496613`*^9, 
   3.822592449924629*^9}, {3.822592534186542*^9, 3.8225925618613997`*^9}, {
   3.8225925982153883`*^9, 3.822592640418906*^9}, {3.822592718303212*^9, 
   3.82259273442292*^9}, {3.822593353105991*^9, 3.822593476978498*^9}, {
   3.8225935095327053`*^9, 3.822593652270907*^9}, {3.82276525327619*^9, 
   3.822765255293849*^9}, {3.822765392953226*^9, 3.8227654392720537`*^9}, {
   3.822765478983107*^9, 3.822765566691134*^9}, {3.822765634130836*^9, 
   3.822765635538004*^9}, {3.822765690763732*^9, 3.822765942232153*^9}, {
   3.822765991861195*^9, 3.8227660480450783`*^9}, {3.822766096943234*^9, 
   3.822766098920226*^9}, {3.8227661641123047`*^9, 3.8227662305822783`*^9}, {
   3.822766288550149*^9, 3.8227662888719788`*^9}, {3.8227663899957047`*^9, 
   3.822766504886735*^9}, {3.822766597983417*^9, 3.822766598351125*^9}, {
   3.822766628826849*^9, 3.822766637027532*^9}, {3.8227667237421837`*^9, 
   3.822766742408332*^9}, {3.822767042854466*^9, 3.82276711844909*^9}, {
   3.8227671490925093`*^9, 3.8227671659508*^9}, {3.82276722067552*^9, 
   3.822767244972528*^9}, 3.8227672762319937`*^9, {3.822767331925885*^9, 
   3.822767342641914*^9}, {3.82276755416739*^9, 3.822767554628374*^9}, {
   3.8227678567278357`*^9, 3.822767884465043*^9}, {3.822767975950966*^9, 
   3.822768199950789*^9}, {3.822768236541779*^9, 3.822768244748053*^9}, {
   3.82276836273488*^9, 3.8227684449537973`*^9}, {3.822768477344377*^9, 
   3.8227685021865473`*^9}, {3.822768569152307*^9, 3.8227686574780693`*^9}, {
   3.8227687099823637`*^9, 3.822768714251721*^9}, {3.8227687543849773`*^9, 
   3.822768765290518*^9}, {3.822768965915378*^9, 3.822769103583025*^9}, {
   3.822769178709004*^9, 3.8227692817877913`*^9}, {3.822769389502707*^9, 
   3.8227693910444813`*^9}, {3.8227694250471067`*^9, 
   3.8227694574464397`*^9}, {3.822769615534672*^9, 3.822769642971756*^9}, {
   3.822769678043614*^9, 3.822769680182529*^9}, {3.8227697325734367`*^9, 
   3.8227697643887987`*^9}, {3.822769798625085*^9, 3.8227698011922493`*^9}, {
   3.822769864353509*^9, 3.822769872730103*^9}, {3.822769924676528*^9, 
   3.822769925686647*^9}, {3.822770220125217*^9, 3.822770227295835*^9}, {
   3.82277039369071*^9, 3.822770396011196*^9}, {3.8227705438541927`*^9, 
   3.8227705506596727`*^9}, {3.82277063129852*^9, 3.822770634645866*^9}, {
   3.822770734215023*^9, 3.822770735880397*^9}, {3.8227708004876432`*^9, 
   3.822770810731697*^9}, {3.8227708728357267`*^9, 3.8227708738360043`*^9}, {
   3.822770911551949*^9, 3.822770912305571*^9}, {3.822770943710021*^9, 
   3.822770944351471*^9}, {3.8227710770771933`*^9, 3.822771078443231*^9}, {
   3.822771220210421*^9, 3.822771222320072*^9}, {3.822771372092721*^9, 
   3.822771373034087*^9}, {3.822772324980081*^9, 3.8227723620768023`*^9}, {
   3.82277259217983*^9, 3.822772623603525*^9}, {3.822773465685968*^9, 
   3.82277346806444*^9}, {3.822773544378991*^9, 3.822773566650971*^9}, {
   3.822773647547339*^9, 3.822773651188512*^9}, {3.822773728726441*^9, 
   3.8227737494626083`*^9}, {3.822773784073443*^9, 3.8227738841949778`*^9}, {
   3.82277404609307*^9, 3.822774308284463*^9}, {3.8227743775776043`*^9, 
   3.822774435278317*^9}, {3.822774512621724*^9, 3.822774513891156*^9}, {
   3.822774770114532*^9, 3.8227747703941383`*^9}, {3.822775898202375*^9, 
   3.822775899474823*^9}, {3.822776293180382*^9, 3.822776294158725*^9}, {
   3.822776371264763*^9, 3.822776399217691*^9}, {3.822776546732705*^9, 
   3.822776564217957*^9}, {3.82277663552491*^9, 3.822776661414197*^9}, {
   3.822776725647094*^9, 3.822776726898096*^9}, {3.822777411473275*^9, 
   3.822777414378894*^9}, {3.8227774532577877`*^9, 3.822777457096243*^9}, {
   3.822780653982757*^9, 3.822780752658444*^9}, {3.8227808037370367`*^9, 
   3.822780834383005*^9}, {3.822781032961485*^9, 3.8227810487452803`*^9}, {
   3.8227810865331697`*^9, 3.8227811132056828`*^9}, {3.822781170320176*^9, 
   3.8227811782517157`*^9}, {3.822786380523683*^9, 3.822786380796595*^9}, {
   3.822807292326948*^9, 3.822807371915476*^9}, {3.822807528659994*^9, 
   3.822807529612527*^9}, {3.822810935714233*^9, 3.822811020859233*^9}, {
   3.822811115299499*^9, 3.822811136567137*^9}, {3.822811292877494*^9, 
   3.822811403225095*^9}, {3.822811447903882*^9, 3.8228114487596397`*^9}, {
   3.8228115784231443`*^9, 3.822811593892089*^9}, {3.822811647037387*^9, 
   3.82281187269582*^9}, {3.822811911302072*^9, 3.8228119724637527`*^9}, {
   3.822812035462675*^9, 3.822812327751745*^9}, {3.822812660971586*^9, 
   3.822813018503661*^9}, {3.822813068407493*^9, 3.82281312202595*^9}, {
   3.82281322245079*^9, 3.8228133234193563`*^9}, {3.822813549986919*^9, 
   3.822813551804182*^9}, {3.8228136896234913`*^9, 3.822813696228263*^9}, {
   3.822813978918117*^9, 3.822813995065452*^9}, {3.822818244623843*^9, 
   3.822818246243166*^9}, {3.822824833363448*^9, 3.822824836626668*^9}, {
   3.822825067909801*^9, 3.822825068813911*^9}, {3.822825119543256*^9, 
   3.822825126889475*^9}, {3.822826378113462*^9, 3.822826438189413*^9}, {
   3.822826604997801*^9, 3.822826635881621*^9}, {3.822826897327634*^9, 
   3.822826912351396*^9}, {3.822827075438588*^9, 3.8228270773488894`*^9}, {
   3.822828107546652*^9, 3.822828348305471*^9}, {3.822828430719534*^9, 
   3.822828451439538*^9}, {3.822828702623497*^9, 3.8228287572377777`*^9}, {
   3.822828873723413*^9, 3.8228289778340282`*^9}, {3.822829053307859*^9, 
   3.822829061532229*^9}, {3.822829475923417*^9, 3.822829498730929*^9}, {
   3.822829847786668*^9, 3.8228299388528748`*^9}, {3.8228305052879963`*^9, 
   3.8228305082409983`*^9}, {3.822830654722733*^9, 3.822830696041337*^9}, {
   3.822830892649048*^9, 3.822830896536841*^9}, {3.822831010234757*^9, 
   3.822831035406107*^9}, {3.822831510102559*^9, 3.8228315105205717`*^9}, {
   3.8228319436931953`*^9, 3.822831952833459*^9}, {3.822832127321341*^9, 
   3.822832170178246*^9}, {3.822832200329175*^9, 3.822832228924795*^9}, {
   3.822832618094421*^9, 3.8228326818884*^9}, {3.822832719070854*^9, 
   3.82283278148923*^9}, {3.822832855415099*^9, 3.822832907008849*^9}, {
   3.822832975354504*^9, 3.822833108404776*^9}, {3.822833153860446*^9, 
   3.8228333328666477`*^9}, {3.822833389416542*^9, 3.822833389555606*^9}, {
   3.8228335392548437`*^9, 3.822833568475313*^9}, {3.8228336751849613`*^9, 
   3.822833675631822*^9}, {3.8228337445100927`*^9, 3.8228337446529617`*^9}, {
   3.8228337885216017`*^9, 3.822833940430197*^9}, {3.8228340824961033`*^9, 
   3.822834084447257*^9}, {3.822834279480749*^9, 3.822834281059432*^9}, {
   3.8228344837975073`*^9, 3.8228345320451202`*^9}, {3.822834618976022*^9, 
   3.822834639980318*^9}, {3.822834899273677*^9, 3.82283490929919*^9}, {
   3.8228350047484503`*^9, 3.8228350468688517`*^9}, {3.822835081148922*^9, 
   3.822835086856118*^9}, {3.822835117576354*^9, 3.8228351528587303`*^9}, {
   3.8228353614453382`*^9, 3.8228354307814074`*^9}, {3.8228357167238913`*^9, 
   3.822835739607747*^9}, {3.822836270246211*^9, 3.822836276044056*^9}, {
   3.8228366306218557`*^9, 3.822836673418763*^9}, {3.822837932053529*^9, 
   3.822837957798931*^9}, {3.822838195370408*^9, 3.8228381958749943`*^9}, {
   3.822838233212042*^9, 3.8228382798874273`*^9}, {3.82283832596813*^9, 
   3.8228384422869053`*^9}, {3.8228384766063147`*^9, 3.822838480468131*^9}, {
   3.8228389023712273`*^9, 3.8228389950290127`*^9}, {3.8228392214044037`*^9, 
   3.822839225079582*^9}, {3.8228394608348303`*^9, 3.8228395037029676`*^9}, {
   3.822839534559169*^9, 3.822839617453252*^9}, {3.822839698682331*^9, 
   3.822839724068959*^9}, 3.822850146074215*^9, {3.822851603713711*^9, 
   3.822851604781577*^9}, {3.82285163506266*^9, 3.822851637615608*^9}, {
   3.822858248204705*^9, 3.822858256081233*^9}, {3.8228583211661797`*^9, 
   3.8228583252021933`*^9}, 3.822858886791008*^9, {3.822859734159089*^9, 
   3.822859750926794*^9}, {3.822860077876883*^9, 3.822860079043867*^9}, {
   3.822860223695606*^9, 3.822860229953556*^9}, {3.822861735456339*^9, 
   3.8228617695612707`*^9}, {3.8234201142328863`*^9, 3.823420116534828*^9}, {
   3.8234202959007063`*^9, 3.823420419255557*^9}, 3.8234215780034513`*^9, 
   3.823439359210102*^9, 3.8234394256015587`*^9, {3.823439571011128*^9, 
   3.823439603146224*^9}, {3.8234397679096937`*^9, 3.823439768701622*^9}, {
   3.823445711988881*^9, 3.82344571220826*^9}, 3.823528602098598*^9, {
   3.823529190517065*^9, 3.8235291908447866`*^9}, {3.823532524148479*^9, 
   3.823532617946772*^9}, {3.823532739198613*^9, 3.823532786694042*^9}, {
   3.8235328329185133`*^9, 3.823532841032249*^9}, 3.823534490532179*^9, {
   3.8235345420656757`*^9, 3.823534542391657*^9}, {3.823534806279792*^9, 
   3.823534855104854*^9}, {3.823534980588543*^9, 3.8235349927926064`*^9}, {
   3.823535067098454*^9, 3.8235350896994743`*^9}, {3.823535142015245*^9, 
   3.823535210550267*^9}, {3.823535693614765*^9, 3.8235357309302063`*^9}, 
   3.82353591960604*^9, {3.8235367601068983`*^9, 3.823536903666932*^9}, {
   3.823549947241047*^9, 3.823550021747134*^9}, {3.823550058485005*^9, 
   3.8235500713815813`*^9}, {3.8235501469810047`*^9, 
   3.8235501868204203`*^9}, {3.82355021917388*^9, 3.823550335743696*^9}, {
   3.823550380202187*^9, 3.823550388476039*^9}, {3.823550503993421*^9, 
   3.8235506472002487`*^9}, {3.82355094339145*^9, 3.8235509490611134`*^9}, {
   3.823551044524177*^9, 3.823551084140901*^9}, {3.823551121047875*^9, 
   3.823551128038656*^9}, {3.823551158498344*^9, 3.823551160362502*^9}, {
   3.823551194751533*^9, 3.823551405062641*^9}, {3.823551493188328*^9, 
   3.823551495909911*^9}, {3.8235515286699533`*^9, 3.823551681048366*^9}, {
   3.823551745577896*^9, 3.823551750540395*^9}, {3.8235518046681643`*^9, 
   3.82355187730337*^9}, {3.823552018763588*^9, 3.823552041263732*^9}, {
   3.823552089139554*^9, 3.8235521001460533`*^9}, {3.82355214176514*^9, 
   3.823552156659446*^9}, {3.823552250236888*^9, 3.823552266748666*^9}, {
   3.823552414589753*^9, 3.8235524398298883`*^9}, {3.8235525427326937`*^9, 
   3.8235526131660833`*^9}, {3.823552667555132*^9, 3.82355266901045*^9}, {
   3.823583313840302*^9, 3.8235833170226717`*^9}, {3.823583795124588*^9, 
   3.8235837998742533`*^9}, {3.823584955460669*^9, 3.823584956387795*^9}, {
   3.823585030646481*^9, 3.823585043592183*^9}, {3.82358516658811*^9, 
   3.823585168367907*^9}, {3.8235856677280607`*^9, 3.823585668444004*^9}, {
   3.823585702203719*^9, 3.823585794500784*^9}, {3.823586130571974*^9, 
   3.8235861345335913`*^9}, {3.8235861697365522`*^9, 3.823586316474668*^9}, {
   3.823586977000691*^9, 3.823587143427211*^9}, 3.8235871775804787`*^9, {
   3.823588193757373*^9, 3.823588377355896*^9}, {3.823588688060123*^9, 
   3.823588988344674*^9}, {3.823589025638957*^9, 3.823589057099394*^9}, {
   3.823589094631966*^9, 3.823589181808312*^9}, {3.8235892329753647`*^9, 
   3.823589277074695*^9}, {3.823589312466261*^9, 3.823589313488977*^9}, 
   3.823590086553472*^9, {3.823590989410645*^9, 3.8235912012893047`*^9}, {
   3.8235912713011293`*^9, 3.823591278251439*^9}, {3.823591416081067*^9, 
   3.823591472110351*^9}, {3.8235919674000807`*^9, 3.823592016243621*^9}, {
   3.823592088963039*^9, 3.8235921890365458`*^9}, {3.82359375568327*^9, 
   3.823594086948016*^9}, 3.823594262121002*^9, {3.823594530255805*^9, 
   3.823594533830085*^9}, {3.8235945754163*^9, 3.823594609735675*^9}, 
   3.823594662067377*^9, {3.823595322452907*^9, 3.8235953307636013`*^9}, {
   3.823595625851141*^9, 3.823595731377769*^9}, {3.823597518771435*^9, 
   3.8235975258230457`*^9}, {3.823597744206455*^9, 3.823597762570114*^9}, {
   3.823599628719244*^9, 3.823599783860278*^9}, {3.82359982645783*^9, 
   3.823599843157984*^9}, {3.823599885273264*^9, 3.823599888456986*^9}, {
   3.823601042952463*^9, 3.82360109260222*^9}, {3.823601127683498*^9, 
   3.823601128346681*^9}, {3.823601414610077*^9, 3.823601419061632*^9}, {
   3.823601497758299*^9, 3.8236014986109324`*^9}, 3.823604625200027*^9, 
   3.823604716366366*^9, {3.823604812483136*^9, 3.82360481906561*^9}, 
   3.823604853163741*^9, {3.823604990999295*^9, 3.823605025033395*^9}, {
   3.823605313250412*^9, 3.823605363912342*^9}, 3.823606079404675*^9, {
   3.823609264123804*^9, 3.823609373291404*^9}, {3.823610453431542*^9, 
   3.823610520429449*^9}, {3.8236111824019403`*^9, 3.8236112269252863`*^9}, {
   3.82361192469341*^9, 3.8236119250035543`*^9}, {3.823613849541223*^9, 
   3.8236138526859694`*^9}, {3.823613882957337*^9, 3.82361389924866*^9}, {
   3.8236139358092947`*^9, 3.82361399126153*^9}, {3.8236142201058483`*^9, 
   3.8236142219686604`*^9}, {3.823614415821213*^9, 3.823614419856247*^9}, {
   3.8236144535000963`*^9, 3.823614495808261*^9}, {3.8236146126213903`*^9, 
   3.823614623631727*^9}, {3.823616558748362*^9, 3.823616564333705*^9}, {
   3.823616613205838*^9, 3.823616613503994*^9}, {3.823621391154076*^9, 
   3.823621397879694*^9}, {3.82363307047762*^9, 3.823633099546299*^9}, {
   3.823633178590507*^9, 3.8236331822813253`*^9}, {3.823633226462573*^9, 
   3.823633227721933*^9}, {3.8236343816840143`*^9, 3.823634381844029*^9}, {
   3.8236414558123713`*^9, 3.823641479112693*^9}, {3.823670304495624*^9, 
   3.823670321274777*^9}, {3.8236703750484333`*^9, 3.823670378335526*^9}, {
   3.823684265294132*^9, 3.823684318309147*^9}, {3.8236907462047977`*^9, 
   3.823690765023693*^9}, {3.823695011472039*^9, 3.823695044502091*^9}, {
   3.823697246781299*^9, 3.8236972648541594`*^9}, {3.823697304468512*^9, 
   3.8236973551884727`*^9}, {3.823697495508532*^9, 3.8236975143772793`*^9}, {
   3.82371077612574*^9, 3.823710779031505*^9}, {3.823710816969275*^9, 
   3.823710843755125*^9}, {3.823711162437264*^9, 3.8237112249400806`*^9}, {
   3.8237112583187*^9, 3.8237112624347677`*^9}, {3.82371132132176*^9, 
   3.8237114816192102`*^9}, {3.823711721830717*^9, 3.823711749229286*^9}, {
   3.823711800624652*^9, 3.823711834066428*^9}, {3.823711937445529*^9, 
   3.8237119580463543`*^9}, {3.823712052837397*^9, 3.823712081049726*^9}, {
   3.823713575695407*^9, 3.823713577351568*^9}, {3.8237141967582283`*^9, 
   3.823714239793366*^9}, {3.823716209086113*^9, 3.8237162428518248`*^9}, {
   3.823716766563403*^9, 3.823716773840096*^9}, {3.823716809616623*^9, 
   3.8237168315193253`*^9}, {3.823717453016507*^9, 3.823717453621161*^9}, {
   3.8237174863788443`*^9, 3.823717489430715*^9}, {3.8237186913741007`*^9, 
   3.823718697426566*^9}, {3.8237230920443563`*^9, 3.823723105257889*^9}, {
   3.823725093655446*^9, 3.8237251079551973`*^9}, {3.823725333412766*^9, 
   3.823725341694599*^9}, {3.823751948506546*^9, 3.823751951671986*^9}, {
   3.823752779074217*^9, 3.8237528071378727`*^9}, {3.82375283911469*^9, 
   3.823752864136467*^9}, {3.823753404879815*^9, 3.8237534074533463`*^9}, 
   3.823754335899004*^9, {3.823756031917647*^9, 3.823756038125533*^9}, {
   3.823756945021174*^9, 3.8237569458018713`*^9}, {3.82375704973342*^9, 
   3.823757050592787*^9}, {3.823768495754774*^9, 3.823768504422738*^9}, {
   3.823770567899536*^9, 3.823770668324643*^9}, {3.8237709989798403`*^9, 
   3.823771000212308*^9}, {3.823771341246592*^9, 3.823771347732224*^9}, {
   3.8237714071871843`*^9, 3.823771415265832*^9}, {3.823779515901339*^9, 
   3.823779801118269*^9}, {3.8237806249935102`*^9, 3.823780644442745*^9}, {
   3.823788013380501*^9, 3.8237880340513773`*^9}, {3.823940299964137*^9, 
   3.82394030009993*^9}, {3.823943013758355*^9, 3.8239430489228287`*^9}, {
   3.823943141468729*^9, 3.823943148953133*^9}, {3.8239432453301086`*^9, 
   3.823943284828331*^9}, 3.823943520202198*^9, {3.8239451044003468`*^9, 
   3.823945107899839*^9}, {3.823953610163478*^9, 3.8239536163478947`*^9}, {
   3.8239539068149567`*^9, 3.8239539099165077`*^9}, {3.8239546966011972`*^9, 
   3.82395471246767*^9}, {3.8240455370156803`*^9, 3.8240455464411917`*^9}, {
   3.8240455793292427`*^9, 3.824045581726969*^9}, 3.824045621233227*^9, {
   3.824045674793413*^9, 3.82404571904592*^9}, {3.8240457650120573`*^9, 
   3.824045777589467*^9}, {3.824045885525251*^9, 3.824045907596431*^9}, {
   3.824046056140748*^9, 3.8240460791967297`*^9}, {3.8240464124232197`*^9, 
   3.82404644271762*^9}, {3.824052759736142*^9, 3.824052760488967*^9}, {
   3.824052821102157*^9, 3.824052832225107*^9}, {3.824056746689221*^9, 
   3.8240567473349257`*^9}, {3.824056886936778*^9, 3.824056887066123*^9}, {
   3.824056939808653*^9, 3.8240569956151648`*^9}, {3.82406028566057*^9, 
   3.824060318180421*^9}, {3.824060429351767*^9, 3.824060430882636*^9}, {
   3.824060616341539*^9, 3.824060625510305*^9}, {3.824064064015003*^9, 
   3.824064065601905*^9}, {3.8240641511933002`*^9, 3.824064162014756*^9}, {
   3.824064201539193*^9, 3.82406425216083*^9}, 3.8240643249580107`*^9, {
   3.8240647894261703`*^9, 3.8240649040255537`*^9}, {3.824065035403655*^9, 
   3.824065140094378*^9}, {3.824065175655686*^9, 3.824065209038598*^9}, {
   3.824115458225988*^9, 3.824115507935285*^9}, {3.824124959230843*^9, 
   3.8241249673172817`*^9}, {3.8241276731701183`*^9, 3.824127697382465*^9}, {
   3.824129822414916*^9, 3.824129830944118*^9}, {3.824129893302397*^9, 
   3.824129914483831*^9}, {3.82413044394466*^9, 3.824130452417828*^9}, 
   3.824131530961121*^9, {3.824134345283375*^9, 3.824134388683681*^9}, {
   3.82413490953441*^9, 3.824135158362446*^9}, {3.8241351917700043`*^9, 
   3.824135237535748*^9}, {3.824135273513978*^9, 3.824135321577793*^9}, {
   3.82413819751128*^9, 3.824138205515108*^9}, {3.824138237955942*^9, 
   3.824138241242322*^9}, {3.824139575163011*^9, 3.824139609113576*^9}, {
   3.8241417865138702`*^9, 3.824142147913919*^9}, 3.824142848529324*^9, {
   3.824188166658251*^9, 3.824188166971436*^9}, {3.824188612592845*^9, 
   3.824188617904533*^9}, {3.824193642276539*^9, 3.824193642766398*^9}, {
   3.824195621161024*^9, 3.8241956212857323`*^9}, {3.824196652159816*^9, 
   3.824196744942978*^9}, {3.8241977272346697`*^9, 3.824197752481512*^9}, {
   3.824198501450794*^9, 3.824198568390031*^9}, {3.824200863055756*^9, 
   3.824200872214259*^9}, {3.824210108544971*^9, 3.824210126101013*^9}, 
   3.824212263528141*^9, {3.8242142984526567`*^9, 3.824214318266594*^9}, {
   3.8242202667719584`*^9, 3.824220268065528*^9}, {3.8242205083477297`*^9, 
   3.824220522208424*^9}, {3.824223900400037*^9, 3.824223900972487*^9}, {
   3.824294966128542*^9, 3.824295060307137*^9}, {3.824295096461597*^9, 
   3.824295101805642*^9}, {3.824295153252967*^9, 3.8242951587275753`*^9}, {
   3.824295207692618*^9, 3.824295236618284*^9}, {3.824296061712043*^9, 
   3.824296091066305*^9}, {3.824296328159781*^9, 3.824296336986953*^9}, {
   3.8242963755841618`*^9, 3.824296384145405*^9}, {3.8242985693838663`*^9, 
   3.824298574184946*^9}, {3.824298848405962*^9, 3.824298867168269*^9}, {
   3.824299242639201*^9, 3.824299243459223*^9}, {3.824299453365321*^9, 
   3.8242994655608892`*^9}, {3.8242995042933397`*^9, 
   3.8242995110406427`*^9}, {3.8242997606260033`*^9, 3.824299764220682*^9}, {
   3.8243005573528643`*^9, 3.82430055881691*^9}, {3.824300611111121*^9, 
   3.8243006128446836`*^9}, {3.8243006950803127`*^9, 
   3.8243007329161654`*^9}, {3.824300935748876*^9, 3.824300978553939*^9}, {
   3.824301157157516*^9, 3.824301159081505*^9}, {3.824301220531694*^9, 
   3.8243012258766813`*^9}, {3.824302070628528*^9, 3.824302081461019*^9}, {
   3.824302365326556*^9, 3.824302464646496*^9}, {3.824302543982318*^9, 
   3.824302555306704*^9}, {3.8243027797171926`*^9, 3.824302783559651*^9}, {
   3.8243036244157248`*^9, 3.824303640360798*^9}, {3.824303705337516*^9, 
   3.824303744933778*^9}, {3.824303836096053*^9, 3.824303885286385*^9}, {
   3.8243039232558413`*^9, 3.824303992873065*^9}, 3.8243046014624443`*^9, {
   3.824304721423376*^9, 3.8243047255186443`*^9}, {3.824304761451281*^9, 
   3.82430479234863*^9}, {3.824305559485857*^9, 3.8243055666149*^9}, {
   3.824306197288363*^9, 3.8243062468901663`*^9}, {3.824307064637556*^9, 
   3.824307066870605*^9}, {3.824307371132061*^9, 3.82430737504605*^9}, {
   3.824307407346196*^9, 3.824307415582924*^9}, {3.8243076182727833`*^9, 
   3.8243076184472713`*^9}, {3.82430774369795*^9, 3.8243077446490593`*^9}, {
   3.824308085025352*^9, 3.824308090725337*^9}, {3.824308199422291*^9, 
   3.824308206140506*^9}, {3.824308252785657*^9, 3.8243082935669937`*^9}, {
   3.824308324482592*^9, 3.824308410682747*^9}, {3.8243084496502953`*^9, 
   3.824308488910963*^9}, {3.8243093942811413`*^9, 3.824309430982087*^9}, {
   3.8243107923867207`*^9, 3.8243108445735292`*^9}, {3.824311024166565*^9, 
   3.824311027453088*^9}, {3.8243184501323423`*^9, 3.824318464487668*^9}, {
   3.8243202162284822`*^9, 3.8243202911329947`*^9}, {3.824321859990234*^9, 
   3.824321862062951*^9}, {3.824321917716749*^9, 3.824321950334517*^9}, {
   3.824321988843864*^9, 3.82432222452626*^9}, {3.824322329498057*^9, 
   3.824322330211993*^9}, {3.824322614074294*^9, 3.824322631974923*^9}, {
   3.824323890558671*^9, 3.824323891136404*^9}, {3.824537418492444*^9, 
   3.824537424122225*^9}, {3.824538130925724*^9, 3.824538142393158*^9}, {
   3.824538295437866*^9, 3.824538299246235*^9}, {3.824538484960519*^9, 
   3.824538527757381*^9}, 3.82453855786154*^9, {3.824539278213999*^9, 
   3.8245392903795357`*^9}, {3.824540075990387*^9, 3.824540076833686*^9}, {
   3.8245447938595867`*^9, 3.824544794903626*^9}, {3.824544962410778*^9, 
   3.824545005551125*^9}, {3.8245450589251204`*^9, 3.824545076376213*^9}, {
   3.824548329157998*^9, 3.824548332446637*^9}, {3.82454915815876*^9, 
   3.824549167377708*^9}, {3.8245492198720703`*^9, 3.824549220563349*^9}, {
   3.824755305476252*^9, 3.824755306765834*^9}, {3.82485053687591*^9, 
   3.824850564779814*^9}, {3.824883120918393*^9, 3.8248831405625*^9}, {
   3.824883246261015*^9, 3.8248833115745087`*^9}, {3.8248833622595053`*^9, 
   3.824883473262661*^9}, {3.824883677202252*^9, 3.8248836814067297`*^9}, {
   3.824883862802598*^9, 3.824883869441951*^9}, {3.825014610297204*^9, 
   3.8250146110752974`*^9}, {3.8250165996349382`*^9, 3.825016600928647*^9}, {
   3.825058150430339*^9, 3.825058153579541*^9}, {3.8250630183201523`*^9, 
   3.825063058617509*^9}, 3.825104545560051*^9, {3.82510563664517*^9, 
   3.825105655523931*^9}, {3.825105704992066*^9, 3.8251057613434362`*^9}, {
   3.825106295956503*^9, 3.8251062982168694`*^9}, {3.825106738580282*^9, 
   3.8251067443225517`*^9}, {3.8251067766094418`*^9, 3.825106808256688*^9}, {
   3.825106860443375*^9, 3.825106878117125*^9}, {3.825106922627831*^9, 
   3.8251069276237288`*^9}, {3.82526760676342*^9, 3.8252676381881104`*^9}, {
   3.825268222776764*^9, 3.825268236131613*^9}, {3.8254957790766773`*^9, 
   3.825495791022871*^9}, {3.825495824222884*^9, 3.825495826860299*^9}, {
   3.825495858474276*^9, 3.825495859922833*^9}, {3.825498459321604*^9, 
   3.825498472200067*^9}, {3.825508410180365*^9, 3.825508412471156*^9}, {
   3.825510535785088*^9, 3.825510541736676*^9}, {3.8255110258935127`*^9, 
   3.825511031049593*^9}, {3.8255111796119833`*^9, 3.825511184914736*^9}, {
   3.825511873474053*^9, 3.825511874715992*^9}, 3.825511911160968*^9, {
   3.825512019043532*^9, 3.825512029076371*^9}, {3.825512066218796*^9, 
   3.825512320383342*^9}, {3.825512994360845*^9, 3.825513016641941*^9}, {
   3.825513099322051*^9, 3.82551320588933*^9}, {3.8255132374060087`*^9, 
   3.8255132705249033`*^9}, {3.825513305573246*^9, 3.82551337346861*^9}, {
   3.82551388475298*^9, 3.825513891560669*^9}, {3.825514413022797*^9, 
   3.825514428461008*^9}, {3.8255181205650673`*^9, 3.825518122316593*^9}, {
   3.8255182455727663`*^9, 3.825518248354433*^9}, {3.825534223641121*^9, 
   3.825534237994011*^9}, {3.825534599634287*^9, 3.825534700502471*^9}, {
   3.825534742211144*^9, 3.825534764676961*^9}, {3.825534946276765*^9, 
   3.825534981417391*^9}, {3.825535048088523*^9, 3.82553505038449*^9}, {
   3.825660849483787*^9, 3.825660864110058*^9}, {3.825664698419793*^9, 
   3.825664723565132*^9}, {3.825665049669495*^9, 3.82566505377386*^9}, {
   3.825665393241602*^9, 3.8256655022016172`*^9}, {3.8256680448530807`*^9, 
   3.825668103089615*^9}, {3.825672081418087*^9, 3.825672088093466*^9}, 
   3.825673266449448*^9, {3.825675553202299*^9, 3.825675555203444*^9}, {
   3.825675601351818*^9, 3.825675684967312*^9}, {3.825675729569035*^9, 
   3.825675761334628*^9}, {3.825675974498933*^9, 3.825675982675151*^9}, {
   3.825676023333053*^9, 3.825676030887165*^9}, {3.8256761381984577`*^9, 
   3.825676193958191*^9}, {3.825785321064992*^9, 3.8257853222568502`*^9}, {
   3.825785360406653*^9, 3.825785392440948*^9}, {3.8257854888904657`*^9, 
   3.825785544623884*^9}, {3.825785575988226*^9, 3.825785637414837*^9}, {
   3.825785975166486*^9, 3.825785984346795*^9}, {3.825787528283985*^9, 
   3.825787659713517*^9}, {3.825787842281169*^9, 3.8257878681666594`*^9}, {
   3.825788346081984*^9, 3.825788371099234*^9}, {3.825791531086545*^9, 
   3.825791573672353*^9}, {3.82609426681771*^9, 3.826094301245672*^9}, {
   3.8260943388328133`*^9, 3.826094389856464*^9}, 3.826120322169571*^9, {
   3.8261207046360683`*^9, 3.8261207615476723`*^9}, {3.826120888806754*^9, 
   3.826120889126109*^9}, {3.826138110252082*^9, 3.8261381136511993`*^9}, {
   3.826138231845673*^9, 3.826138232678771*^9}, {3.826138262737748*^9, 
   3.82613830698333*^9}, {3.8261385515443068`*^9, 3.826138552318265*^9}, {
   3.826139766372301*^9, 3.826139769926347*^9}, {3.826140448893526*^9, 
   3.8261404520097933`*^9}, {3.826144910501575*^9, 3.826144912675462*^9}, {
   3.826145205520015*^9, 3.826145213235814*^9}, {3.826198720956499*^9, 
   3.8261987749690104`*^9}, {3.826198874868515*^9, 3.826198876043291*^9}, {
   3.826199173007904*^9, 3.826199175377626*^9}, {3.826199218302203*^9, 
   3.8261992204719963`*^9}, {3.8262702423674173`*^9, 3.826270242648131*^9}, {
   3.826270468282893*^9, 3.826270473673602*^9}, {3.82627691820885*^9, 
   3.826276958617146*^9}, {3.8262773191321917`*^9, 3.826277383484249*^9}, {
   3.826277432107605*^9, 3.826277437786437*^9}, {3.826277475344172*^9, 
   3.826277485457539*^9}, {3.826298328914434*^9, 3.826298409068282*^9}, {
   3.826298530553568*^9, 3.826298531692553*^9}, {3.826299052951599*^9, 
   3.826299065179369*^9}, {3.826299229301776*^9, 3.826299230544084*^9}, {
   3.826302431576777*^9, 3.826302454738573*^9}, {3.826302501195551*^9, 
   3.826302553803144*^9}, {3.826302609693803*^9, 3.826302616352551*^9}, {
   3.82669881853535*^9, 3.826698824871673*^9}, {3.826698870378009*^9, 
   3.826698921686386*^9}, {3.826698978096369*^9, 3.826698979255539*^9}, {
   3.826699382633584*^9, 3.826699454624948*^9}, {3.826699752670434*^9, 
   3.826699755070755*^9}, {3.826701600273657*^9, 3.826701692990178*^9}, {
   3.826711499616312*^9, 3.8267114998103037`*^9}, {3.826723542544141*^9, 
   3.826723604106338*^9}, {3.826724056838066*^9, 3.826724097339995*^9}, {
   3.8267402594275007`*^9, 3.8267402718458767`*^9}, {3.8267416079670963`*^9, 
   3.826741626060364*^9}, {3.826742112385083*^9, 3.826742128197468*^9}, {
   3.826743556679257*^9, 3.826743623841836*^9}, {3.826743756076137*^9, 
   3.826743814687344*^9}, {3.826743894171132*^9, 3.826743928699864*^9}, {
   3.826745503475848*^9, 3.826745554121994*^9}, {3.8267460256902237`*^9, 
   3.826746072339713*^9}, 3.82674622277421*^9, {3.826746265465904*^9, 
   3.826746297350039*^9}, 3.826746443980891*^9, {3.8267469607209597`*^9, 
   3.826746963341021*^9}, {3.826777491789135*^9, 3.826777497863015*^9}, {
   3.826777689743737*^9, 3.826777694463305*^9}, {3.826777726077855*^9, 
   3.826777778138949*^9}, 3.826778220794985*^9, {3.826788824558866*^9, 
   3.8267888458977127`*^9}, {3.826788942921905*^9, 3.826788960939682*^9}, {
   3.8267891914320087`*^9, 3.826789219722056*^9}, {3.826789271734152*^9, 
   3.826789272427622*^9}, {3.8267901898011303`*^9, 3.826790190433629*^9}, {
   3.831529685580707*^9, 3.831529692248479*^9}, {3.831718875875195*^9, 
   3.83171888729807*^9}, {3.831719187526713*^9, 3.831719216823043*^9}, {
   3.831719980062619*^9, 3.8317201583587627`*^9}, {3.831720193113049*^9, 
   3.83172021607758*^9}, {3.831739537758512*^9, 3.83173959904624*^9}, {
   3.831739678174284*^9, 3.831739678652192*^9}, {3.831739846604487*^9, 
   3.8317398621026154`*^9}, 3.831791723777203*^9, {3.831798712733508*^9, 
   3.831798714018696*^9}, {3.831798798403708*^9, 3.831798804201972*^9}, {
   3.831804653930434*^9, 3.831804705097946*^9}, {3.831807605858328*^9, 
   3.8318076448385687`*^9}, 3.8318076940328627`*^9, {3.831913526033209*^9, 
   3.831913529474889*^9}, {3.831980801237941*^9, 3.831980839336377*^9}, {
   3.8319811833563957`*^9, 3.831981185428753*^9}, {3.8320573353664293`*^9, 
   3.832057338106555*^9}, {3.832057412666327*^9, 3.832057475911785*^9}, {
   3.832057683626811*^9, 3.832057683833787*^9}, {3.833280094325014*^9, 
   3.833280182683653*^9}, {3.8332825426794643`*^9, 3.833282561953844*^9}, {
   3.8332841352770348`*^9, 3.833284357367276*^9}, {3.8332844102555304`*^9, 
   3.833284484617537*^9}, {3.833285688264647*^9, 3.8332857097312*^9}, {
   3.8332857627855043`*^9, 3.833285778984912*^9}, {3.833285869537068*^9, 
   3.833285927465303*^9}, {3.833286002743374*^9, 3.833286005683317*^9}, {
   3.8332881392040033`*^9, 3.8332881816305943`*^9}, {3.8332882495948763`*^9, 
   3.833288293933681*^9}, {3.8332883928514433`*^9, 3.833288399518552*^9}, {
   3.833288450116057*^9, 3.833288604187621*^9}, {3.8333557404730673`*^9, 
   3.833355751383128*^9}, {3.833355998664579*^9, 3.8333560152932253`*^9}, {
   3.833356856060226*^9, 3.8333568740078497`*^9}, {3.833358799100299*^9, 
   3.833358846721134*^9}, {3.83335891414176*^9, 3.8333589172787743`*^9}, 
   3.8333599854235983`*^9, {3.8333609709268017`*^9, 3.8333610107652884`*^9}, {
   3.8333673705664463`*^9, 3.833367394586445*^9}, {3.834001557989421*^9, 
   3.834001576826354*^9}, 3.834001679272356*^9, {3.834001768244609*^9, 
   3.8340017715495768`*^9}, {3.834002029498067*^9, 3.834002030424321*^9}, 
   3.834002125749867*^9, {3.8340021685003433`*^9, 3.834002174734964*^9}, {
   3.834002368604982*^9, 3.834002383018499*^9}, {3.8340024278742867`*^9, 
   3.834002476535364*^9}, {3.8340461905289097`*^9, 3.8340461984980164`*^9}, 
   3.834046560679493*^9, {3.834046590768527*^9, 3.834046614580707*^9}, {
   3.834046681976269*^9, 3.834046687865197*^9}, {3.834047150823515*^9, 
   3.834047166727199*^9}, {3.8341274049789133`*^9, 3.834127413195093*^9}, {
   3.834127450562399*^9, 3.834127465511684*^9}, {3.8341275336082487`*^9, 
   3.83412754123065*^9}, {3.834127581073053*^9, 3.8341275827754917`*^9}, {
   3.8341276142121058`*^9, 3.834127648593746*^9}, {3.834127712011409*^9, 
   3.834127774607931*^9}, {3.8341278465315247`*^9, 3.834127892789741*^9}, {
   3.83412793753784*^9, 3.834127940648087*^9}, {3.8341280011192207`*^9, 
   3.834128001536237*^9}, {3.834129625858251*^9, 3.834129629510638*^9}, {
   3.8341296878465853`*^9, 3.834129688177713*^9}, {3.834129866734787*^9, 
   3.834129893158786*^9}, {3.8341300112966833`*^9, 3.8341300838043623`*^9}, {
   3.834130156027556*^9, 3.834130160642625*^9}, {3.834130193059104*^9, 
   3.834130214562057*^9}, {3.8341400319912*^9, 3.834140069060082*^9}, {
   3.835352396948374*^9, 3.835352411434185*^9}, {3.835472877854577*^9, 
   3.835472894273985*^9}, {3.83588473291243*^9, 3.835884737445252*^9}, {
   3.8358869922486362`*^9, 3.835886997263592*^9}, {3.8363070601408787`*^9, 
   3.836307068731743*^9}, {3.8368471209927073`*^9, 3.836847151414577*^9}, {
   3.836847375585701*^9, 3.8368473791051693`*^9}, {3.8368475057583303`*^9, 
   3.836847533319138*^9}, {3.836847599773078*^9, 3.83684760366317*^9}, {
   3.83684783330195*^9, 3.8368479195319853`*^9}, {3.836847953644047*^9, 
   3.836847987555901*^9}, {3.836919813648074*^9, 3.836919819870854*^9}, {
   3.8371458458742332`*^9, 3.837145884861856*^9}, {3.8371463337919197`*^9, 
   3.837146508286643*^9}, {3.837146594469406*^9, 3.837146605367075*^9}, {
   3.837147270746173*^9, 3.8371472775252953`*^9}, {3.8420807839681683`*^9, 
   3.842080834870784*^9}, {3.842696035805974*^9, 3.842696036446919*^9}, 
   3.842696072392263*^9, {3.8426961196813173`*^9, 3.8426961615379057`*^9}, {
   3.842696218837566*^9, 3.8426962602273817`*^9}, {3.843540827751486*^9, 
   3.84354083123596*^9}, {3.850488113627899*^9, 3.85048811648276*^9}, {
   3.850542232185687*^9, 3.850542267425507*^9}, {3.850578254665372*^9, 
   3.8505783453380117`*^9}, {3.850579047202887*^9, 3.85057904801593*^9}, {
   3.850633714080165*^9, 3.850633717006936*^9}, {3.850634263509306*^9, 
   3.8506343057668056`*^9}, {3.850661840171085*^9, 3.850661842578133*^9}, {
   3.850661876881297*^9, 3.8506618833508472`*^9}, {3.850662276461372*^9, 
   3.850662288216258*^9}, {3.850795918005971*^9, 3.8507959716400757`*^9}, 
   3.850796022320594*^9, {3.850796666470317*^9, 3.8507966722095127`*^9}, {
   3.8508051675020943`*^9, 3.8508051681090107`*^9}, {3.8508061826619167`*^9, 
   3.850806233949646*^9}, {3.850806371827661*^9, 3.85080637515985*^9}, {
   3.8508080401062098`*^9, 3.8508081653501873`*^9}, {3.850808437934675*^9, 
   3.8508084846716433`*^9}, {3.8508089670153723`*^9, 3.85080898079556*^9}, {
   3.850813697344901*^9, 3.8508137421595716`*^9}, {3.850813777364396*^9, 
   3.850813829787745*^9}, {3.850827726380706*^9, 3.8508277274455833`*^9}, {
   3.850844999826623*^9, 3.850845004660537*^9}, {3.85084510995724*^9, 
   3.8508451118467493`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"c121e646-8bc6-4559-8c6b-cbd2e7cae450"],

Cell[BoxData["\<\"VQEGS[nqubit_,hamiltonian_,conf_] calculate ground-state \
energy\"\>"], "Output",
 CellChangeTimes->{
  3.83400168034326*^9, 3.8340017722320547`*^9, {3.834002099254963*^9, 
   3.834002126496841*^9}, {3.834002481468692*^9, 3.834002489737935*^9}, 
   3.834090268861765*^9, 3.834127433339148*^9, {3.8341274669372063`*^9, 
   3.834127515746706*^9}, 3.834127786771266*^9, 3.8341278932170486`*^9, 
   3.8341279416438417`*^9, 3.8341292101210012`*^9, 3.834129630699407*^9, 
   3.834129689982337*^9, 3.8341298938501167`*^9, 3.8341300029568872`*^9, 
   3.8341300457994423`*^9, {3.834130084378049*^9, 3.834130111250029*^9}, {
   3.834130161734395*^9, 3.834130170194154*^9}, {3.8341302032740192`*^9, 
   3.834130215516602*^9}, 3.834131901374937*^9, 3.8341400759840803`*^9, 
   3.8341401771440153`*^9, 3.835352312544325*^9, 3.835471614329793*^9, 
   3.8354729008459997`*^9, 3.835473351788259*^9, 3.835473382304194*^9, 
   3.8354734547880487`*^9, 3.835473978248848*^9, 3.835887010181644*^9, 
   3.836557699852046*^9, 3.8366217691812677`*^9, 3.836638507716083*^9, {
   3.8366712146279287`*^9, 3.83667123721356*^9}, 3.836671353288911*^9, 
   3.8366714690144053`*^9, 3.836671585217098*^9, 3.8366725749267807`*^9, 
   3.836672793037161*^9, 3.836737444789804*^9, 3.8368158823192863`*^9, 
   3.8368159276668577`*^9, 3.836815962975093*^9, 3.836816372274267*^9, 
   3.83681640924091*^9, 3.836816697371039*^9, 3.8368167542438993`*^9, 
   3.8368171348301277`*^9, {3.836817231460615*^9, 3.8368172505580597`*^9}, 
   3.836817375615056*^9, 3.836817414571808*^9, 3.8368175194363747`*^9, 
   3.836817627147719*^9, 3.8368472690735083`*^9, 3.836847386101388*^9, 
   3.8368474520655823`*^9, 3.836847534531125*^9, 3.836847731897047*^9, 
   3.836847931053482*^9, 3.83684799288245*^9, 3.836887142545258*^9, 
   3.836888978242496*^9, 3.8368890423643703`*^9, 3.8368891144042473`*^9, 
   3.836889171594035*^9, 3.836891067851527*^9, 3.836891117739633*^9, 
   3.836891174864298*^9, 3.836928486530498*^9, 3.836969167862752*^9, 
   3.836970063832242*^9, 3.836970592652135*^9, 3.836970675003572*^9, 
   3.836970751580241*^9, 3.837002672646556*^9, 3.837146515941164*^9, 
   3.837146564121894*^9, 3.837146680576253*^9, 3.837147286587338*^9, 
   3.837147386948803*^9, 3.842250930456154*^9, 3.8435408161011333`*^9, {
   3.850484427329671*^9, 3.850484436633312*^9}, 3.850484476892963*^9, 
   3.8504854140749073`*^9, 3.850485604082926*^9, 3.850578196350335*^9, {
   3.850578346303598*^9, 3.85057836078335*^9}, {3.850579204293293*^9, 
   3.850579213514883*^9}, 3.850634306379884*^9, 3.850661898689919*^9, 
   3.850662300502655*^9, 3.850712614760736*^9, 3.850795974763537*^9, 
   3.850796023001758*^9, 3.85079667311248*^9, 3.8508051691314096`*^9, 
   3.8508062344657288`*^9, 3.850806383808516*^9, 3.8508067198361893`*^9, 
   3.8508081558493013`*^9, 3.850808489053368*^9, 3.850808773812204*^9, 
   3.850813964454207*^9, 3.850814800121366*^9, 3.850816893659639*^9, 
   3.8508173883772*^9, 3.850817673477405*^9, 3.8508183576811123`*^9, 
   3.850818457278232*^9, {3.850827823445292*^9, 3.850827836110218*^9}, 
   3.850827867176806*^9, 3.850845404776585*^9, {3.850879661280999*^9, 
   3.850879681955089*^9}, 3.850990880518487*^9, 3.852013731981851*^9, 
   3.8520138342720003`*^9, 3.852013948721712*^9, 3.852618728753878*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"f3a5c6fe-ad6d-4a9b-a521-4525f32d78d8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1295, 809},
WindowMargins->{{0.5, Automatic}, {Automatic, 0.5}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, "TryRealOnly" -> False},
Magnification:>0.75 Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"fc81a18c-7737-46df-94d9-2f0d8d894767"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 700, 10, 107, "Title",ExpressionUUID->"7532a72a-505f-400b-ac05-031ad951830d"],
Cell[1283, 34, 268, 4, 37, "Subtitle",ExpressionUUID->"e7aee06d-2e4f-4999-8854-70c54571f52a"],
Cell[1554, 40, 497, 11, 106, "Subsubtitle",ExpressionUUID->"da5a076a-9717-4ab1-bde7-180ea14db740"],
Cell[CellGroupData[{
Cell[2076, 55, 170, 3, 39, "Subsection",ExpressionUUID->"f8927233-1ac2-41e3-b00e-d144b3c5eba1"],
Cell[CellGroupData[{
Cell[2271, 62, 330, 5, 36, "Subsubsection",ExpressionUUID->"1e964a40-6779-4f5b-96fe-d4a1b68f5e00"],
Cell[2604, 69, 1521, 26, 92, "Input",ExpressionUUID->"84668fc4-2893-4c14-8e4b-bddb5cda67f9"]
}, Closed]],
Cell[CellGroupData[{
Cell[4162, 100, 251, 4, 35, "Subsubsection",ExpressionUUID->"38e68ade-8501-4fe8-8d2b-cd049d6e6ef8"],
Cell[4416, 106, 523, 10, 69, "Input",ExpressionUUID->"fa431975-73c1-499d-a5c9-d213cffd9877"],
Cell[4942, 118, 9528, 284, 320, "Input",ExpressionUUID->"79778ee5-5a6d-45cb-8e90-61bcedfa7f7b"],
Cell[14473, 404, 6880, 184, 492, "Input",ExpressionUUID->"4d36f5e6-093c-4760-9b73-060190e2601c"]
}, Closed]],
Cell[CellGroupData[{
Cell[21390, 593, 298, 5, 35, "Subsubsection",ExpressionUUID->"364966f0-0fa9-4d5d-b8b6-b701b1d3988c"],
Cell[21691, 600, 29995, 507, 1670, "Input",ExpressionUUID->"d59efb8e-5439-4ec9-b913-64b1683d8faf"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51735, 1113, 229, 4, 39, "Subsection",ExpressionUUID->"8bc0f4f2-35d8-464a-9cf4-1e017ee3b0d2"],
Cell[CellGroupData[{
Cell[51989, 1121, 2482, 63, 370, "Input",ExpressionUUID->"336db206-e2dd-4e26-8577-7b1820ca40eb"],
Cell[54474, 1186, 2459, 35, 70, "Output",ExpressionUUID->"ca48d0bf-87ea-4d08-8f00-f108b2ddd000"]
}, Open  ]],
Cell[56948, 1224, 8712, 155, 624, "Input",ExpressionUUID->"16c427de-5418-4c81-ba37-a0a6b3d3dd3b"],
Cell[65663, 1381, 6507, 131, 786, "Input",ExpressionUUID->"c3d1114c-8972-44e7-b083-793ce614511c"],
Cell[72173, 1514, 8730, 184, 665, "Input",ExpressionUUID->"09a958fd-760a-4f76-87b4-e1f36b6b64d2"]
}, Closed]],
Cell[CellGroupData[{
Cell[80940, 1703, 193, 3, 38, "Subsection",ExpressionUUID->"86d71386-1a3b-4b80-81b4-3a549c53d3cc"],
Cell[81136, 1708, 6569, 167, 651, "Input",ExpressionUUID->"a0dd377d-8d24-4f0f-a698-b5a7b7d2df22"]
}, Closed]],
Cell[CellGroupData[{
Cell[87742, 1880, 325, 5, 38, "Subsection",ExpressionUUID->"4b588684-548a-4e1e-aed2-19b22ae42b45"],
Cell[88070, 1887, 452, 8, 40, "Input",ExpressionUUID->"06c0f746-bfa5-400b-a757-751bf6da5e6c"],
Cell[88525, 1897, 5086, 107, 224, "Input",ExpressionUUID->"6dfc71a2-81c6-4e6f-b18f-976a203c5174"],
Cell[93614, 2006, 11260, 219, 809, "Input",ExpressionUUID->"66614a13-c7b5-4205-9cbb-4b7567b62989"],
Cell[104877, 2227, 558, 13, 40, "Input",ExpressionUUID->"a2173d43-a9a4-4b2c-9c53-8586c2197ca5"],
Cell[105438, 2242, 29156, 527, 1151, "Input",ExpressionUUID->"915d477a-b6c5-4de3-8c4a-db480cf1a6c5"],
Cell[134597, 2771, 7702, 151, 562, "Input",ExpressionUUID->"e92c345a-290a-4a0a-a739-d6519efa13a4"]
}, Closed]],
Cell[CellGroupData[{
Cell[142336, 2927, 329, 5, 38, "Subsection",ExpressionUUID->"2193745b-35cd-48e1-b811-90b2c4779fe8"],
Cell[142668, 2934, 544, 9, 45, "Input",ExpressionUUID->"9fe547ff-fe0a-419d-ae2c-5e507a4a3987"],
Cell[143215, 2945, 3151, 71, 393, "Input",ExpressionUUID->"50c3a9ea-1878-48ac-a5d7-253fb3651fec"],
Cell[146369, 3018, 13430, 241, 1179, "Input",ExpressionUUID->"0dc22a7e-82f3-470c-86ca-45b2d57fad15"],
Cell[159802, 3261, 27627, 578, 1146, "Input",ExpressionUUID->"ea5d5c6f-a445-4b38-afbc-cb1e57a37cb7"],
Cell[187432, 3841, 17360, 338, 1682, "Input",ExpressionUUID->"ddd6f67e-e161-4a99-919e-2cf240262349"],
Cell[204795, 4181, 22724, 411, 1379, "Input",ExpressionUUID->"91a75a03-08f1-4019-b332-57233552b753"],
Cell[227522, 4594, 16828, 331, 1698, "Input",ExpressionUUID->"2a594bd0-0978-4fd6-b405-5ec85cf1f3b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244387, 4930, 494, 9, 39, "Subsection",ExpressionUUID->"1af26ec8-4c38-4db5-bca3-f6e12e176a33"],
Cell[CellGroupData[{
Cell[244906, 4943, 226, 4, 36, "Subsubsection",ExpressionUUID->"3c80c594-5095-4734-ac81-0f7130826f4b"],
Cell[CellGroupData[{
Cell[245157, 4951, 63897, 891, 231, "Input",ExpressionUUID->"fb4cf242-f62e-4f00-b0ef-c767b2721190"],
Cell[309057, 5844, 2575, 36, 59, "Output",ExpressionUUID->"de3d048e-7e8d-4972-8d32-ac2ccbcfff04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311669, 5885, 7782, 180, 824, "Input",ExpressionUUID->"52d52a5a-36a2-4d12-b724-bacffad68daf"],
Cell[319454, 6067, 2632, 37, 44, "Output",ExpressionUUID->"097b7cef-78de-4a74-97da-2a66629d6f71"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322123, 6109, 2032, 45, 300, "Input",ExpressionUUID->"667b0664-8ae0-495a-9fe1-b3a69cbd6565"],
Cell[324158, 6156, 3228, 45, 69, "Output",ExpressionUUID->"a59fa63b-c4be-4984-a17f-3ac67fc23256"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[327435, 6207, 171, 3, 24, "Subsubsection",ExpressionUUID->"aacefaa9-229c-4852-9ee9-156e44414a68"],
Cell[CellGroupData[{
Cell[327631, 6214, 106999, 1740, 4832, "Input",ExpressionUUID->"c121e646-8bc6-4559-8c6b-cbd2e7cae450"],
Cell[434633, 7956, 3366, 47, 44, "Output",ExpressionUUID->"f3a5c6fe-ad6d-4a9b-a521-4525f32d78d8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

