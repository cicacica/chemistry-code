(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66578,       1577]
NotebookOptionsPosition[     61079,       1490]
NotebookOutlinePosition[     61572,       1508]
CellTagsIndexPosition[     61529,       1505]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["H", "2"], TraditionalForm]],ExpressionUUID->
  "732b72b0-6537-40c0-8636-1cc47c1410fe"],
 " dynamics"
}], "Title",
 CellChangeTimes->{{3.834044994629313*^9, 3.834045013637822*^9}, {
  3.834045535748794*^9, 3.8340455382946987`*^9}, {3.839595485081985*^9, 
  3.8395954853050737`*^9}, {3.851156942535042*^9, 3.8511569449245367`*^9}, {
  3.851582021889683*^9, 3.851582024047722*^9}, {3.852197322307027*^9, 
  3.852197323400023*^9}, {3.8521975947368803`*^9, 
  3.852197596380497*^9}},ExpressionUUID->"9c1dff5f-e921-489a-86b0-\
1c40629006dc"],

Cell[BoxData[
 RowBox[{"SetEnvironment", "[", 
  RowBox[{"\"\<OMP_NUM_THREADS\>\"", "->", "\"\<8\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.856863927951692*^9, 3.85686394652915*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"f5720dc7-67b1-44ab-ad1c-dabe6c67a58f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Import", "[", "\"\<https://qtechtheory.org/questlink.m\>\"", "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateLocalQuESTEnv", "[", "\"\<quest_link_cpu\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.819803125076724*^9, 3.8198031261607533`*^9}, {
   3.819803176415811*^9, 3.8198031766531963`*^9}, {3.819894353876569*^9, 
   3.819894356732341*^9}, {3.8198943886489763`*^9, 3.819894431785378*^9}, {
   3.8198945146801443`*^9, 3.819894518596518*^9}, {3.820527172879855*^9, 
   3.8205272473315496`*^9}, 3.820655339193205*^9, {3.820655433359385*^9, 
   3.82065549058811*^9}, {3.820661747013823*^9, 3.820661748015472*^9}, {
   3.820663378793988*^9, 3.8206634767830477`*^9}, {3.821097203028792*^9, 
   3.8210972042257833`*^9}, {3.821444898465564*^9, 3.821444899367831*^9}, {
   3.821821390840189*^9, 3.821821391053975*^9}, {3.8235205222382593`*^9, 
   3.823520526123763*^9}, 3.8237856350757713`*^9, {3.823785798865507*^9, 
   3.823785848093607*^9}, {3.823785921345996*^9, 3.8237859913036327`*^9}, {
   3.8238122338980618`*^9, 3.8238122361989*^9}, {3.8275928471853943`*^9, 
   3.8275928848839893`*^9}, {3.8290767044800053`*^9, 3.829076709428789*^9}, {
   3.8291285519818907`*^9, 3.829128587812381*^9}, {3.830414784265088*^9, 
   3.830414788779163*^9}, {3.8467535024579287`*^9, 3.8467535104980297`*^9}, {
   3.846753609579941*^9, 3.846753610525757*^9}, {3.848654554777*^9, 
   3.848654565020479*^9}, {3.8486546329712973`*^9, 3.848654633769349*^9}, {
   3.848673592045994*^9, 3.8486735923243837`*^9}, {3.851708613390814*^9, 
   3.85170862344545*^9}, {3.852264597949493*^9, 3.852264598219047*^9}, {
   3.852456437422299*^9, 3.852456437680458*^9}, {3.856863921128278*^9, 
   3.856863921297122*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"bc2eb47a-2577-4b72-91f8-f80d872ef4aa"],

Cell[CellGroupData[{

Cell["modules", "Section",
 CellChangeTimes->{{3.834045425458088*^9, 3.834045434250761*^9}, 
   3.8511600068336143`*^9},ExpressionUUID->"d4fdd558-5dfa-43ba-83b9-\
2b0b69f1cf61"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FormatHamiltonian", "::", "usage"}], "=", 
   "\"\<Format the hamiltonian from qiskit;daniel's format\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormatHamiltonian", "[", "filename_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stringham", ",", "ham", ",", "nterms", ",", "nqubits"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"stringham", "=", 
       RowBox[{"Import", "[", "filename", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ham", "=", 
       RowBox[{"ToExpression", "[", "stringham", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nqubits", "=", 
       RowBox[{
        RowBox[{"1", "+", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Level", "[", 
               RowBox[{"#", ",", 
                RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Flatten", "@", "ham"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"NumericQ", "[", "#", "]"}], "&"}]}], "]"}]}], "//", 
        "Max"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nterms", "=", 
       RowBox[{"Length", "@", "ham"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Total", "@", 
         RowBox[{"Apply", "[", 
          RowBox[{"Times", ",", "ham", ",", "1"}], "]"}]}], ",", "nterms", 
        ",", "nqubits"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetBlocks", "::", "usage"}], "=", 
   "\"\<GetBlocks[blockdiagmat_,draw_:True]. Partition indices of a matrix by \
its blocks.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetBlocks", "[", 
   RowBox[{"mat_", ",", 
    RowBox[{"draw_", ":", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"adjmat", ",", 
      RowBox[{"dim", "=", 
       RowBox[{"Length", "@", "mat"}]}], ",", "graph"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"adjmat", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"adjmat", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mat", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "\[Equal]", 
           "0"}], ",", "0", ",", "1"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "dim"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"AdjacencyGraph", "@", "adjmat"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"draw", ",", 
       RowBox[{"Print", "@", "graph"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ConnectedComponents", "@", "graph"}], "-", "1"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.851156972599205*^9, 3.851156984064528*^9}, {
  3.8511576837548723`*^9, 3.851157769536538*^9}, {3.851158027503839*^9, 
  3.851158116837675*^9}, {3.8511597579282618`*^9, 3.851159919473506*^9}, {
  3.851160012165007*^9, 3.851160060137978*^9}, {3.8511606162224407`*^9, 
  3.851160616336969*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"6a73d21c-ac9f-48d7-a443-6e5039de881c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MatrixDist", "::", "usage"}], "=", 
   "\"\<MatrixDist[matrix1, matrix2, subspace, plotglobalphase:False]. \
Calculate distance of 2 matrices by formula: \n                               \
     \!\(\*SubscriptBox[\(max\), \(\[Lambda]\)]\)|\!\(\*SubscriptBox[\(\
\[CapitalPi]\), \(S\)]\)(U-V)\!\(\*SubscriptBox[\(\[CapitalPi]\), \(S\)]\)| \n\
                    namely, maximum absolute eigenvalues of the matrix \
difference projected to the subspace of interest.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixDist", "[", 
    RowBox[{"M1_", ",", "M2_", ",", "subspace_", ",", 
     RowBox[{"plotglobalphase_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "sm1", ",", "sm2", ",", "globalphase", ",", "mindist", ",", "F", ",", 
       "\[Phi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sm1", ",", "sm2"}], "}"}], "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "subspace"}], "<", 
          RowBox[{"Length", "@", "M1"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GetSubMatrix", "[", 
            RowBox[{"M1", ",", "subspace"}], "]"}], ",", 
           RowBox[{"GetSubMatrix", "[", 
            RowBox[{"M2", ",", "subspace"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"M1", ",", "M2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"F", "[", 
        RowBox[{"\[Phi]_", "?", "NumericQ"}], "]"}], ":=", 
       RowBox[{"Max", "[", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"Eigenvalues", "[", 
          RowBox[{"GetSubMatrix", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ConjugateTranspose", "[", 
              RowBox[{"M1", "-", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"\[ImaginaryI]", "*", "\[Phi]"}], "]"}], "M2"}]}], 
              "]"}], ".", 
             RowBox[{"(", 
              RowBox[{"M1", "-", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"\[ImaginaryI]", "*", "\[Phi]"}], "]"}], "*", 
                "M2"}]}], ")"}]}], ",", "subspace"}], "]"}], "]"}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mindist", ",", "globalphase"}], "}"}], "=", 
       RowBox[{"NMinimize", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"F", "[", "\[Phi]", "]"}], ",", 
           RowBox[{"0", "\[LessEqual]", "\[Phi]", "<", 
            RowBox[{"2", "\[Pi]"}]}]}], "}"}], ",", "\[Phi]", ",", 
         RowBox[{"PrecisionGoal", "\[Rule]", "5"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"plotglobalphase", ",", 
        RowBox[{"Print", "@", 
         RowBox[{"DiscretePlot", "[", 
          RowBox[{
           RowBox[{"F", "[", "\[Phi]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]", ",", "0", ",", 
             RowBox[{"2", "\[Pi]"}], ",", "0.01"}], "}"}], ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
             "\"\<\[Phi]\>\"", ",", 
              "\"\<\!\(\*SubscriptBox[\(max\), \
\(\[Lambda]\)]\)|\!\(\*SubscriptBox[\(\[CapitalPi]\), \
\(S\)]\)(U-\!\(\*SuperscriptBox[\(\[ExponentialE]\), \(\[ImaginaryI]\[Phi]\)]\
\)V)\!\(\*SubscriptBox[\(\[CapitalPi]\), \(S\)]\)|\>\""}], "}"}]}], ",", 
           RowBox[{"PlotLabel", "\[Rule]", 
            RowBox[{"ToString", "@", "subspace"}]}]}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"mindist", ",", 
        RowBox[{"\[Phi]", "/.", "globalphase"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetSubMatrix", "::", "usage"}], "=", 
   "\"\<GetSubMatrix[matrix,subspace]. Return the submatrix in the \
subspace.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetSubMatrix", "[", 
    RowBox[{"matrix_", ",", "subspace_"}], " ", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sm", ",", "dim", ",", 
       RowBox[{"x", "=", "0"}], ",", 
       RowBox[{"y", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dim", "=", 
       RowBox[{"Length", "@", "subspace"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sm", "=", 
       RowBox[{"IdentityMatrix", "[", "dim", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"++", "x"}], ";", 
         RowBox[{"y", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"++", "y"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"sm", "\[LeftDoubleBracket]", 
              RowBox[{"x", ",", "y"}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"matrix", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"s", "+", "1"}], ",", 
               RowBox[{"ss", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";"}],
            "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"ss", ",", "subspace"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "subspace"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "sm"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"CompileMe", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompileMe", "[", 
   RowBox[{"nq_", ",", "matrix_", ",", "conf_", ",", 
    RowBox[{"printmatrices_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]", ",", "\[Psi]init", ",", "dist", ",", "cost", ",", 
      "globalphase"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"runtime", ",", 
        RowBox[{"{", 
         RowBox[{
         "costlist", ",", "ansatz", ",", "\[Theta]vars", ",", "finmsg", ",", 
          "ncycle", ",", "fev", ",", "aborted", ",", "cycleres", ",", 
          "elim"}], "}"}]}], "}"}], "=", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{"CJRecompile", "[", 
        RowBox[{"nq", ",", "matrix", ",", "conf"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{
       "ansatz", ",", "\[Theta]vars", ",", "aborted", ",", "fev", ",", 
        "ncycle", ",", "\"\<{merged, \[Theta]small, metric, bruteforce}=\>\"",
         ",", "elim", ",", "finmsg"}], "}"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"costlist", ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "None"}], "}"}]}], ",", 
          RowBox[{"PlotLegends", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<<E>\>\"", ",", "\"\<Ground state\>\""}], "}"}]}]}], 
         "]"}], "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"DrawCircuit", "[", 
       RowBox[{"ansatz", ",", "nq"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<cost=\>\"", ",", 
       RowBox[{"Last", "@", "costlist"}], ",", "\"\<; ngates=\>\"", ",", 
       RowBox[{"Length", "@", "ansatz"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<runtime= \>\"", ",", 
       RowBox[{"runtime", "/", "60"}], ",", "\"\< minutes\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"sanity", " ", "check"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Psi]", ",", "\[Psi]init"}], "}"}], "=", 
      RowBox[{"CreateQuregs", "[", 
       RowBox[{
        RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], ",", "2"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"PrepareInitState", "[", 
      RowBox[{"conf", ",", 
       RowBox[{"InitZeroState", "@", "\[Psi]init"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ApplyCircuit", "[", 
      RowBox[{
       RowBox[{"CloneQureg", "[", 
        RowBox[{"\[Psi]", ",", "\[Psi]init"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["U", 
          RowBox[{"Sequence", "@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"conf", "[", "\"\<nqubit\>\"", "]"}], "-", "1"}]}], 
            "]"}]}]], "[", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"IdentityMatrix", "[", 
            SuperscriptBox["2", 
             RowBox[{"conf", "[", "\"\<nqancilla\>\"", "]"}]], "]"}], ",", 
           "matrix"}], "]"}], "]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ApplyCircuit", "[", 
      RowBox[{"\[Psi]", ",", 
       RowBox[{
        RowBox[{"ansatz", "/.", "CustomGatesDefinitions"}], "/.", 
        "\[Theta]vars"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cost", "=", 
      RowBox[{"CostFidelity", "[", 
       RowBox[{"\[Psi]", ",", "\[Psi]init"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"cost", "-", 
          RowBox[{"Last", "@", "costlist"}]}], ")"}], ">", 
        SuperscriptBox["10", 
         RowBox[{"-", "13"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<WARNIG:didn't pass sanity check\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<error=\>\"", ",", 
          RowBox[{"cost", "-", 
           RowBox[{"Last", "@", "costlist"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"DestroyAllQuregs", "[", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"vmat", "=", 
      RowBox[{"ConjugateTranspose", "@", 
       RowBox[{"CalcCircuitMatrix", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ansatz", "/.", "CustomGatesDefinitions"}], "/.", 
          "\[Theta]vars"}], ",", "nq"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dist", ",", "globalphase"}], "}"}], "=", 
      RowBox[{"MatrixDist", "[", 
       RowBox[{"matrix", ",", "vmat", ",", 
        RowBox[{"conf", "[", "\"\<subspace\>\"", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<cost=\>\"", ",", "cost", ",", " ", "\"\< ;dist=\>\"", ",", "dist", 
       ",", " ", "\"\<; globalphase=\>\"", ",", "globalphase"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"printmatrices", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "@", 
         RowBox[{"MatrixForm", "@", 
          RowBox[{"Chop", "@", 
           RowBox[{"GetSubMatrix", "[", 
            RowBox[{"matrix", ",", 
             RowBox[{"conf", "[", "\"\<subspace\>\"", "]"}]}], "]"}]}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "@", 
         RowBox[{"MatrixForm", "@", 
          RowBox[{"Chop", "@", 
           RowBox[{"GetSubMatrix", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"\[ImaginaryI]", "*", "globalphase"}], "]"}], "vmat"}],
              ",", 
             RowBox[{"conf", "[", "\"\<subspace\>\"", "]"}]}], "]"}]}]}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"cost", ",", "dist", ",", 
       RowBox[{"Length", "@", "ansatz"}], ",", 
       RowBox[{"runtime", "/", "60"}], ",", "ansatz", ",", "\[Theta]vars", 
       ",", "cycleres"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.8486539922261667`*^9, 3.848653999623238*^9}, {
   3.848654181834085*^9, 3.848654329081607*^9}, {3.848654447043174*^9, 
   3.8486544481810417`*^9}, {3.848654480319317*^9, 3.848654485897812*^9}, {
   3.848654591687707*^9, 3.848654592535331*^9}, {3.84865493453155*^9, 
   3.848654936301271*^9}, {3.848655113683434*^9, 3.848655118104076*^9}, {
   3.84865544057543*^9, 3.8486554455108967`*^9}, {3.8486555371584053`*^9, 
   3.848655569141013*^9}, {3.848655627565487*^9, 3.8486556387502937`*^9}, {
   3.848655675267622*^9, 3.8486558213025618`*^9}, {3.848655865963902*^9, 
   3.8486558665502996`*^9}, {3.848655900640209*^9, 3.84865591717441*^9}, {
   3.848655955841148*^9, 3.848655956011249*^9}, {3.848656087022819*^9, 
   3.848656119560813*^9}, {3.848656852912057*^9, 3.8486568574582577`*^9}, {
   3.85116068083076*^9, 3.851160714019874*^9}, {3.8511608551739683`*^9, 
   3.8511608784712687`*^9}, {3.851161586821147*^9, 3.8511616654211597`*^9}, 
   3.8511617291315393`*^9, {3.8511617628156633`*^9, 3.851161766252657*^9}, {
   3.851161818581644*^9, 3.851161827099684*^9}, {3.851161859887147*^9, 
   3.851161870670426*^9}, {3.852197561203849*^9, 3.852197574199657*^9}, {
   3.852455957447451*^9, 3.852455999469804*^9}, {3.852456832806501*^9, 
   3.852456841817555*^9}, {3.856462399883431*^9, 3.856462405645063*^9}, {
   3.856515496357476*^9, 3.856515500143977*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"bbd997de-5c8c-4aaa-92d5-3f035e054810"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BlockByOccupation", "::", "usage"}], "=", 
   "\"\<BlockByOccupation[nqubits, occupation_number], return a block that \
has the correct occupation number\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockByOccupation", "[", 
   RowBox[{"nqubits_", ",", "occnum_"}], "]"}], ":=", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{
       SuperscriptBox["2", "nqubits"], "-", "1"}]}], "]"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"DigitCount", "[", 
       RowBox[{"#", ",", "2", ",", "1"}], "]"}], "\[Equal]", "occnum"}], 
     "&"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.852188919931469*^9, 3.852188944012773*^9}, {
  3.852189115523552*^9, 3.852189142766098*^9}, {3.852196384166459*^9, 
  3.8521964223479767`*^9}, {3.852196539004072*^9, 3.852196543240871*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"4e59313c-f9ee-4565-9120-998e2216f463"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BlockBySpin", "::", "usage"}], "=", 
   "\"\<BlockBySpin[spin_hamiltonian, expected_spin, nqubits], return a block \
that has the correct occupation number\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BlockBySpin", "[", 
   RowBox[{"spinham_", ",", "spin_", ",", "nqubits_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]", ",", "\[Psi]work", ",", "blocks", ",", "circ", ",", "j"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Psi]", ",", "\[Psi]work"}], "}"}], "=", 
      RowBox[{"CreateQuregs", "[", 
       RowBox[{"nqubits", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"blocks", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"blocks", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Reverse", "@", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Reverse", "@", 
                  RowBox[{"IntegerDigits", "[", 
                   RowBox[{"i", ",", "2", ",", "nqubits"}], "]"}]}], ",", 
                 "1"}], "]"}]}]}], "-", "1"}], " ", ")"}], "/.", 
           RowBox[{"j_Integer", "\[Rule]", 
            SubscriptBox["X", "j"]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "circ"}], ">", "0"}], ",", 
           RowBox[{"ApplyCircuit", "[", 
            RowBox[{
             RowBox[{"InitZeroState", "@", "\[Psi]"}], ",", "circ"}], "]"}]}],
           "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"CalcExpecPauliSum", "[", 
               RowBox[{"\[Psi]", ",", "spinham", ",", "\[Psi]work"}], "]"}], 
              "-", "spin"}], "]"}], "\[LessEqual]", 
            SuperscriptBox["10", 
             RowBox[{"-", "13"}]]}], ",", "i", ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           SuperscriptBox["2", "nqubits"], "-", "1"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"DestroyQureg", "[", "\[Psi]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"DestroyQureg", "[", "\[Psi]work", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "@", "blocks"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.852188592858322*^9, 3.852188609700622*^9}, {
   3.852189147149946*^9, 3.85218918589697*^9}, {3.852189258722361*^9, 
   3.852189269758295*^9}, {3.852189425214085*^9, 3.852189512068397*^9}, {
   3.852189876753869*^9, 3.85219000128643*^9}, {3.852190127427698*^9, 
   3.852190136620612*^9}, {3.852190188191245*^9, 3.8521901983130713`*^9}, {
   3.852193757044561*^9, 3.852193770401032*^9}, {3.852193899863586*^9, 
   3.8521940111735163`*^9}, 3.8521940646256123`*^9, {3.8521949181752253`*^9, 
   3.852194983950858*^9}, {3.852195064388816*^9, 3.8521950660000057`*^9}, {
   3.852195351062972*^9, 3.852195368604443*^9}, {3.852195480335602*^9, 
   3.852195509789166*^9}, {3.8521955440028763`*^9, 3.852195654666103*^9}, {
   3.852195689391244*^9, 3.852195796004436*^9}, {3.852195953958784*^9, 
   3.852196138833127*^9}, {3.852196205369069*^9, 3.852196220444416*^9}, {
   3.8521964296707773`*^9, 3.852196450684182*^9}, {3.852196526104727*^9, 
   3.8521965474655037`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"085c9fab-f6ec-4644-9672-99b0b3ed9e42"]
}, Closed]],

Cell[CellGroupData[{

Cell["Hamiltonian generation", "Section",
 CellChangeTimes->{{3.83519131304431*^9, 
  3.835191316953472*^9}},ExpressionUUID->"c2740d53-f8b5-4855-8199-\
413013e55a4b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"hamiltonian", ",", "nterms", ",", "nqubits"}], "}"}], "=", 
  RowBox[{
  "FormatHamiltonian", "[", "\"\<~/vqe/molecules/H2/H2.txt\>\"", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.834045329009939*^9, 3.834045338300734*^9}, {
   3.834045475757585*^9, 3.834045497697806*^9}, {3.835352286079145*^9, 
   3.8353522875744057`*^9}, {3.851156993863247*^9, 3.851157000634907*^9}, {
   3.8511570484667797`*^9, 3.85115709301831*^9}, {3.851157650439229*^9, 
   3.8511576578191557`*^9}, {3.851157710853297*^9, 3.851157736278618*^9}, {
   3.8511580989738894`*^9, 3.8511581001209927`*^9}, {3.8515820329662046`*^9, 
   3.851582040577107*^9}, {3.851582097784835*^9, 3.8515821585684013`*^9}, {
   3.852183412137376*^9, 3.8521834141128283`*^9}, {3.8521836530865726`*^9, 
   3.852183657898395*^9}, 3.852196743854309*^9, {3.85219688241788*^9, 
   3.852196883573688*^9}, {3.852456479886313*^9, 3.852456486632535*^9}, {
   3.856462500610566*^9, 3.8564625365113277`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"8bb559ed-0741-4767-be33-bf321ddf0560"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.09706626816763075`"}], "-", 
    RowBox[{"0.04530261550379927`", " ", 
     SubscriptBox["X", "2"], " ", 
     SubscriptBox["X", "3"], " ", 
     SubscriptBox["Y", "0"], " ", 
     SubscriptBox["Y", "1"]}], "+", 
    RowBox[{"0.04530261550379927`", " ", 
     SubscriptBox["X", "0"], " ", 
     SubscriptBox["X", "3"], " ", 
     SubscriptBox["Y", "1"], " ", 
     SubscriptBox["Y", "2"]}], "+", 
    RowBox[{"0.04530261550379927`", " ", 
     SubscriptBox["X", "1"], " ", 
     SubscriptBox["X", "2"], " ", 
     SubscriptBox["Y", "0"], " ", 
     SubscriptBox["Y", "3"]}], "-", 
    RowBox[{"0.04530261550379927`", " ", 
     SubscriptBox["X", "0"], " ", 
     SubscriptBox["X", "1"], " ", 
     SubscriptBox["Y", "2"], " ", 
     SubscriptBox["Y", "3"]}], "+", 
    RowBox[{"0.1714128264477691`", " ", 
     SubscriptBox["Z", "0"]}], "+", 
    RowBox[{"0.17141282644776915`", " ", 
     SubscriptBox["Z", "1"]}], "+", 
    RowBox[{"0.16868898170361213`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "1"]}], "-", 
    RowBox[{"0.22343153690813475`", " ", 
     SubscriptBox["Z", "2"]}], "+", 
    RowBox[{"0.12062523483390417`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "2"]}], "+", 
    RowBox[{"0.16592785033770344`", " ", 
     SubscriptBox["Z", "1"], " ", 
     SubscriptBox["Z", "2"]}], "-", 
    RowBox[{"0.22343153690813475`", " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.16592785033770344`", " ", 
     SubscriptBox["Z", "0"], " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.12062523483390417`", " ", 
     SubscriptBox["Z", "1"], " ", 
     SubscriptBox["Z", "3"]}], "+", 
    RowBox[{"0.1744128761226159`", " ", 
     SubscriptBox["Z", "2"], " ", 
     SubscriptBox["Z", "3"]}]}], ",", "15", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.85646253685384*^9, 3.8565156219777327`*^9, 
  3.856715617891774*^9, 3.856864428229567*^9, 3.8574791156998663`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"40b1378e-f7ee-4ab5-8b65-474d133fdf5e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"spin", ",", "nterms", ",", "nqubits"}], "}"}], "=", 
   RowBox[{
   "FormatHamiltonian", "[", "\"\<~/vqe/molecules/H2/spin.txt\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.851709750526782*^9, 3.851709763637735*^9}, 
   3.852196745598477*^9, {3.852196886987639*^9, 3.8521968873225183`*^9}, {
   3.85245648953137*^9, 3.852456490086441*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"da5a402e-a8df-459a-b281-a9ad209b4d1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hammat", "=", 
   RowBox[{"CalcPauliSumMatrix", "@", "hamiltonian"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8511585812943907`*^9, 3.8511585954588423`*^9}, {
  3.852196751028165*^9, 3.852196755843308*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"bdd207d6-f487-4bd0-8e0f-24ab9f1ef918"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tables", "Section",
 CellChangeTimes->{{3.835129336544215*^9, 3.835129362437378*^9}, {
  3.851158468251082*^9, 3.8511584692088137`*^9}, {3.8564619988952627`*^9, 
  3.856462002624138*^9}, {3.856515660566564*^9, 3.856515664548704*^9}, {
  3.856863570789583*^9, 3.856863573029916*^9}, {3.857481667499858*^9, 
  3.857481670702129*^9}, {3.857707168162174*^9, 
  3.8577071718382387`*^9}},ExpressionUUID->"898f75ec-8c04-407b-9b28-\
f2f5f3d369fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"times", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.001", ",", "0.005", ",", "0.01", ",", "0.05", ",", "0.1", ",", "1", 
     ",", "2", ",", "4"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.856863580232376*^9, 3.8568636002916613`*^9}, {
   3.8568636744953623`*^9, 3.856863678924531*^9}, 3.857665491226528*^9, 
   3.857665540189701*^9},
 CellLabel->
  "In[319]:=",ExpressionUUID->"8a33d245-2bce-4e96-9037-dc3178d6d420"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\</home/cica/vqe/subrecompilation\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.856863816294623*^9, 3.8568638332547417`*^9}, {
  3.857544507058593*^9, 3.857544545868507*^9}, {3.8576650951048803`*^9, 
  3.857665124784321*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"d376468c-e8c4-4e37-98f9-f5f9cd4ef0e2"],

Cell[BoxData["\<\"/home/cica/postox/vqe/subrecompilation\"\>"], "Output",
 CellChangeTimes->{
  3.857665124918213*^9, {3.85766538666704*^9, 3.857665390027697*^9}},
 CellLabel->
  "Out[283]=",ExpressionUUID->"b848657f-2902-450a-b5a9-0d596a0c0c3c"]
}, Open  ]],

Cell[TextData[StyleBox["{cost, distance, \
ngates,time(minutes),ansatz,\[Theta]vars,cycleres}",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Text",
 CellChangeTimes->{{3.8574820471132193`*^9, 3.857482060368108*^9}, {
  3.857665703123066*^9, 3.85766572630974*^9}, {3.85766576906487*^9, 
  3.8576657701209517`*^9}, {3.857666394738905*^9, 
  3.857666427764783*^9}},ExpressionUUID->"a325d465-6b4e-4185-b085-\
afd33de3fc58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ressubH2", 
   RowBox[{"<<", "ressubH2.mx"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resfullH2", 
   RowBox[{"<<", "resfullH2.mx"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.856863604450129*^9, 3.856863613157*^9}, {
  3.856863837894918*^9, 3.8568638510434847`*^9}},
 CellLabel->
  "In[284]:=",ExpressionUUID->"b696b5e6-baac-47c8-86f8-de236d524e59"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<t=\>\"", ",", "t"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "@", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TableForm", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"res", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"res", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"res", ",", 
             RowBox[{"ressubH2", "[", "t", "]"}]}], "}"}]}], "]"}]}], ",", 
        "\"\<      \>\"", ",", 
        RowBox[{"TableForm", "@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"res", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"res", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"res", ",", 
             RowBox[{"resfullH2", "[", "t", "]"}]}], "}"}]}], "]"}]}]}], 
       "}"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "times"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.857666438287546*^9, 3.857666640741597*^9}},
 CellLabel->
  "In[395]:=",ExpressionUUID->"74e2b0f7-0950-4ab3-96a9-a52c99a1214c"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", "\[InvisibleSpace]", "0.001`"}],
  SequenceForm["t=", 0.001],
  Editable->False]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640957007*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"ad5c1cbd-ee9a-4808-b183-48601bf699a4"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    GridBox[{{"0.0003741496827529141`", "8"}, {
      "0.00020740124534580985`", "13"}, {"0.00018742337168797715`", "12"}, {
      "0.0004226519843324106`", "2"}, {"0.00030332195024419746`", "12"}, {
      "0.00021825705730150287`", "8"}, {"0.00018170671518569459`", "9"}, {
      "0.0002455387482584016`", "6"}, {"0.00025920907481311083`", "7"}, {
      "0.00029972590100299106`", "3"}}, RowSpacings -> 1, ColumnSpacings -> 3,
      RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], "\"      \"", 
   TagBox[
    GridBox[{{"0.0004396415272799268`", "17"}, {
      "0.0005484078294069513`", "8"}, {"0.0005228353252058985`", "6"}, {
      "0.00042737667780171144`", "8"}, {"0.0005584633279914204`", "16"}, {
      "0.0004882722154502339`", "19"}, {"0.0005181393342136841`", "10"}, {
      "0.0005295620982057777`", "11"}, {"0.0005680770192746162`", "18"}, {
      "0.00045603978605757584`", "12"}}, RowSpacings -> 1, ColumnSpacings -> 
     3, RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640958569*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"bdaa51aa-5ec7-45c5-9c1d-0b00ce5f33e6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", "\[InvisibleSpace]", "0.005`"}],
  SequenceForm["t=", 0.005],
  Editable->False]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.85766664096039*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"ddeb8e72-10ee-4d25-8cd4-9cc659123dac"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    GridBox[{{"0.00039046455100407926`", "20"}, {
      "0.0003764677296239838`", "19"}, {"0.00017686749651630614`", "11"}, {
      "0.0009213647125617108`", "7"}, {"0.0009060965122438625`", "5"}, {
      "0.0009072514663039817`", "16"}, {"0.0004941304050713898`", "19"}, {
      "0.0001952394877185328`", "14"}, {"0.00018768906661247478`", "15"}, {
      "0.0003297701589681345`", "23"}}, RowSpacings -> 1, ColumnSpacings -> 3,
      RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], "\"      \"", 
   TagBox[
    GridBox[{{"0.0009379094304842402`", "33"}, {
      "0.0010589577367396989`", "19"}, {"0.0009099122745682116`", "19"}, {
      "0.0009321444269257761`", "19"}, {"0.0010453135832983321`", "12"}, {
      "0.0005058217466298684`", "36"}, {"0.0009639560501520261`", "30"}, {
      "0.0010407112856893016`", "17"}, {"0.00109728572158077`", "17"}, {
      "0.0010070864523705474`", "18"}}, RowSpacings -> 1, ColumnSpacings -> 3,
      RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640961452*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"1887572d-a312-4fe4-ada2-9ad97a29699b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", "\[InvisibleSpace]", "0.01`"}],
  SequenceForm["t=", 0.01],
  Editable->False]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640962923*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"1312d42a-64ab-43cb-88f7-736d164dda0c"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    GridBox[{{"0.00007522493194229755`", "14"}, {
      "0.0003112198836884155`", "15"}, {"0.00017474231515746092`", "21"}, {
      "0.00009823704113818589`", "21"}, {"0.00009662368427919606`", "17"}, {
      "0.00014851235153441093`", "18"}, {"0.00019417300386045589`", "14"}, {
      "0.00033985494446280365`", "30"}, {"0.000027316818998132483`", "19"}, {
      "0.00007398116927499124`", "14"}}, RowSpacings -> 1, ColumnSpacings -> 
     3, RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], "\"      \"", 
   TagBox[
    GridBox[{{"0.0018235609839674966`", "15"}, {
      "0.00048722230965073647`", "32"}, {"0.001812491014423505`", "26"}, {
      "0.0018173603391828349`", "17"}, {"0.00047959650651250907`", "81"}, {
      "0.0018151258080198627`", "27"}, {"0.0009072739104976234`", "35"}, {
      "0.0009060771629151504`", "23"}, {"0.0009136417968894786`", "34"}, {
      "0.001072856602747865`", "46"}}, RowSpacings -> 1, ColumnSpacings -> 3, 
     RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640963861*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"0940312b-cb2b-46c5-976b-7d4565ac17c8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", "\[InvisibleSpace]", "0.05`"}],
  SequenceForm["t=", 0.05],
  Editable->False]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.8576666409652367`*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"af862469-181e-4874-89b3-75da005047bf"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    GridBox[{{"0.00040328444889448876`", "17"}, {
      "0.0001826818342610575`", "18"}, {"0.00041150293749269676`", "19"}, {
      "0.00026176515497251855`", "24"}, {"0.00043816346608700746`", "20"}, {
      "0.00043721651778287954`", "18"}, {"0.009062158372715947`", "5"}, {
      "0.00040871848440636574`", "12"}, {"0.00008416200069547507`", "17"}, {
      "0.00036994612265980843`", "15"}}, RowSpacings -> 1, ColumnSpacings -> 
     3, RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], "\"      \"", 
   TagBox[
    GridBox[{{"0.004300156286849715`", "63"}, {
      "0.00031570058689495877`", "30"}, {"0.00030994390375244893`", "49"}, {
      "0.000546748986416775`", "35"}, {"0.00016494502888780198`", "38"}, {
      "0.0031322659051552246`", "32"}, {"0.0001697954992453311`", "37"}, {
      "0.000602187525623275`", "102"}, {"0.0004984796648299678`", "57"}, {
      "0.0002305484132436275`", "42"}}, RowSpacings -> 1, ColumnSpacings -> 3,
      RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640966176*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"66cf0888-fc69-474c-9df3-861542a28d70"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", "\[InvisibleSpace]", "0.1`"}],
  SequenceForm["t=", 0.1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640967545*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"c38d1163-6c78-4a2d-91ab-e3fb7157689c"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    GridBox[{{"0.018259001614901273`", "12"}, {
      "0.00040820150019531016`", "15"}, {"0.0003949843757653725`", "18"}, {
      "0.018243991383638573`", "6"}, {"0.018121128581973598`", "8"}, {
      "0.018286164252219968`", "8"}, {"0.01830388123556811`", "9"}, {
      "0.018121182701796724`", "20"}, {"0.018127459251871366`", "35"}, {
      "0.018202266208754782`", "16"}}, RowSpacings -> 1, ColumnSpacings -> 3, 
     RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], "\"      \"", 
   TagBox[
    GridBox[{{"0.018120840290720256`", "16"}, {
      "0.01812084180488949`", "12"}, {"0.004564525440742982`", "36"}, {
      "0.01812100299189758`", "13"}, {"0.018120798353842386`", "11"}, {
      "0.0006950923168715631`", "29"}, {"0.0002370586251566416`", "30"}, {
      "0.000521827915371577`", "28"}, {"0.018128350810475716`", "15"}, {
      "0.0006044158281549014`", "41"}}, RowSpacings -> 1, ColumnSpacings -> 3,
      RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.8576666409685297`*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"307b29a6-38ab-4bc1-8c99-0d110ed7a116"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["t=", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640969915*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"ea4fcdd3-9cc5-4598-a275-fa91545c4a97"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    GridBox[{{"0.00006153122595453575`", "17"}, {
      "0.00017584543598652503`", "21"}, {"0.00013751411247215083`", "19"}, {
      "0.00015608298370394896`", "16"}, {"0.0001454368970301807`", "16"}, {
      "0.00033574375121047024`", "18"}, {"0.00023848137961466544`", "18"}, {
      "0.00012438400200985198`", "17"}, {"0.18096268864469392`", "13"}, {
      "0.00038280583318437827`", "17"}}, RowSpacings -> 1, ColumnSpacings -> 
     3, RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], "\"      \"", 
   TagBox[
    GridBox[{{"0.00040554303317445707`", "33"}, {
      "0.00040838897109230215`", "33"}, {"0.00027455586054593925`", "31"}, {
      "0.0003523985642902999`", "50"}, {"0.000450403407333914`", "34"}, {
      "0.0004802535100791038`", "33"}, {"0.0006471388870552046`", "30"}, {
      "0.004774779606561507`", "36"}, {"0.00041978789231493594`", "31"}, {
      "0.0004921759971337263`", "43"}}, RowSpacings -> 1, ColumnSpacings -> 3,
      RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.8576666409708347`*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"16df3533-8dd9-4077-94c5-dee26db13cd1"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["t=", 2],
  Editable->False]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640972204*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"6c1ec86f-1906-4697-b3ce-437ca620fff7"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    GridBox[{{"0.00037424890829533075`", "20"}, {
      "0.00029545151351644254`", "16"}, {"0.00036266362205714255`", "17"}, {
      "0.0002631871423870171`", "16"}, {"0.00034829084602703203`", "34"}, {
      "0.00016602547246508193`", "18"}, {"0.00014317186391773617`", "17"}, {
      "0.0001851043688671416`", "18"}, {"0.3604406948072139`", "9"}, {
      "0.3604408012770968`", "11"}}, RowSpacings -> 1, ColumnSpacings -> 3, 
     RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], "\"      \"", 
   TagBox[
    GridBox[{{"0.00037086592783874004`", "53"}, {
      "0.0004171323997569003`", "46"}, {"0.00016496295661889922`", "46"}, {
      "0.00011846691954613441`", "31"}, {"0.0001394053416088829`", "56"}, {
      "0.0003376790950641822`", "41"}, {"0.0002278323671647257`", "41"}, {
      "0.0000980436574806089`", "56"}, {"0.00010298966008065421`", "37"}, {
      "0.0005297262713867178`", "39"}}, RowSpacings -> 1, ColumnSpacings -> 3,
      RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.8576666409731903`*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"7f87e3aa-bab4-42d4-a5ae-671c43373531"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"t=\"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["t=", 4],
  Editable->False]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.857666640974606*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"006ef2ed-d153-48b6-873b-4556318daee9"],

Cell[BoxData[
 TemplateBox[{
   TagBox[
    GridBox[{{"0.0000680490213583931`", "19"}, {
      "0.0003446451347854679`", "23"}, {"0.00016569530426413975`", "21"}, {
      "0.00007676249989250321`", "24"}, {"0.00046371983265712947`", "21"}, {
      "0.00031871956764272815`", "20"}, {"0.0003461078345408231`", "19"}, {
      "0.00027882739773216685`", "21"}, {"0.00035774311054675604`", "23"}, {
      "0.00029942396794243307`", "18"}}, RowSpacings -> 1, ColumnSpacings -> 
     3, RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]], "\"      \"", 
   TagBox[
    GridBox[{{"0.00027065477445903743`", "41"}, {
      "0.0005146547441485389`", "44"}, {"0.00033160812402038576`", "34"}, {
      "0.0004309636614986398`", "34"}, {"0.000369031785239264`", "37"}, {
      "0.00007839496263304009`", "34"}, {"0.00044055284175510174`", "37"}, {
      "0.00014281251119634472`", "45"}, {"0.0004321477128145508`", "42"}, {
      "0.0006240503356915127`", "41"}}, RowSpacings -> 1, ColumnSpacings -> 3,
      RowAlignments -> Baseline, ColumnAlignments -> Left], 
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]},
  "RowDefault"]], "Print",
 CellChangeTimes->{{3.857666541238529*^9, 3.8576666409756107`*^9}},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"3cb23bba-415d-4244-a4c0-7542e210d068"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", 
   ",", "Null", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.857666541248969*^9, 3.857666640976997*^9}},
 CellLabel->
  "Out[395]=",ExpressionUUID->"f3da06d3-e99a-4e77-b2c3-a1663e0f3111"]
}, Open  ]],

Cell[TextData[StyleBox["Get best results with distance at least 0.001 from \
subrecompilation",
 FontSlant->"Italic"]], "Text",
 CellChangeTimes->{{3.857479553048608*^9, 3.857479557733375*^9}, {
  3.8574816829126463`*^9, 3.857481692045986*^9}, {3.857481735271771*^9, 
  3.857481736624412*^9}, {3.857482105249353*^9, 3.8574821349014683`*^9}, {
  3.857486901817724*^9, 3.857486902023604*^9}, {3.857665077555785*^9, 
  3.857665078212673*^9}, {3.857665652157343*^9, 
  3.857665656351369*^9}},ExpressionUUID->"26cafdbe-fbe5-4232-b161-\
95e0e85106eb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mindist", "=", 
   RowBox[{"1", "*", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bestsub", "=", 
   RowBox[{"<|", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"t", "->", 
       RowBox[{"First", "@", 
        RowBox[{"MinimalBy", "[", 
         RowBox[{
          RowBox[{"MinimalBy", "[", 
           RowBox[{
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"ressubH2", "[", "t", "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "<=", "mindist"}], "&"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "&"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "times"}], "}"}]}], "]"}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bestfull", "=", 
    RowBox[{"<|", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"t", "->", 
        RowBox[{"First", "@", 
         RowBox[{"MinimalBy", "[", 
          RowBox[{
           RowBox[{"MinimalBy", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"resfullH2", "[", "t", "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "<=", "mindist"}], "&"}]}], 
              "]"}], ",", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "&"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "times"}], "}"}]}], "]"}], "|>"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Print", "@", 
    RowBox[{"{", 
     RowBox[{"t", ",", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"sub", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"bestsub", "[", "t", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"bestsub", "[", "t", "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], ",", 
        RowBox[{"full", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"bestfull", "[", "t", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"bestfull", "[", "t", "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "|>"}]}], "}"}]}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "times"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.857482154682219*^9, 3.8574821867531757`*^9}, {
  3.857482265018146*^9, 3.857482268145842*^9}, {3.857486678418124*^9, 
  3.8574866933301373`*^9}, {3.857486810089405*^9, 3.8574868281285543`*^9}, {
  3.8574869044274893`*^9, 3.857486927640024*^9}, {3.8575409102668943`*^9, 
  3.857540910370913*^9}, {3.8575409907666807`*^9, 3.8575409909528017`*^9}, {
  3.857542998388165*^9, 3.8575430174719343`*^9}, {3.857543150072442*^9, 
  3.857543183045391*^9}, {3.857544555808049*^9, 3.857544559273539*^9}, {
  3.857665421906391*^9, 3.857665467931365*^9}, {3.857665555218471*^9, 
  3.857665619929392*^9}, {3.857665796873159*^9, 3.857665962234715*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"f06e97ec-8573-4905-b660-09db15161101"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.001`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"sub", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0004226519843324106`", ",", "2"}], "}"}]}], ",", 
     RowBox[{"full", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0005228353252058985`", ",", "6"}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.857543177948488*^9, 3.857543183253088*^9}, {
   3.857544551345757*^9, 3.857544559502413*^9}, 3.857665129472473*^9, 
   3.857665219215193*^9, {3.857665391599513*^9, 3.85766539443367*^9}, {
   3.857665541480997*^9, 3.857665620232792*^9}, {3.857665799630664*^9, 
   3.857665834634693*^9}, {3.857665937275415*^9, 3.8576659627172327`*^9}},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"92c0643c-3ddd-4097-8d3c-bd01123fda2c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.005`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"sub", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0009060965122438625`", ",", "5"}], "}"}]}], ",", 
     RowBox[{"full", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0009099122745682116`", ",", "19"}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.857543177948488*^9, 3.857543183253088*^9}, {
   3.857544551345757*^9, 3.857544559502413*^9}, 3.857665129472473*^9, 
   3.857665219215193*^9, {3.857665391599513*^9, 3.85766539443367*^9}, {
   3.857665541480997*^9, 3.857665620232792*^9}, {3.857665799630664*^9, 
   3.857665834634693*^9}, {3.857665937275415*^9, 3.85766596271868*^9}},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"c198370b-c22c-4a8d-bd2f-da29bab204ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.01`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"sub", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.00007398116927499124`", ",", "14"}], "}"}]}], ",", 
     RowBox[{"full", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0009060771629151504`", ",", "23"}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.857543177948488*^9, 3.857543183253088*^9}, {
   3.857544551345757*^9, 3.857544559502413*^9}, 3.857665129472473*^9, 
   3.857665219215193*^9, {3.857665391599513*^9, 3.85766539443367*^9}, {
   3.857665541480997*^9, 3.857665620232792*^9}, {3.857665799630664*^9, 
   3.857665834634693*^9}, {3.857665937275415*^9, 3.857665962719928*^9}},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"023397a2-8202-446f-a266-0afbf2e273f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.05`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"sub", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.00040871848440636574`", ",", "12"}], "}"}]}], ",", 
     RowBox[{"full", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.00031570058689495877`", ",", "30"}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.857543177948488*^9, 3.857543183253088*^9}, {
   3.857544551345757*^9, 3.857544559502413*^9}, 3.857665129472473*^9, 
   3.857665219215193*^9, {3.857665391599513*^9, 3.85766539443367*^9}, {
   3.857665541480997*^9, 3.857665620232792*^9}, {3.857665799630664*^9, 
   3.857665834634693*^9}, {3.857665937275415*^9, 3.857665962720961*^9}},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"7d8f8a2c-74bc-41ea-8d19-efc1db8a3147"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.1`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"sub", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.00040820150019531016`", ",", "15"}], "}"}]}], ",", 
     RowBox[{"full", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.000521827915371577`", ",", "28"}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.857543177948488*^9, 3.857543183253088*^9}, {
   3.857544551345757*^9, 3.857544559502413*^9}, 3.857665129472473*^9, 
   3.857665219215193*^9, {3.857665391599513*^9, 3.85766539443367*^9}, {
   3.857665541480997*^9, 3.857665620232792*^9}, {3.857665799630664*^9, 
   3.857665834634693*^9}, {3.857665937275415*^9, 3.857665962721957*^9}},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"e9cb36ff-a2cb-4eb7-8632-34b26e9353c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"sub", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0001454368970301807`", ",", "16"}], "}"}]}], ",", 
     RowBox[{"full", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0006471388870552046`", ",", "30"}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.857543177948488*^9, 3.857543183253088*^9}, {
   3.857544551345757*^9, 3.857544559502413*^9}, 3.857665129472473*^9, 
   3.857665219215193*^9, {3.857665391599513*^9, 3.85766539443367*^9}, {
   3.857665541480997*^9, 3.857665620232792*^9}, {3.857665799630664*^9, 
   3.857665834634693*^9}, {3.857665937275415*^9, 3.857665962722934*^9}},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"aba344e9-e9d8-46d4-8812-b416f6497605"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"sub", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.0002631871423870171`", ",", "16"}], "}"}]}], ",", 
     RowBox[{"full", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.00011846691954613441`", ",", "31"}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.857543177948488*^9, 3.857543183253088*^9}, {
   3.857544551345757*^9, 3.857544559502413*^9}, 3.857665129472473*^9, 
   3.857665219215193*^9, {3.857665391599513*^9, 3.85766539443367*^9}, {
   3.857665541480997*^9, 3.857665620232792*^9}, {3.857665799630664*^9, 
   3.857665834634693*^9}, {3.857665937275415*^9, 3.857665962723853*^9}},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"f3c44df6-f2ca-40b0-ad45-02dddfdb9b5a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"sub", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.00029942396794243307`", ",", "18"}], "}"}]}], ",", 
     RowBox[{"full", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.00007839496263304009`", ",", "34"}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.857543177948488*^9, 3.857543183253088*^9}, {
   3.857544551345757*^9, 3.857544559502413*^9}, 3.857665129472473*^9, 
   3.857665219215193*^9, {3.857665391599513*^9, 3.85766539443367*^9}, {
   3.857665541480997*^9, 3.857665620232792*^9}, {3.857665799630664*^9, 
   3.857665834634693*^9}, {3.857665937275415*^9, 3.8576659627248087`*^9}},
 CellLabel->
  "During evaluation of \
In[374]:=",ExpressionUUID->"609ebf29-8388-4dca-9baf-be41fdc00d84"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", 
   ",", "Null", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.8575431779635687`*^9, 3.857543183263929*^9}, {
   3.857544551356535*^9, 3.857544559515292*^9}, 3.857665129481324*^9, 
   3.857665219226102*^9, {3.857665391608294*^9, 3.857665394443719*^9}, {
   3.857665541492187*^9, 3.857665620241547*^9}, {3.857665799638768*^9, 
   3.857665834642015*^9}, {3.8576659372847137`*^9, 3.857665962725778*^9}},
 CellLabel->
  "Out[377]=",ExpressionUUID->"c3653554-fad1-4ccd-834e-ed27c6db1885"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Values", "@", 
     RowBox[{"trotsum", "[", "0.001", "]"}]}], ",", "1"}], "]"}], 
  "\[LeftDoubleBracket]", 
  RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.857666268428596*^9, 3.857666316664921*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"d0df8808-e3a2-4caf-b9cc-66509f851adc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.4309984894591622`*^-7", ",", "7.154992273460672`*^-8", ",", 
   "4.7699948058784034`*^-8", ",", "3.5774961050745835`*^-8", ",", 
   "2.8619968921833124`*^-8", ",", "3.791560091808203`*^-11", ",", 
   "2.4154584797560444`*^-12", ",", "2.092797125019581`*^-12", ",", 
   "6.04722902248471`*^-13", ",", "6.043125768062287`*^-13", ",", 
   "8.885531870038009`*^-15", ",", "1.4988313660853843`*^-14", ",", 
   "2.217871829514229`*^-14", ",", "3.0388573944712067`*^-14", ",", 
   "3.900660702678995`*^-14", ",", "2.5769450619565506`*^-14", ",", 
   "5.1006288926331903`*^-14", ",", "8.29645978549061`*^-14", ",", 
   "1.0718348526907825`*^-13", ",", "1.1030836779965912`*^-13"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.857666270739485*^9, 3.8576663171924133`*^9}},
 CellLabel->
  "Out[382]=",ExpressionUUID->"676bc8b3-d555-4d9b-b91d-c234215c0639"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1295, 809},
WindowMargins->{{0.5, Automatic}, {Automatic, 0.5}},
Magnification:>0.7 Inherited,
FrontEndVersion->"12.3 for Linux x86 (64-bit) (July 9, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"d8064fae-5497-471d-9496-a6585a5ce571"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 594, 13, 100, "Title",ExpressionUUID->"9c1dff5f-e921-489a-86b0-1c40629006dc"],
Cell[1177, 37, 264, 4, 42, "Input",ExpressionUUID->"f5720dc7-67b1-44ab-ad1c-dabe6c67a58f"],
Cell[1444, 43, 1953, 32, 87, "Input",ExpressionUUID->"bc2eb47a-2577-4b72-91f8-f80d872ef4aa"],
Cell[CellGroupData[{
Cell[3422, 79, 177, 3, 71, "Section",ExpressionUUID->"d4fdd558-5dfa-43ba-83b9-2b0b69f1cf61"],
Cell[3602, 84, 3730, 95, 393, "Input",ExpressionUUID->"6a73d21c-ac9f-48d7-a443-6e5039de881c"],
Cell[7335, 181, 13934, 329, 1284, "Input",ExpressionUUID->"bbd997de-5c8c-4aaa-92d5-3f035e054810"],
Cell[21272, 512, 972, 23, 66, "Input",ExpressionUUID->"4e59313c-f9ee-4565-9120-998e2216f463"],
Cell[22247, 537, 3774, 82, 317, "Input",ExpressionUUID->"085c9fab-f6ec-4644-9672-99b0b3ed9e42"]
}, Closed]],
Cell[CellGroupData[{
Cell[26058, 624, 166, 3, 56, "Section",ExpressionUUID->"c2740d53-f8b5-4855-8199-413013e55a4b"],
Cell[CellGroupData[{
Cell[26249, 631, 1079, 18, 42, "Input",ExpressionUUID->"8bb559ed-0741-4767-be33-bf321ddf0560"],
Cell[27331, 651, 2086, 53, 65, "Output",ExpressionUUID->"40b1378e-f7ee-4ab5-8b65-474d133fdf5e"]
}, Open  ]],
Cell[29432, 707, 494, 11, 42, "Input",ExpressionUUID->"da5a402e-a8df-459a-b281-a9ad209b4d1c"],
Cell[29929, 720, 321, 6, 42, "Input",ExpressionUUID->"bdd207d6-f487-4bd0-8e0f-24ab9f1ef918"]
}, Closed]],
Cell[CellGroupData[{
Cell[30287, 731, 445, 7, 56, "Section",ExpressionUUID->"898f75ec-8c04-407b-9b28-f2f5f3d369fc"],
Cell[30735, 740, 458, 11, 42, "Input",ExpressionUUID->"8a33d245-2bce-4e96-9037-dc3178d6d420"],
Cell[CellGroupData[{
Cell[31218, 755, 357, 7, 42, "Input",ExpressionUUID->"d376468c-e8c4-4e37-98f9-f5f9cd4ef0e2"],
Cell[31578, 764, 246, 4, 42, "Output",ExpressionUUID->"b848657f-2902-450a-b5a9-0d596a0c0c3c"]
}, Open  ]],
Cell[31839, 771, 420, 8, 35, "Text",ExpressionUUID->"a325d465-6b4e-4185-b085-afd33de3fc58"],
Cell[32262, 781, 400, 10, 65, "Input",ExpressionUUID->"b696b5e6-baac-47c8-86f8-de236d524e59"],
Cell[CellGroupData[{
Cell[32687, 795, 1477, 40, 109, "Input",ExpressionUUID->"74e2b0f7-0950-4ab3-96a9-a52c99a1214c"],
Cell[CellGroupData[{
Cell[34189, 839, 321, 8, 24, "Print",ExpressionUUID->"ad5c1cbd-ee9a-4808-b183-48601bf699a4"],
Cell[34513, 849, 1354, 26, 175, "Print",ExpressionUUID->"bdaa51aa-5ec7-45c5-9c1d-0b00ce5f33e6"],
Cell[35870, 877, 320, 8, 24, "Print",ExpressionUUID->"ddeb8e72-10ee-4d25-8cd4-9cc659123dac"],
Cell[36193, 887, 1354, 26, 175, "Print",ExpressionUUID->"1887572d-a312-4fe4-ada2-9ad97a29699b"],
Cell[37550, 915, 319, 8, 24, "Print",ExpressionUUID->"1312d42a-64ab-43cb-88f7-736d164dda0c"],
Cell[37872, 925, 1365, 26, 175, "Print",ExpressionUUID->"0940312b-cb2b-46c5-976b-7d4565ac17c8"],
Cell[39240, 953, 321, 8, 24, "Print",ExpressionUUID->"af862469-181e-4874-89b3-75da005047bf"],
Cell[39564, 963, 1362, 26, 175, "Print",ExpressionUUID->"66cf0888-fc69-474c-9df3-861542a28d70"],
Cell[40929, 991, 317, 8, 24, "Print",ExpressionUUID->"c38d1163-6c78-4a2d-91ab-e3fb7157689c"],
Cell[41249, 1001, 1336, 26, 175, "Print",ExpressionUUID->"307b29a6-38ab-4bc1-8c99-0d110ed7a116"],
Cell[42588, 1029, 312, 8, 24, "Print",ExpressionUUID->"ea4fcdd3-9cc5-4598-a275-fa91545c4a97"],
Cell[42903, 1039, 1365, 26, 175, "Print",ExpressionUUID->"16df3533-8dd9-4077-94c5-dee26db13cd1"],
Cell[44271, 1067, 312, 8, 24, "Print",ExpressionUUID->"6c1ec86f-1906-4697-b3ce-437ca620fff7"],
Cell[44586, 1077, 1360, 26, 175, "Print",ExpressionUUID->"7f87e3aa-bab4-42d4-a5ae-671c43373531"],
Cell[45949, 1105, 312, 8, 24, "Print",ExpressionUUID->"006ef2ed-d153-48b6-873b-4556318daee9"],
Cell[46264, 1115, 1368, 26, 175, "Print",ExpressionUUID->"3cb23bba-415d-4244-a4c0-7542e210d068"]
}, Open  ]],
Cell[47647, 1144, 313, 7, 42, "Output",ExpressionUUID->"f3da06d3-e99a-4e77-b2c3-a1663e0f3111"]
}, Open  ]],
Cell[47975, 1154, 545, 9, 35, "Text",ExpressionUUID->"26cafdbe-fbe5-4232-b161-95e0e85106eb"],
Cell[CellGroupData[{
Cell[48545, 1167, 3710, 101, 131, "Input",ExpressionUUID->"f06e97ec-8573-4905-b660-09db15161101"],
Cell[CellGroupData[{
Cell[52280, 1272, 850, 19, 24, "Print",ExpressionUUID->"92c0643c-3ddd-4097-8d3c-bd01123fda2c"],
Cell[53133, 1293, 848, 19, 24, "Print",ExpressionUUID->"c198370b-c22c-4a8d-bd2f-da29bab204ee"],
Cell[53984, 1314, 850, 19, 24, "Print",ExpressionUUID->"023397a2-8202-446f-a266-0afbf2e273f8"],
Cell[54837, 1335, 851, 19, 24, "Print",ExpressionUUID->"7d8f8a2c-74bc-41ea-8d19-efc1db8a3147"],
Cell[55691, 1356, 848, 19, 24, "Print",ExpressionUUID->"e9cb36ff-a2cb-4eb7-8632-34b26e9353c6"],
Cell[56542, 1377, 845, 19, 24, "Print",ExpressionUUID->"aba344e9-e9d8-46d4-8812-b416f6497605"],
Cell[57390, 1398, 846, 19, 24, "Print",ExpressionUUID->"f3c44df6-f2ca-40b0-ad45-02dddfdb9b5a"],
Cell[58239, 1419, 849, 19, 24, "Print",ExpressionUUID->"609ebf29-8388-4dca-9baf-be41fdc00d84"]
}, Open  ]],
Cell[59103, 1441, 607, 11, 42, "Output",ExpressionUUID->"c3653554-fad1-4ccd-834e-ed27c6db1885"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59747, 1457, 399, 10, 42, "Input",ExpressionUUID->"d0df8808-e3a2-4caf-b9cc-66509f851adc"],
Cell[60149, 1469, 890, 16, 91, "Output",ExpressionUUID->"676bc8b3-d555-4d9b-b91d-c234215c0639"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

